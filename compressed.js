// Underscore.js 1.3.1
// (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;a._chain&&(a=a._wrapped),c._chain&&(c=c._wrapped);if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return!1;switch(e){case"[object String]":return a==c+"";case"[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,g=!0;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,h)&&!(f--))break;g=!f}}return d.pop(),g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=b),exports._=b):r._=b,b.VERSION="1.3.1";var j=b.each=b.forEach=function(a,c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];return a==null?e:x&&a.map===x?a.map(c,b):(j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)}),a.length===+a.length&&(e.length=a.length),e)},b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(y&&a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d},b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();return e&&!f&&(c=b.bind(c,e)),f?b.reduce(g,c,d,e):b.reduce(g,c)},b.find=b.detect=function(a,c,b){var e;return E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,!0}),e},b.filter=b.select=function(a,c,b){var e=[];return a==null?e:A&&a.filter===A?a.filter(c,b):(j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)}),e)},b.reject=function(a,c,b){var e=[];return a==null?e:(j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)}),e)},b.every=b.all=function(a,c,b){var e=!0;return a==null?e:B&&a.every===B?a.every(c,b):(j(a,function(a,g,h){if(!(e=e&&c.call(b,a,g,h)))return n}),e)};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=!1;return a==null?e:C&&a.some===C?a.some(c,d):(j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n}),!!e)};b.include=b.contains=function(a,c){var b=!1;return a==null?b:p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})},b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})},b.pluck=function(a,c){return b.map(a,function(a){return a[c]})},b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};return j(a,function(a,b,h){b=c?c.call(d,a,b,h):a,b>=e.computed&&(e={value:a,computed:b})}),e.value},b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};return j(a,function(a,b,h){b=c?c.call(d,a,b,h):a,b<e.computed&&(e={value:a,computed:b})}),e.value},b.shuffle=function(a){var b=[],d;return j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)}),b},b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};return j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)}),d},b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e},b.toArray=function(a){return a?a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a):[]},b.size=function(a){return b.toArray(a).length},b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]},b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))},b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]},b.rest=b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)},b.compact=function(a){return b.filter(a,function(a){return!!a})},b.flatten=function(a,c){return b.reduce(a,function(a,e){return b.isArray(e)?a.concat(c?e:b.flatten(e)):(a[a.length]=e,a)},[])},b.without=function(a){return b.difference(a,i.call(arguments,1))},b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];return b.reduce(d,function(d,g,h){if(0==h||(c===!0?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]),e},b.union=function(){return b.uniq(b.flatten(arguments,!0))},b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})},b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})},b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d},b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1},b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1},b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;return e=i.call(arguments,2),d=function(){if(this instanceof d){F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}return a.apply(c,e.concat(i.call(arguments)))}},b.bindAll=function(a){var c=i.call(arguments,1);return c.length==0&&(c=b.functions(a)),j(c,function(c){a[c]=b.bind(a[c],a)}),a},b.memoize=function(a,c){var d={};return c||(c=b.identity),function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}},b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)},b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))},b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=!1},c);return function(){d=this,e=arguments;var b;f||(f=setTimeout(function(){f=null,h&&a.apply(d,e),i()},c)),g?h=!0:a.apply(d,e),i(),g=!0}},b.debounce=function(a,b){var d;return function(){var e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,a.apply(e,f)},b)}},b.once=function(a){var b=!1,d;return function(){return b?d:(b=!0,d=a.apply(this,arguments))}},b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}},b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}},b.after=function(a,b){return a>0?function(){if(--a<1)return b.apply(this,arguments)}:b()},b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c},b.values=function(a){return b.map(a,b.identity)},b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()},b.extend=function(a){return j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]}),a},b.defaults=function(a){return j(i.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])}),a},b.clone=function(a){return b.isObject(a)?b.isArray(a)?a.slice():b.extend({},a):a},b.tap=function(a,b){return b(a),a},b.isEqual=function(a,b){return q(a,b,[])},b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return!1;return!0},b.isElement=function(a){return!!a&&a.nodeType==1},b.isArray=o||function(a){return l.call(a)=="[object Array]"},b.isObject=function(a){return a===Object(a)},b.isArguments=function(a){return l.call(a)=="[object Arguments]"},b.isArguments(arguments)||(b.isArguments=function(a){return!!a&&!!b.has(a,"callee")}),b.isFunction=function(a){return l.call(a)=="[object Function]"},b.isString=function(a){return l.call(a)=="[object String]"},b.isNumber=function(a){return l.call(a)=="[object Number]"},b.isNaN=function(a){return a!==a},b.isBoolean=function(a){return a===!0||a===!1||l.call(a)=="[object Boolean]"},b.isDate=function(a){return l.call(a)=="[object Date]"},b.isRegExp=function(a){return l.call(a)=="[object RegExp]"},b.isNull=function(a){return a===null},b.isUndefined=function(a){return a===void 0},b.has=function(a,b){return I.call(a,b)},b.noConflict=function(){return r._=G,this},b.identity=function(a){return a},b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)},b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},b.mixin=function(a){j(b.functions(a),function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}},b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=function(){var a=i.call(arguments);return H.call(a,this._wrapped),v(c.apply(b,a),this._chain)}};b.mixin(b),j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;return(a=="shift"||a=="splice")&&e===0&&delete d[0],v(d,this._chain)}}),j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}}),m.prototype.chain=function(){return this._chain=!0,this},m.prototype.value=function(){return this._wrapped}}).call(this),function(){var root=this;root.gLong=function(low,high){this.low_=low|0,this.high_=high|0},root.gLong.IntCache_={},root.gLong.fromInt=function(value){if(-128<=value&&value<128){var cachedObj=root.gLong.IntCache_[value];if(cachedObj)return cachedObj}var obj=new root.gLong(value|0,value<0?-1:0);return-128<=value&&value<128&&(root.gLong.IntCache_[value]=obj),obj},root.gLong.fromNumber=function(value){return isNaN(value)||!isFinite(value)?root.gLong.ZERO:value>-root.gLong.TWO_PWR_63_DBL_?value+1<root.gLong.TWO_PWR_63_DBL_?value<0?root.gLong.fromNumber(-value).negate():new root.gLong(value%root.gLong.TWO_PWR_32_DBL_|0,value/root.gLong.TWO_PWR_32_DBL_|0):root.gLong.MAX_VALUE:root.gLong.MIN_VALUE},root.gLong.fromBits=function(lowBits,highBits){return new root.gLong(lowBits,highBits)},root.gLong.fromString=function(str,opt_radix){if(str.length==0)throw Error("number format error: empty string");var radix=opt_radix||10;if(radix<2||36<radix)throw Error("radix out of range: "+radix);if(str.charAt(0)=="-")return root.gLong.fromString(str.substring(1),radix).negate();if(str.indexOf("-")<0){var radixToPower=root.gLong.fromNumber(Math.pow(radix,8)),result=root.gLong.ZERO;for(var i=0;i<str.length;i+=8){var size=Math.min(8,str.length-i),value=parseInt(str.substring(i,i+size),radix);if(size<8){var power=root.gLong.fromNumber(Math.pow(radix,size));result=result.multiply(power).add(root.gLong.fromNumber(value))}else result=result.multiply(radixToPower),result=result.add(root.gLong.fromNumber(value))}return result}throw Error('number format error: interior "-" character: '+str)},root.gLong.TWO_PWR_16_DBL_=65536,root.gLong.TWO_PWR_24_DBL_=1<<24,root.gLong.TWO_PWR_32_DBL_=root.gLong.TWO_PWR_16_DBL_*root.gLong.TWO_PWR_16_DBL_,root.gLong.TWO_PWR_31_DBL_=root.gLong.TWO_PWR_32_DBL_/2,root.gLong.TWO_PWR_48_DBL_=root.gLong.TWO_PWR_32_DBL_*root.gLong.TWO_PWR_16_DBL_,root.gLong.TWO_PWR_64_DBL_=root.gLong.TWO_PWR_32_DBL_*root.gLong.TWO_PWR_32_DBL_,root.gLong.TWO_PWR_63_DBL_=root.gLong.TWO_PWR_64_DBL_/2,root.gLong.ZERO=root.gLong.fromInt(0),root.gLong.ONE=root.gLong.fromInt(1),root.gLong.NEG_ONE=root.gLong.fromInt(-1),root.gLong.MAX_VALUE=root.gLong.fromBits(-1,2147483647),root.gLong.MIN_VALUE=root.gLong.fromBits(0,-2147483648),root.gLong.TWO_PWR_24_=root.gLong.fromInt(1<<24),root.gLong.prototype.toInt=function(){return this.low_},root.gLong.prototype.toNumber=function(){return this.high_*root.gLong.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},root.gLong.prototype.toString=function(opt_radix){var radix=opt_radix||10;if(radix<2||36<radix)throw Error("radix out of range: "+radix);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(root.gLong.MIN_VALUE)){var radixLong=root.gLong.fromNumber(radix),div=this.div(radixLong),rem=div.multiply(radixLong).subtract(this);return div.toString(radix)+rem.toInt().toString(radix)}return"-"+this.negate().toString(radix)}var radixToPower=root.gLong.fromNumber(Math.pow(radix,6)),rem=this,result="";for(;;){var remDiv=rem.div(radixToPower),intval=rem.subtract(remDiv.multiply(radixToPower)).toInt(),digits=intval.toString(radix);rem=remDiv;if(rem.isZero())return digits+result;while(digits.length<6)digits="0"+digits;result=""+digits+result}},root.gLong.prototype.getHighBits=function(){return this.high_},root.gLong.prototype.getLowBits=function(){return this.low_},root.gLong.prototype.getLowBitsUnsigned=function(){return this.low_<0?root.gLong.TWO_PWR_32_DBL_+this.low_:this.low_},root.gLong.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(root.gLong.MIN_VALUE)?64:this.negate().getNumBitsAbs();var val=this.high_!=0?this.high_:this.low_;for(var bit=31;bit>0;bit--)if((val&1<<bit)!=0)break;return this.high_!=0?bit+33:bit+1},root.gLong.prototype.isZero=function(){return this.high_==0&&this.low_==0},root.gLong.prototype.isNegative=function(){return this.high_<0},root.gLong.prototype.isOdd=function(){return(this.low_&1)==1},root.gLong.prototype.equals=function(other){return this.high_==other.high_&&this.low_==other.low_},root.gLong.prototype.notEquals=function(other){return this.high_!=other.high_||this.low_!=other.low_},root.gLong.prototype.lessThan=function(other){return this.compare(other)<0},root.gLong.prototype.lessThanOrEqual=function(other){return this.compare(other)<=0},root.gLong.prototype.greaterThan=function(other){return this.compare(other)>0},root.gLong.prototype.greaterThanOrEqual=function(other){return this.compare(other)>=0},root.gLong.prototype.compare=function(other){if(this.equals(other))return 0;var thisNeg=this.isNegative(),otherNeg=other.isNegative();return thisNeg&&!otherNeg?-1:!thisNeg&&otherNeg?1:this.subtract(other).isNegative()?-1:1},root.gLong.prototype.negate=function(){return this.equals(root.gLong.MIN_VALUE)?root.gLong.MIN_VALUE:this.not().add(root.gLong.ONE)},root.gLong.prototype.add=function(other){var a48=this.high_>>>16,a32=this.high_&65535,a16=this.low_>>>16,a00=this.low_&65535,b48=other.high_>>>16,b32=other.high_&65535,b16=other.low_>>>16,b00=other.low_&65535,c48=0,c32=0,c16=0,c00=0;return c00+=a00+b00,c16+=c00>>>16,c00&=65535,c16+=a16+b16,c32+=c16>>>16,c16&=65535,c32+=a32+b32,c48+=c32>>>16,c32&=65535,c48+=a48+b48,c48&=65535,root.gLong.fromBits(c16<<16|c00,c48<<16|c32)},root.gLong.prototype.subtract=function(other){return this.add(other.negate())},root.gLong.prototype.multiply=function(other){if(this.isZero())return root.gLong.ZERO;if(other.isZero())return root.gLong.ZERO;if(this.equals(root.gLong.MIN_VALUE))return other.isOdd()?root.gLong.MIN_VALUE:root.gLong.ZERO;if(other.equals(root.gLong.MIN_VALUE))return this.isOdd()?root.gLong.MIN_VALUE:root.gLong.ZERO;if(this.isNegative())return other.isNegative()?this.negate().multiply(other.negate()):this.negate().multiply(other).negate();if(other.isNegative())return this.multiply(other.negate()).negate();if(this.lessThan(root.gLong.TWO_PWR_24_)&&other.lessThan(root.gLong.TWO_PWR_24_))return root.gLong.fromNumber(this.toNumber()*other.toNumber());var a48=this.high_>>>16,a32=this.high_&65535,a16=this.low_>>>16,a00=this.low_&65535,b48=other.high_>>>16,b32=other.high_&65535,b16=other.low_>>>16,b00=other.low_&65535,c48=0,c32=0,c16=0,c00=0;return c00+=a00*b00,c16+=c00>>>16,c00&=65535,c16+=a16*b00,c32+=c16>>>16,c16&=65535,c16+=a00*b16,c32+=c16>>>16,c16&=65535,c32+=a32*b00,c48+=c32>>>16,c32&=65535,c32+=a16*b16,c48+=c32>>>16,c32&=65535,c32+=a00*b32,c48+=c32>>>16,c32&=65535,c48+=a48*b00+a32*b16+a16*b32+a00*b48,c48&=65535,root.gLong.fromBits(c16<<16|c00,c48<<16|c32)},root.gLong.prototype.div=function(other){if(other.isZero())throw Error("division by zero");if(this.isZero())return root.gLong.ZERO;if(this.equals(root.gLong.MIN_VALUE)){if(other.equals(root.gLong.ONE)||other.equals(root.gLong.NEG_ONE))return root.gLong.MIN_VALUE;if(other.equals(root.gLong.MIN_VALUE))return root.gLong.ONE;var halfThis=this.shiftRight(1),approx=halfThis.div(other).shiftLeft(1);if(approx.equals(root.gLong.ZERO))return other.isNegative()?root.gLong.ONE:root.gLong.NEG_ONE;var rem=this.subtract(other.multiply(approx)),result=approx.add(rem.div(other));return result}if(other.equals(root.gLong.MIN_VALUE))return root.gLong.ZERO;if(this.isNegative())return other.isNegative()?this.negate().div(other.negate()):this.negate().div(other).negate();if(other.isNegative())return this.div(other.negate()).negate();var res=root.gLong.ZERO,rem=this;while(rem.greaterThanOrEqual(other)){var approx=Math.max(1,Math.floor(rem.toNumber()/other.toNumber())),log2=Math.ceil(Math.log(approx)/Math.LN2),delta=log2>48?Math.pow(2,log2-48):1,approxRes=root.gLong.fromNumber(approx),approxRem=approxRes.multiply(other);while(approxRem.isNegative()||approxRem.greaterThan(rem))approx-=delta,approxRes=root.gLong.fromNumber(approx),approxRem=approxRes.multiply(other);approxRes.isZero()&&(approxRes=root.gLong.ONE),res=res.add(approxRes),rem=rem.subtract(approxRem)}return res},root.gLong.prototype.modulo=function(other){return this.subtract(this.div(other).multiply(other))},root.gLong.prototype.not=function(){return root.gLong.fromBits(~this.low_,~this.high_)},root.gLong.prototype.and=function(other){return root.gLong.fromBits(this.low_&other.low_,this.high_&other.high_)},root.gLong.prototype.or=function(other){return root.gLong.fromBits(this.low_|other.low_,this.high_|other.high_)},root.gLong.prototype.xor=function(other){return root.gLong.fromBits(this.low_^other.low_,this.high_^other.high_)},root.gLong.prototype.shiftLeft=function(numBits){numBits&=63;if(numBits==0)return this;var low=this.low_;if(numBits<32){var high=this.high_;return root.gLong.fromBits(low<<numBits,high<<numBits|low>>>32-numBits)}return root.gLong.fromBits(0,low<<numBits-32)},root.gLong.prototype.shiftRight=function(numBits){numBits&=63;if(numBits==0)return this;var high=this.high_;if(numBits<32){var low=this.low_;return root.gLong.fromBits(low>>>numBits|high<<32-numBits,high>>numBits)}return root.gLong.fromBits(high>>numBits-32,high<0?-1:0)},root.gLong.prototype.shiftRightUnsigned=function(numBits){numBits&=63;if(numBits==0)return this;var high=this.high_;if(numBits<32){var low=this.low_;return root.gLong.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits)}return numBits==32?root.gLong.fromBits(high,0):root.gLong.fromBits(high>>>numBits-32,0)},typeof module!="undefined"&&module!==null&&(module.exports=root.gLong)}.call(this),function(){var nonAsyncCount,root;root=typeof exports!="undefined"&&exports!==null?exports:this,"use strict",nonAsyncCount=0,root.asyncExecute=function(fn){return typeof document!="undefined"&&document!==null&&(document.hidden||document.mozHidden||document.webkitHidden||document.msHidden)&&nonAsyncCount++<1e4?fn():(nonAsyncCount=0,setTimeout(fn,0))}}.call(this),function(){var CacheSource,CompositedFileSource,DoppioFile,FSState,FileIndex,FileSource,GetIEByteArray_ByteStr,LocalStorageSource,Stat,WebserverSource,basename,fs_state,inject_vbscript,root,win,_,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;win=window,root=win.node={},basename=function(path){return path.split("/").pop()},win.require=function(path){var ext,name,_ref,_ref1;return _ref=basename(path).split("."),name=_ref[0],ext=_ref[1],(_ref1=window[name])!=null?_ref1:window[name]={}},_=require("../vendor/_.js"),"use strict",inject_vbscript=function(){var IEBinaryToArray_ByteStr_Script;return IEBinaryToArray_ByteStr_Script="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n",document.write(IEBinaryToArray_ByteStr_Script)},$.browser.msie&&!window.Blob&&inject_vbscript(),GetIEByteArray_ByteStr=function(IEByteArray){var lastChr,rawBytes;return rawBytes=IEBinaryToArray_ByteStr(IEByteArray),lastChr=IEBinaryToArray_ByteStr_Last(IEByteArray),rawBytes.replace(/[\s\S]/g,function(match){var v;return v=match.charCodeAt(0),String.fromCharCode(v&255,v>>8)})+lastChr},DoppioFile=function(){function DoppioFile(path,data,mtime,mod,mode){this.path=path,this.data=data!=null?data:"",this.mtime=mtime!=null?mtime:(new Date).getTime(),this.mod=mod!=null?mod:!1,this.mode=mode!=null?mode:420}return DoppioFile.fromJSON=function(path,rawData){var data;return data=JSON.parse(rawData),new DoppioFile(path,data.data,data.mtime)},DoppioFile.prototype.read=function(length,pos){return length==null?this.data:this.data.substr(pos,length)},DoppioFile.prototype.write=function(newData){return this.mod=!0,this.data+=newData,this},DoppioFile.prototype.toJSON=function(){return JSON.stringify({data:this.data,mtime:this.mtime})},DoppioFile}(),FileIndex=function(){function FileIndex(index){this.index=index!=null?index:{}}return FileIndex.prototype._subcomponents=function(path){var components;return components=path.split("/"),components.shift(),components.length===1&&components[0]===""?[]:components},FileIndex.prototype._add_file=function(components,fname,file){var dir;dir=this._mkdir(components),dir[fname]=file},FileIndex.prototype._mkdir=function(components){var c,cur_dir,_i,_len,_ref;cur_dir=this.index;for(_i=0,_len=components.length;_i<_len;_i++)c=components[_i],(_ref=cur_dir[c])==null&&(cur_dir[c]={}),cur_dir=cur_dir[c];return cur_dir},FileIndex.prototype._get=function(components){var c,cur_dir,_i,_len;cur_dir=this.index;for(_i=0,_len=components.length;_i<_len;_i++){c=components[_i];if(!(c in cur_dir))return!1;cur_dir=cur_dir[c]}return cur_dir},FileIndex.prototype._is_directory=function(obj){return obj!=null&&!(obj instanceof DoppioFile)},FileIndex.prototype.add_file=function(path,file){var components,fname;components=this._subcomponents(path),fname=components.pop(),this._add_file(components,fname,file)},FileIndex.prototype.get_file=function(path){var components,f;return components=this._subcomponents(path),f=this._get(components),f!==!1&&!this._is_directory(f)?f:!1},FileIndex.prototype.ls=function(path){var components,dir;return components=this._subcomponents(path),dir=this._get(components),dir===!1||!this._is_directory(dir)?null:Object.keys(dir)},FileIndex.prototype.mkdir=function(path){var components;components=this._subcomponents(path),this._mkdir(components)},FileIndex.prototype.parent=function(path){var components;return components=this._subcomponents(path),components.pop(),this._get(components)},FileIndex.prototype.rm=function(path){var components,name,obj,parent,ret;return components=this._subcomponents(path),name=components.pop(),parent=this._get(components),ret=!1,parent!=null&&parent!==!1&&parent[name]!=null&&(obj=parent[name],ret=this._is_directory(obj)?Object.keys(obj):!0,delete parent[name]),ret},FileIndex}(),FileSource=function(){function FileSource(mnt_pt){this.mnt_pt=mnt_pt}return FileSource.prototype.redundant_storage=!1,FileSource.prototype._trim_mnt_pt=function(path){return path.slice(this.mnt_pt.length)},FileSource.prototype.fetch=function(path){return null},FileSource.prototype.store=function(path,file){return!1},FileSource.prototype.rm=function(path){return!1},FileSource.prototype.ls=function(path){return null},FileSource.prototype.mv=function(path1,path2,isFile){return isFile==null&&(isFile=!0),!1},FileSource.prototype.mkdir=function(path1){return!1},FileSource}(),CompositedFileSource=function(_super){function CompositedFileSource(mnt_pt,inpt_sources){var source,_i,_len;inpt_sources==null&&(inpt_sources=[]),CompositedFileSource.__super__.constructor.call(this,mnt_pt),this.sources={},this.mnt_pts=[],this.redundant_storage=!1;for(_i=0,_len=inpt_sources.length;_i<_len;_i++)source=inpt_sources[_i],this.add_source(source)}return __extends(CompositedFileSource,_super),CompositedFileSource.prototype._in_mnt_pt=function(path,mnt_pt){return mnt_pt==="/"||path===mnt_pt||path.slice(0,mnt_pt.length)===mnt_pt&&path[mnt_pt.length]==="/"},CompositedFileSource.prototype._get_applicable_sources=function(path){var a_mnt_pt,applicable,_i,_len,_ref;applicable=[],_ref=this.mnt_pts;for(_i=0,_len=_ref.length;_i<_len;_i++)a_mnt_pt=_ref[_i],this._in_mnt_pt(path,a_mnt_pt)&&applicable.push(this.sources[a_mnt_pt]);return applicable},CompositedFileSource.prototype.add_source=function(source){this.sources[source.mnt_pt]=source,this.mnt_pts.push(source.mnt_pt),this.redundant_storage||(this.redundant_storage=source.redundant_storage)},CompositedFileSource.prototype.fetch=function(path){var applicable,f,parent,_i,_len;applicable=this._get_applicable_sources(path);for(_i=0,_len=applicable.length;_i<_len;_i++){parent=applicable[_i],f=parent.fetch(path);if(f!=null)return f}return null},CompositedFileSource.prototype.store=function(path,file){var applicable,source,stored,_i,_len;applicable=this._get_applicable_sources(path),stored=!1;for(_i=0,_len=applicable.length;_i<_len;_i++){source=applicable[_i];if(!stored||!!source.redundant_storage)stored=source.store(path,file)||stored}return stored},CompositedFileSource.prototype.rm=function(path){var applicable,removed,source,_i,_len;applicable=this._get_applicable_sources(path),removed=!1;for(_i=0,_len=applicable.length;_i<_len;_i++){source=applicable[_i];if(!removed||!!source.redundant_storage)removed=source.rm(path)||removed}return removed},CompositedFileSource.prototype.ls=function(path){var applicable,list,source,src_list,_i,_len;applicable=this._get_applicable_sources(path),list=null;for(_i=0,_len=applicable.length;_i<_len;_i++)source=applicable[_i],src_list=source.ls(path),src_list!=null&&(list=list!=null?_.union(list,src_list):src_list);return list},CompositedFileSource.prototype.mv=function(path1,path2,isFile){var applicable,moved,source,_i,_len;isFile==null&&(isFile=!0),applicable=this._get_applicable_sources(path1),moved=!1;for(_i=0,_len=applicable.length;_i<_len;_i++)source=applicable[_i],moved=source.mv(path1,path2,isFile)||moved;return moved},CompositedFileSource.prototype.mkdir=function(path){var applicable,dirmade,source,_i,_len;applicable=this._get_applicable_sources(path),dirmade=!1;for(_i=0,_len=applicable.length;_i<_len;_i++)source=applicable[_i],dirmade||(dirmade=source.mkdir(path));return dirmade},CompositedFileSource}(FileSource),LocalStorageSource=function(_super){function LocalStorageSource(mnt_pt){var path;LocalStorageSource.__super__.constructor.call(this,mnt_pt),this.index=new FileIndex;for(path in localStorage)this.index.add_file(path,null)}return __extends(LocalStorageSource,_super),LocalStorageSource.prototype.redundant_storage=!0,LocalStorageSource.prototype.fetch=function(path){return localStorage[path]!=null?DoppioFile.fromJSON(path,localStorage[path]):null},LocalStorageSource.prototype.store=function(path,file){return file.mod&&!file.temp&&(localStorage[path]=file.toJSON(),this.index.add_file(path,file)),!0},LocalStorageSource.prototype.rm=function(path){var itPath,item,listing,_i,_len;listing=this.index.rm(path);if(typeof listing!="boolean")for(_i=0,_len=listing.length;_i<_len;_i++)item=listing[_i],itPath=path+"/"+item,delete localStorage[itPath];else{if(localStorage[path]==null)return!1;delete localStorage[path]}return!0},LocalStorageSource.prototype.ls=function(path){return this.index.ls(path)},LocalStorageSource.prototype.mv=function(path1,path2,isFile){var f_name,file1_ls,file1_obj,_i,_len;isFile==null&&(isFile=!0);if(isFile){file1_obj=this.fetch(path1);if(file1_obj==null||!this.rm(path1))return!1;file1_obj.path=path2,file1_obj.mod=!0,this.store(path2,file1_obj)}else{file1_ls=this.index.ls(path1);if(file1_ls==null)return!1;this.index.mkdir(path2);for(_i=0,_len=file1_ls.length;_i<_len;_i++)f_name=file1_ls[_i],this.mv(f_name,path2+f_name.substr(path1.length),!0);this.index.rm(path1)}return!0},LocalStorageSource.prototype.mkdir=function(path){return this.index.parent(path)?(this.index.mkdir(path),!0):!1},LocalStorageSource}(FileSource),WebserverSource=function(_super){function WebserverSource(mnt_pt,listings_path){var idx_data;WebserverSource.__super__.constructor.call(this,mnt_pt),listings_path!=null&&(idx_data=this._download_file(listings_path)),this.index=new FileIndex(idx_data!=null?JSON.parse(idx_data):void 0)}return __extends(WebserverSource,_super),WebserverSource.prototype._download_file=function(path){var array,char,data,i,req,typed_array,_i,_len;if(this.index!=null&&this.index.get_file(this.mnt_pt+path)===!1)return null;data=null;if(!$.browser.msie)$.ajax(path,{type:"GET",dataType:"text",async:!1,beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(theData,status,jqxhr){return data=theData}});else if(window.Blob){req=new XMLHttpRequest,req.open("GET",path,!1),req.responseType="arraybuffer",req.send();if(req.status===200){typed_array=new Uint8Array(req.response),array=[];for(i=_i=0,_len=typed_array.length;_i<_len;i=++_i)char=typed_array[i],array[i]=String.fromCharCode(char);data=array.join("")}}else req=new XMLHttpRequest,req.open("GET",path,!1),req.setRequestHeader("Accept-Charset","x-user-defined"),req.send(),req.status===200&&(data=GetIEByteArray_ByteStr(req.responseBody));return data},WebserverSource.prototype.fetch=function(path){var data,trim_path;return trim_path=this._trim_mnt_pt(path),data=this._download_file(trim_path),data!=null?new DoppioFile(path,data):null},WebserverSource.prototype.ls=function(path){return this.index.ls(path)},WebserverSource}(FileSource),CacheSource=
function(_super){function CacheSource(mnt_pt,src){CacheSource.__super__.constructor.call(this,mnt_pt),this.src=src,this.redundant_storage=src.redundant_storage,this.index=new FileIndex}return __extends(CacheSource,_super),CacheSource.prototype.fetch=function(path){var f;return f=this.index.get_file(path),f===!1&&(f=this.src.fetch(path),f!=null&&this.index.add_file(path,f)),f},CacheSource.prototype.store=function(path,file){return this.src.store(path,file)?(this.index.add_file(path,file),!0):!1},CacheSource.prototype.rm=function(path){return this.src.rm(path)?(this.index.rm(path),!0):!1},CacheSource.prototype.ls=function(path){return this.src.ls(path)},CacheSource.prototype.mkdir=function(path){return this.src.mkdir(path)},CacheSource.prototype.mv=function(file1,file2,isFile,ignoreSrc){var f,f_name,ls,success,_i,_len;isFile==null&&(isFile=!0),ignoreSrc==null&&(ignoreSrc=!1),success=ignoreSrc?!0:this.src.mv(file1,file2,isFile);if(isFile)f=this.index.get_file(file1),f&&(f.path=file2,this.index.rm(file1),this.index.add_file(file2,f));else{ls=this.index.ls(file1);for(_i=0,_len=ls.length;_i<_len;_i++)f_name=ls[_i],this.mv(f_name,path2+f_name.substr(path1.length),!0,!0);this.index.rm(file1)}return success},CacheSource}(FileSource),FSState=function(){function FSState(){var f,mainSource;this.home="/home/doppio",this.pwd=this.home,mainSource=new CompositedFileSource("/",[new LocalStorageSource("/"),new WebserverSource("/home/doppio","/browser/listings.json")]),this.files=new CacheSource("/",mainSource),f=new DoppioFile("/home/doppio/Hello.txt","Welcome to Doppio!"),f.mod=!0,this.files.store("/home/doppio/Hello.txt",f)}return FSState.prototype.resolve=function(path){var absolute,c,components,i,idx,processed,pwdCmps,_i,_j,_k,_len,_len1,_ref;components=path.split("/"),absolute=path[0]==="/";for(idx=_i=0,_len=components.length;_i<_len;idx=++_i)c=components[idx],c==="."&&(components[idx]=""),c==="~"&&(components[idx]=this.home);if(!absolute){pwdCmps=this.pwd.split("/");for(i=_j=_ref=pwdCmps.length-1;_j>=0;i=_j+=-1)components.unshift(pwdCmps[i])}for(idx=_k=0,_len1=components.length;_k<_len1;idx=++_k){c=components[idx];if(c===".."){processed=!1,i=idx-1;while(!processed)i<0&&(processed=!0),components[i]!==""&&(components[i]="",components[idx]="",processed=!0),i--}}return path=function(){var _l,_len2,_results;_results=[];for(idx=_l=0,_len2=components.length;_l<_len2;idx=++_l)c=components[idx],c!==""&&_results.push(c);return _results}().join("/"),path[0]!=="/"&&(path="/"+path),path},FSState.prototype.open=function(path,mode){var f;return mode==null&&(mode="r"),path=this.resolve(path),this.is_directory(path)?null:mode==="w"?(f=new DoppioFile(path),f.mod=!0,f):this.files.fetch(path)},FSState.prototype.close=function(file){this.files.store(file.path,file),file.mod=!1},FSState.prototype.list=function(path){return this.files.ls(this.resolve(path))},FSState.prototype.is_file=function(path){return this.files.fetch(this.resolve(path))!=null},FSState.prototype.is_directory=function(path){return this.list(path)!=null},FSState.prototype.rm=function(path,isDir){return isDir==null&&(isDir=!1),path=this.resolve(path),this.is_directory(path)!==isDir?!1:this.files.rm(path)},FSState.prototype.chdir=function(dir){return dir=this.resolve(dir),this.is_directory(dir)?(this.pwd=dir,dir):null},FSState.prototype.mkdir=function(dir){return dir=this.resolve(dir),this.is_directory(dir||this.is_file(dir))?!1:this.files.mkdir(dir)},FSState.prototype.mv=function(file1,file2){return file1=this.resolve(file1),file2=this.resolve(file2),this.files.mv(file1,file2)},FSState}(),fs_state=new FSState,Stat=function(){function Stat(file){this.file=file,this.file!=null&&(this.size=this.file.data.length,this.mtime=this.file.mtime,this.is_file=!0,this.is_directory=!1,this.mode=this.file.mode)}return Stat.fromPath=function(path){var file,stat;return path===""?null:fs_state.is_directory(path)?(stat=new Stat,stat.size=1,stat.mtime=(new Date).getTime(),stat.is_file=!1,stat.is_directory=!0,stat.mode=420,stat):(file=fs_state.open(path,"r"),file==null?null:new Stat(file))},Stat.prototype.isFile=function(){return this.is_file},Stat.prototype.isDirectory=function(){return this.is_directory},Stat}(),win.Buffer=function(){function Buffer(obj){obj instanceof Array?this.array=obj:this.array=Array(obj)}return Buffer.prototype.readUInt8=function(i){return this.array[i]&255},Buffer}(),root.fs={statSync:function(path){return Stat.fromPath(path)},fstatSync:function(fp){return new Stat(fp)},openSync:function(path,mode){var err,f;__indexOf.call(mode,"w")<0?__indexOf.call(mode,"a")<0?mode="r":mode="a":mode="w",f=fs_state.open(path,mode);if(f==null)throw err=Error(),err.code="ENOENT",err;return f},readSync:function(fd,buf,offset,length,pos){var d,data,i,_i,_len;data=fd.read(length,pos);for(i=_i=0,_len=data.length;_i<_len;i=++_i)d=data[i],buf.array[offset+i]=data.charCodeAt(i)&255;return data.length},readFileSync:function(path){var f;f=fs_state.open(path,"r");if(f==null)throw"File does not exist.";return f.data},writeFileSync:function(path,data,temp){var f;return f=fs_state.open(path,"w"),f.temp=temp===!0,f.write(data),fs_state.close(f)},writeSync:function(fd,buffer,offset,len){var i;return fd.write(function(){var _i,_ref,_results;_results=[];for(i=_i=offset,_ref=offset+len;_i<_ref;i=_i+=1)_results.push(String.fromCharCode(buffer.readUInt8(i)));return _results}().join(""))},closeSync:function(fd){return fs_state.close(fd)},readdirSync:function(path){var dir_contents;dir_contents=fs_state.list(path);if(dir_contents==null||path==="")throw"Could not read directory '"+path+"'";return dir_contents},unlinkSync:function(path){if(!fs_state.rm(path))throw"Could not unlink '"+path+"'"},rmdirSync:function(path){if(!fs_state.rm(path,!0))throw"Could not delete '"+path+"'"},existsSync:function(path){return path!==""&&(fs_state.is_file(path)||fs_state.is_directory(path))},mkdirSync:function(path){if(!fs_state.mkdir(path))throw"Could not make directory "+path},renameSync:function(path1,path2){if(!fs_state.mv(path1,path2))throw"Could not rename "+path1+" to "+path2},chmodSync:function(path,access){var f;if(!fs_state.is_file(path))throw"File "+path1+" does not exist.";return f=fs_state.open(path,"r"),f.mod=!0,f.mode=access,fs_state.close(f),!0}},root.path={normalize:function(path){return path},resolve:function(){var parts;return parts=1>arguments.length?[]:__slice.call(arguments,0),fs_state.resolve(parts.join("/"))},basename:function(path,ext){var base;return base=path.replace(/^.*[\/\\]/,""),(ext!=null?ext.length:void 0)!=null&&base.slice(base.length-ext.length)===ext&&(base=base.slice(0,base.length-ext.length)),base},extname:function(path){return path.replace(/^.*(\..*)/,"$1")}},root.process={cwd:function(){return fs_state.pwd},chdir:function(dir){var absdir;absdir=fs_state.chdir(dir);if(absdir==null)throw"Invalid directory";return absdir}}}.call(this),function(){var debug,error,exceptions,gLong,root,trace,vtrace,_ref,_ref1;gLong=require("../vendor/gLong.js"),exceptions=require("./exceptions"),_ref=require("./logging"),trace=_ref.trace,vtrace=_ref.vtrace,error=_ref.error,debug=_ref.debug,"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref1=window.util)!=null?_ref1:window.util={},root.INT_MAX=Math.pow(2,31)-1,root.INT_MIN=-root.INT_MAX-1,root.FLOAT_POS_INFINITY=Math.pow(2,128),root.FLOAT_NEG_INFINITY=-1*root.FLOAT_POS_INFINITY,root.FLOAT_POS_INFINITY_AS_INT=2139095040,root.FLOAT_NEG_INFINITY_AS_INT=-8388608,root.FLOAT_NaN_AS_INT=2143289344,root.int_mod=function(rs,a,b){return b===0&&exceptions.java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a%b},root.int_div=function(rs,a,b){return b===0&&exceptions.java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a===root.INT_MIN&&b===-1?a:a/b|0},root.long_mod=function(rs,a,b){return b.isZero()&&exceptions.java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a.modulo(b)},root.long_div=function(rs,a,b){return b.isZero()&&exceptions.java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a.div(b)},root.float2int=function(a){return a>root.INT_MAX?root.INT_MAX:a<root.INT_MIN?root.INT_MIN:a|0},root.intbits2float=function(int32){var exponent,f_view,i_view,sign,significand,value;if(typeof Int32Array!="undefined"&&Int32Array!==null)return i_view=new Int32Array([int32]),f_view=new Float32Array(i_view.buffer),f_view[0];if(int32===root.FLOAT_POS_INFINITY_AS_INT)return Number.POSITIVE_INFINITY;if(int32===root.FLOAT_NEG_INFINITY_AS_INT)return Number.NEGATIVE_INFINITY;sign=(int32&2147483648)>>>31,exponent=(int32&2139095040)>>>23,significand=int32&8388607,exponent===0?value=Math.pow(-1,sign)*significand*Math.pow(2,-149):value=Math.pow(-1,sign)*(1+significand*Math.pow(2,-23))*Math.pow(2,exponent-127);if(value<root.FLOAT_NEG_INFINITY||value>root.FLOAT_POS_INFINITY)value=NaN;return value},root.longbits2double=function(uint32_a,uint32_b){var d_view,exponent,i_view,sign,significand,value;return typeof Uint32Array!="undefined"&&Uint32Array!==null?(i_view=new Uint32Array(2),i_view[0]=uint32_b,i_view[1]=uint32_a,d_view=new Float64Array(i_view.buffer),d_view[0]):(sign=(uint32_a&2147483648)>>>31,exponent=(uint32_a&2146435072)>>>20,significand=root.lshift(uint32_a&1048575,32)+uint32_b,exponent===0&&significand===0?0:exponent===2047?significand===0?sign===1?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:NaN:(exponent===0?value=Math.pow(-1,sign)*significand*Math.pow(2,-1074):value=Math.pow(-1,sign)*(1+significand*Math.pow(2,-52))*Math.pow(2,exponent-1023),value))},root.wrap_float=function(a){return a>3.4028234663852886e38?Number.POSITIVE_INFINITY:0<a&&a<1.401298464324817e-45?0:a<-3.4028234663852886e38?Number.NEGATIVE_INFINITY:0>a&&a>-1.401298464324817e-45?0:a},root.cmp=function(a,b){return a===b?0:a<b?-1:a>b?1:null},root.lshift=function(x,n){return x*Math.pow(2,n)},root.read_uint=function(bytes){var i,n,sum,_i;n=bytes.length-1,sum=0;for(i=_i=0;_i<=n;i=_i+=1)sum+=root.lshift(bytes[i],8*(n-i));return sum},root.chars2js_str=function(jvm_carr,offset,count){return root.bytes2str(jvm_carr.array).substr(offset!=null?offset:0,count)},root.bytestr_to_array=function(bytecode_string){var i,_i,_ref2,_results;_results=[];for(i=_i=0,_ref2=bytecode_string.length;_i<_ref2;i=_i+=1)_results.push(bytecode_string.charCodeAt(i)&255);return _results},root.array_to_bytestr=function(bytecode_array){var b;return function(){var _i,_len,_results;_results=[];for(_i=0,_len=bytecode_array.length;_i<_len;_i++)b=bytecode_array[_i],_results.push(String.fromCharCode(b));return _results}().join("")},root.parse_flags=function(flag_byte){return{"public":flag_byte&1,"private":flag_byte&2,"protected":flag_byte&4,"static":flag_byte&8,"final":flag_byte&16,"synchronized":flag_byte&32,"super":flag_byte&32,"volatile":flag_byte&64,"transient":flag_byte&128,"native":flag_byte&256,"interface":flag_byte&512,"abstract":flag_byte&1024,strict:flag_byte&2048}},root.escape_whitespace=function(str){return str.replace(/\s/g,function(c){switch(c){case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"":return"\\v";case"\f":return"\\f";default:return c}})},root.format_extra_info=function(entry){var info,type;type=entry.type,info=typeof entry.deref=="function"?entry.deref():void 0;if(!info)return"";switch(type){case"Method":case"InterfaceMethod":return"	//  "+info["class"]+"."+info.sig;case"Field":return"	//  "+info["class"]+"."+info.name+":"+info.type;case"NameAndType":return"//  "+info.name+":"+info.type;default:if(root.is_string(info))return"	//  "+root.escape_whitespace(info)}},root.BytesArray=function(){function BytesArray(raw_array,start,end){this.raw_array=raw_array,this.start=start!=null?start:0,this.end=end!=null?end:this.raw_array.length,this._index=0}return BytesArray.prototype.rewind=function(){return this._index=0},BytesArray.prototype.pos=function(){return this._index},BytesArray.prototype.skip=function(bytes_count){return this._index+=bytes_count},BytesArray.prototype.has_bytes=function(){return this.start+this._index<this.end},BytesArray.prototype.get_uint=function(bytes_count){var rv;return rv=root.read_uint(this.raw_array.slice(this.start+this._index,this.start+this._index+bytes_count)),this._index+=bytes_count,rv},BytesArray.prototype.get_int=function(bytes_count){var bytes_to_set;return bytes_to_set=32-bytes_count*8,this.get_uint(bytes_count)<<bytes_to_set>>bytes_to_set},BytesArray.prototype.read=function(bytes_count){var rv;return rv=this.raw_array.slice(this.start+this._index,this.start+this._index+bytes_count),this._index+=bytes_count,rv},BytesArray.prototype.peek=function(){return this.raw_array[this.start+this._index]},BytesArray.prototype.size=function(){return this.end-this.start-this._index},BytesArray.prototype.splice=function(len){var arr;return arr=new root.BytesArray(this.raw_array,this.start+this._index,this.start+this._index+len),this._index+=len,arr},BytesArray}(),root.initial_value=function(type_str){var _ref2;return type_str==="J"?gLong.ZERO:(_ref2=type_str[0])==="["||_ref2==="L"?null:0},root.is_string=function(obj){return typeof obj=="string"||obj instanceof String},root.lookup_handler=function(handlers,object){var handler,obj;obj=object;while(obj!=null){handler=handlers[obj.constructor.name];if(handler)return handler;obj=Object.getPrototypeOf(obj)}return null},root.ext_classname=function(str){return str.replace(/\//g,".")},root.int_classname=function(str){return str.replace(/\./g,"/")},root.bytes2str=function(bytes){var char_array,idx,x,y,z;return idx=0,char_array=function(){var _results;_results=[];while(idx<bytes.length){x=bytes[idx++]&255;if(x===0)break;_results.push(String.fromCharCode(x>127?x>223?(y=bytes[idx++],z=bytes[idx++],((x&15)<<12)+((y&63)<<6)+(z&63)):(y=bytes[idx++],((x&31)<<6)+(y&63)):x))}return _results}(),char_array.join("")},root.last=function(array){return array[array.length-1]},root.SafeMap=function(){function SafeMap(){this.cache=Object.create(null),this.proto_cache=void 0}return SafeMap.prototype.get=function(key){return this.cache[key]!=null?this.cache[key]:key+""==="__proto__"&&this.proto_cache!==void 0?this.proto_cache:void 0},SafeMap.prototype.set=function(key,value){return key+""!=="__proto__"?this.cache[key]=value:this.proto_cache=value},SafeMap}()}.call(this),function(){var debug,error,root,trace,types,vtrace,_,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};_=require("../vendor/_.js"),_ref=require("./logging"),trace=_ref.trace,vtrace=_ref.vtrace,error=_ref.error,debug=_ref.debug,types=require("./types"),"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref1=window.exceptions)!=null?_ref1:window.exceptions={},root.HaltException=function(){function HaltException(exit_code){this.exit_code=exit_code}return HaltException.prototype.toplevel_catch_handler=function(){if(this.exit_code!==0)return error("\nExited with code "+this.exit_code)},HaltException}(),root.ReturnException="RETURNEXCEPTION",root.YieldException=function(){function YieldException(condition){this.condition=condition}return YieldException}(),root.YieldIOException=function(_super){function YieldIOException(){return YieldIOException.__super__.constructor.apply(this,arguments)}return __extends(YieldIOException,_super),YieldIOException}(root.YieldException),root.JavaException=function(){function JavaException(exception){this.exception=exception}return JavaException.prototype.method_catch_handler=function(rs,method,top_of_stack){var cf,etype,exception_handlers,handler,_ref2,_ref3;cf=rs.curr_frame();if(!top_of_stack&&method.has_bytecode){cf.pc-=3;while(cf.pc>0&&((_ref2=method.code.opcodes[cf.pc])!=null?!_ref2.name.match(/^invoke/):!void 0))--cf.pc}return exception_handlers=(_ref3=method.code)!=null?_ref3.exception_handlers:void 0,etype=this.exception.type,handler=_.find(exception_handlers,function(eh){var _ref4;return eh.start_pc<=(_ref4=cf.pc)&&_ref4<eh.end_pc&&(eh.catch_type==="<any>"||types.is_castable(rs,etype,types.c2t(eh.catch_type)))}),handler!=null?(cf.stack=[],rs.push(this.exception),cf.pc=handler.handler_pc,!0):!1},JavaException.prototype.toplevel_catch_handler=function(rs){var msg;return msg=this.exception.get_field(rs,"java/lang/Throwable/detailMessage"),rs.show_state(),rs.push2(rs.curr_thread,this.exception),rs.method_lookup({"class":"java/lang/Thread",sig:"dispatchUncaughtException(Ljava/lang/Throwable;)V"}).setup_stack(rs)},JavaException}(),root.java_throw=function(rs,cls,msg){var method_spec,my_sf,v;throw method_spec={"class":cls,sig:"<init>(Ljava/lang/String;)V"},v=rs.init_object(cls),rs.push_array([v,v,rs.init_string(msg)]),my_sf=rs.curr_frame(),rs.method_lookup(method_spec).setup_stack(rs),my_sf.runner=function(){throw my_sf.method.has_bytecode?my_sf.runner=function(){return my_sf.method.run_bytecode(rs)}:my_sf.runner=null,new root.JavaException(rs.pop())},root.ReturnException}}.call(this),function(){var gLong,root,_ref,_ref1,__slice=[].slice;gLong=require("../vendor/gLong.js"),"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref=window.logging)!=null?_ref:window.logging={},root.debug_vars=function(arr){return arr.map(function(e){return e===null?"!":e===void 0?"undef":e.ref!=null?"*"+e.ref:e instanceof gLong?""+e+"L":e})},root.VTRACE=10,root.TRACE=9,root.DEBUG=5,root.ERROR=1,(_ref1=root.log_level)==null&&(root.log_level=root.ERROR),typeof console!="undefined"&&console!==null||(typeof window!="undefined"&&window!==null?window.console:void 0)||(window.console={log:function(){},error:function(){var msgs;throw msgs=1>arguments.length?[]:__slice.call(arguments,0),msgs.join(" ")+"\n"},profile:function(){},profileEnd:function(){}}),root.log=function(){var level,msgs;level=arguments[0],msgs=2>arguments.length?[]:__slice.call(arguments,1);if(level<=root.log_level)return console[level===1?"error":"log"](msgs.join(" "))},root.vtrace=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.VTRACE].concat(__slice.call(msgs)))},root.trace=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.TRACE].concat(__slice.call(msgs)))},root.debug=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.DEBUG].concat(__slice.call(msgs)))},root.error=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.ERROR].concat(__slice.call(msgs)))}}.call(this),function(){var external2internal,is_subclass,is_subinterface,k,root,util,v,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};root=typeof exports!="undefined"&&exports!==null?exports:(_ref=window.types)!=null?_ref:window.types={},util=require("./util"),"use strict",root.internal2external={B:"byte",C:"char",D:"double",F:"float",I:"int",J:"long",S:"short",V:"void",Z:"boolean"},external2internal={},_ref1=root.internal2external;for(k in _ref1)v=_ref1[k],external2internal[v]=k;root.carr2type=function(carr){var c;c=carr.shift();if(c==null)return null;if(c in root.internal2external)return new root.PrimitiveType(root.internal2external[c]);if(c==="L")return new root.ClassType(function(){var _results;_results=[];while((c=carr.shift())!==";")_results.push(c);return _results}().join(""));if(c==="[")return new root.ArrayType(root.carr2type(carr));throw carr.unshift(c),Error("Unrecognized type string: "+carr.join(""))},root.str2type=function(type_str){var c;c=type_str[0];if(c in root.internal2external)return new root.PrimitiveType(root.internal2external[c]);if(c==="L")return new root.ClassType(type_str.slice(1,-1));if(c==="[")return new root.ArrayType(root.str2type(type_str.slice(1)));throw Error("Unrecognized type string: "+type_str)},root.c2t=function(type_str){return type_str[0]==="["?root.str2type(type_str):new root.ClassType(type_str)},root.Type=function(){function Type(){}return Type.prototype.toString=function(){return this.valueOf()},Type}(),root.PrimitiveType=function(_super){function PrimitiveType(name){if(type_cache.hasOwnProperty(name))return type_cache[name];this.name=name,type_cache[name]=this}var type_cache;return __extends(PrimitiveType,_super),type_cache={},PrimitiveType.prototype.valueOf=function(){return external2internal[this.name]},PrimitiveType.prototype.toExternalString=function(){return this.name},PrimitiveType}(root.Type),root.ArrayType=function(_super){function ArrayType(component_type){this.component_type=component_type}return __extends(ArrayType,_super),ArrayType.prototype.valueOf=function(){return"["+this.component_type},ArrayType.prototype.toClassString=function(){return this.valueOf()},ArrayType.prototype.toExternalString=function(){return util.ext_classname(this.valueOf())},ArrayType}(root.Type),root.ClassType=function(_super){function ClassType(class_name){this.class_name=class_name}return __extends(ClassType,_super),ClassType.prototype.valueOf=function(){return"L"+this.class_name+";"},ClassType.prototype.toClassString=function(){return this.class_name},ClassType.prototype.toExternalString=function(){return util.ext_classname(this.class_name)},ClassType}(root.Type),is_subclass=function(rs,class1,class2){return class1.this_class===class2.this_class?!0:class1.super_class?is_subclass(rs,rs.class_lookup(class1.super_class),class2):!1},is_subinterface=function(rs,iface1,iface2){var i,super_iface,_i,_len,_ref2;if(iface1.this_class===iface2.this_class)return!0;_ref2=iface1.interfaces;for(_i=0,_len=_ref2.length;_i<_len;_i++){i=_ref2[_i],super_iface=rs.class_lookup(root.c2t(iface1.constant_pool.get(i).deref()));if(is_subinterface(rs,super_iface,iface2))return!0}return iface1.super_class?is_subinterface(rs,rs.class_lookup(iface1.super_class),iface2):!1},root.check_cast=function(rs,obj,classname){return root.is_castable(rs,obj.type,root.c2t(classname))},root.is_castable=function(rs,type1,type2){var c1,c2,_ref2;return type1 instanceof root.PrimitiveType||type2 instanceof root.PrimitiveType?type1===type2:type1 instanceof root.ArrayType?type2 instanceof root.ArrayType?root.is_castable(rs,type1.component_type,type2.component_type):(c2=rs.class_lookup(type2),c2.access_flags["interface"]?(_ref2=type2.class_name)==="java/lang/Cloneable"||_ref2==="java/io/Serializable":type2.class_name==="java/lang/Object"):type2 instanceof root.ArrayType?!1:(c1=rs.class_lookup(type1),c2=rs.class_lookup(type2),c1.access_flags["interface"]?c2.access_flags["interface"]?is_subinterface(rs,c1,c2):type2.class_name==="java/lang/Object":c2.access_flags["interface"]?is_subinterface(rs,c1,c2):is_subclass(rs,c1,c2))}}.call(this),function(){var debug,error,java_throw,log,root,types,util,vtrace,_,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};_=require("../vendor/_.js"),util=require("./util"),types=require("./types"),vtrace=require("./logging").vtrace,java_throw=require("./exceptions").java_throw,_ref=require("./logging"),log=_ref.log,debug=_ref.debug,error=_ref.error,"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref1=window.java_object)!=null?_ref1:window.java_object={},root.JavaArray=function(){function JavaArray(rs,type,obj){this.type=type,this.ref=rs.high_oref++,this.array=obj}return JavaArray.prototype.clone=function(rs){return new root.JavaArray(rs,this.type,_.clone(this.array))},JavaArray.prototype.get_field_from_offset=function(rs,offset){return this.array[offset.toInt()]},JavaArray.prototype.set_field_from_offset=function(rs,offset,value){return this.array[offset.toInt()]=value},JavaArray.prototype.toString=function(){return this.array.length>10?"<"+this.type+" of length "+this.array.length+" (*"+this.ref+")>":"<"+this.type+" ["+this.array+"] (*"+this.ref+")>"},JavaArray}(),root.JavaObject=function(){function JavaObject(rs,type,cls,obj){var field;this.type=type,this.cls=cls,obj==null&&(obj={}),this.ref=rs.high_oref++,this.fields=Object.create(this.cls.get_default_fields(rs));for(field in obj)obj.hasOwnProperty(field)&&(this.fields[field]=obj[field]);return}return JavaObject.prototype.clone=function(rs){return new root.JavaObject(rs,this.type,this.cls,_.clone(this.fields))},JavaObject.prototype.set_field=function(rs,name,val){this.fields[name]!==void 0?this.fields[name]=val:java_throw(rs,"java/lang/NoSuchFieldError",name)},JavaObject.prototype.get_field=function(rs,name){return this.fields[name]!==void 0?this.fields[name]:java_throw(rs,"java/lang/NoSuchFieldError",name)},JavaObject.prototype.get_field_from_offset=function(rs,offset){var f;return f=this._get_field_from_offset(rs,this.cls,offset.toInt()),f.field.access_flags["static"]?rs.static_get({"class":this.type.toClassString(),name:f.field.name}):this.get_field(rs,f.cls+"/"+f.field.name)},JavaObject.prototype._get_field_from_offset=function(rs,cls,offset){var classname;classname=cls.this_class.toClassString();while(cls.fields[offset]==null)cls.super_class==null&&java_throw(rs,"java/lang/NullPointerException","field "+offset+" doesn't exist in class "+classname),cls=rs.class_lookup(cls.super_class);return{field:cls.fields[offset],cls:cls.this_class.toClassString()}},JavaObject.prototype.set_field_from_offset=function(rs,offset,value){var f;return f=this._get_field_from_offset(rs,this.cls,offset.toInt()),f.field.access_flags["static"]?(rs.push(value),rs.static_put({"class":this.type.toClassString(),name:f.field.name})):this.set_field(rs,f.cls+"/"+f.field.name,value)},JavaObject.prototype.toString=function(){return this.type.toClassString()==="java/lang/String"?"<"+this.type+" '"+this.jvm2js_str()+"' (*"+this.ref+")>":"<"+this.type+" (*"+this.ref+")>"},JavaObject.prototype.jvm2js_str=function(){return util.chars2js_str(this.fields["java/lang/String/value"],this.fields["java/lang/String/offset"],this.fields["java/lang/String/count"])},JavaObject}(),root.JavaClassObject=function(_super){function JavaClassObject(rs,$type,file){var type;this.$type=$type,this.file=file,type=types.c2t("java/lang/Class"),JavaClassObject.__super__.constructor.call(this,rs,type,rs.class_lookup(type))}return __extends(JavaClassObject,_super),JavaClassObject.prototype.toString=function(){return"<Class "+this.$type+" (*"+this.ref+")>"},JavaClassObject}(root.JavaObject),root.thread_name=function(rs,thread){return util.chars2js_str(thread.get_field(rs,"java/lang/Thread/name"))}}.call(this),function(){var JavaArray,JavaException,JavaObject,ReturnException,c2t,gLong,java_throw,jsr,root,types,util,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};gLong=require("../vendor/gLong.js"),util=require("./util"),types=require("./types"),_ref=require("./exceptions"),java_throw=_ref.java_throw,ReturnException=_ref.ReturnException,JavaException=_ref.JavaException,c2t=types.c2t,_ref1=require("./java_object"),JavaObject=_ref1.JavaObject,JavaArray=_ref1.JavaArray,"use strict",root=typeof exports!="undefined"&&exports!==null?exports:window.opcodes={},root.Opcode=function(){function Opcode(name,params){var prop,val,_ref2,_ref3;this.name=name,params==null&&(params={});for(prop in params)val=params[prop],this[prop]=val;(_ref2=this.execute)==null&&(this.execute=this._execute),this.byte_count=(_ref3=params.byte_count)!=null?_ref3:0}return Opcode.prototype.take_args=function(code_array){return this.args=function(){var _i,_ref2,_results;_results=[];for(_i=0,_ref2=this.byte_count;0>_ref2?_i>_ref2:_i<_ref2;0>_ref2?_i--:_i++)_results.push(code_array.get_uint(1));return _results}.call(this)},Opcode.prototype.annotate=function(){return""},Opcode}(),root.FieldOpcode=function(_super){function FieldOpcode(name,params){FieldOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(FieldOpcode,_super),FieldOpcode.prototype.take_args=function(code_array,constant_pool){return this.field_spec_ref=code_array.get_uint(2),this.field_spec=constant_pool.get(this.field_spec_ref).deref()},FieldOpcode.prototype.annotate=function(idx,pool){return"	#"+this.field_spec_ref+";"+util.format_extra_info(pool.get(this.field_spec_ref))},FieldOpcode}(root.Opcode),root.ClassOpcode=function(_super){function ClassOpcode(name,params){ClassOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(ClassOpcode,_super),ClassOpcode.prototype.take_args=function(code_array,constant_pool){return this.class_ref=code_array.get_uint(2),this["class"]=constant_pool.get(this.class_ref).deref()},ClassOpcode.prototype.annotate=function(idx,pool){return"	#"+this.class_ref+";"+util.format_extra_info(pool.get(this.class_ref))},ClassOpcode}(root.Opcode),root.InvokeOpcode=function(_super){function InvokeOpcode(name,params){InvokeOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(InvokeOpcode,_super),InvokeOpcode.prototype.take_args=function(code_array,constant_pool){return this.method_spec_ref=code_array.get_uint(2),this.method_spec=constant_pool.get(this.method_spec_ref).deref()},InvokeOpcode.prototype.annotate=function(idx,pool){return"	#"+this.method_spec_ref+(this.name==="invokeinterface"?",  "+this.count:"")+(";"+util.format_extra_info(pool.get(this.method_spec_ref)))},InvokeOpcode.prototype.execute=function(rs){var my_sf;my_sf=rs.curr_frame();if(rs.method_lookup(this.method_spec).setup_stack(rs)!=null)throw my_sf.pc+=1+this.byte_count,ReturnException},InvokeOpcode}(root.Opcode),root.DynInvokeOpcode=function(_super){function DynInvokeOpcode(name,params){DynInvokeOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}var get_param_word_size;return __extends(DynInvokeOpcode,_super),DynInvokeOpcode.prototype.take_args=function(code_array,constant_pool){return DynInvokeOpcode.__super__.take_args.call(this,code_array,constant_pool),this.name==="invokeinterface"?(this.count=code_array.get_uint(1),code_array.skip(1),this.byte_count+=2):this.count=1+get_param_word_size(this.method_spec.sig),this.cache=Object.create(null)},DynInvokeOpcode.prototype.execute=function(rs){var cls,my_sf,obj,stack;my_sf=rs.curr_frame(),stack=my_sf.stack,obj=stack[stack.length-this.count],cls=rs.check_null(obj).type.toClassString();if(rs.method_lookup({"class":cls,sig:this.method_spec.sig}).setup_stack(rs)!=null)throw my_sf.pc+=1+this.byte_count,ReturnException},get_param_word_size=function(spec){var c,size,state,_i,_len;state="name",size=0;for(_i=0,_len=spec.length;_i<_len;_i++){c=spec[_i];switch(state){case"name":c==="("&&(state="type");break;case"type":if(c===")")return size;c==="J"||c==="D"?size+=2:++size,c==="L"?state="class":c==="["&&(state="array");break;case"class":c===";"&&(state="type");break;case"array":c==="L"?state="class":c!=="["&&(state="type")}}},DynInvokeOpcode}(root.InvokeOpcode),root.LoadConstantOpcode=function(_super){function LoadConstantOpcode(){return LoadConstantOpcode.__super__.constructor.apply(this,arguments)}return __extends(LoadConstantOpcode,_super),LoadConstantOpcode.prototype.take_args=function(code_array,constant_pool){var _ref2;this.cls=constant_pool.cls,this.constant_ref=code_array.get_uint(this.byte_count),this.constant=constant_pool.get(this.constant_ref);if((_ref2=this.constant.type)==="String"||_ref2==="class")return this.str_constant=constant_pool.get(this.constant.value)},LoadConstantOpcode.prototype.annotate=function(idx,pool){var _ref2;return"	#"+this.constant_ref+";	// "+this.constant.type+" "+((_ref2=this.constant.type)==="String"||_ref2==="class"?util.escape_whitespace(this.constant.deref()):this.constant.value)},LoadConstantOpcode.prototype._execute=function(rs){switch(this.constant.type){case"String":rs.push(rs.init_string(this.str_constant.value,!0));break;case"class":rs.push(rs.jclass_obj(c2t(this.str_constant.value),!1));break;default:rs.push(this.constant.value)}},LoadConstantOpcode}(root.Opcode),root.BranchOpcode=function(_super){function BranchOpcode(name,params){var _ref2;params==null&&(params={}),(_ref2=params.byte_count)==null&&(params.byte_count=2),BranchOpcode.__super__.constructor.call(this,name,params)}return __extends(BranchOpcode,_super),BranchOpcode.prototype.take_args=function(
code_array){return this.offset=code_array.get_int(this.byte_count)},BranchOpcode.prototype.annotate=function(idx,pool){return"	"+(idx+this.offset)},BranchOpcode}(root.Opcode),root.UnaryBranchOpcode=function(_super){function UnaryBranchOpcode(name,params){UnaryBranchOpcode.__super__.constructor.call(this,name,{execute:function(rs){var v;return v=rs.pop(),params.cmp(v)?(rs.inc_pc(this.offset),!1):!0}})}return __extends(UnaryBranchOpcode,_super),UnaryBranchOpcode}(root.BranchOpcode),root.BinaryBranchOpcode=function(_super){function BinaryBranchOpcode(name,params){BinaryBranchOpcode.__super__.constructor.call(this,name,{execute:function(rs){var v1,v2;return v2=rs.pop(),v1=rs.pop(),params.cmp(v1,v2)?(rs.inc_pc(this.offset),!1):!0}})}return __extends(BinaryBranchOpcode,_super),BinaryBranchOpcode}(root.BranchOpcode),root.PushOpcode=function(_super){function PushOpcode(){return PushOpcode.__super__.constructor.apply(this,arguments)}return __extends(PushOpcode,_super),PushOpcode.prototype.take_args=function(code_array){return this.value=code_array.get_int(this.byte_count)},PushOpcode.prototype.annotate=function(idx,pool){return"	"+this.value},PushOpcode.prototype._execute=function(rs){return rs.push(this.value)},PushOpcode}(root.Opcode),root.IIncOpcode=function(_super){function IIncOpcode(name,params){IIncOpcode.__super__.constructor.call(this,name,params)}return __extends(IIncOpcode,_super),IIncOpcode.prototype.take_args=function(code_array,constant_pool,wide){var arg_size;return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",arg_size=2,this.byte_count=5):(arg_size=1,this.byte_count=2),this.index=code_array.get_uint(arg_size),this["const"]=code_array.get_int(arg_size)},IIncOpcode.prototype.annotate=function(idx,pool){return"	"+this.index+", "+this["const"]},IIncOpcode.prototype._execute=function(rs){var v;return v=rs.cl(this.index)+this["const"],rs.put_cl(this.index,v|0)},IIncOpcode}(root.Opcode),root.LoadOpcode=function(_super){function LoadOpcode(name,params){var _ref2;params==null&&(params={}),(_ref2=params.execute)==null&&(params.execute=name.match(/[ld]load/)?function(rs){return rs.push2(rs.cl(this.var_num),null)}:function(rs){return rs.push(rs.cl(this.var_num))}),LoadOpcode.__super__.constructor.call(this,name,params)}return __extends(LoadOpcode,_super),LoadOpcode.prototype.take_args=function(code_array){return this.var_num=parseInt(this.name[6])},LoadOpcode}(root.Opcode),root.LoadVarOpcode=function(_super){function LoadVarOpcode(){return LoadVarOpcode.__super__.constructor.apply(this,arguments)}return __extends(LoadVarOpcode,_super),LoadVarOpcode.prototype.take_args=function(code_array,constant_pool,wide){return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",this.byte_count=3,this.var_num=code_array.get_uint(2)):(this.byte_count=1,this.var_num=code_array.get_uint(1))},LoadVarOpcode.prototype.annotate=function(idx,pool){return"	"+this.var_num},LoadVarOpcode}(root.LoadOpcode),root.StoreOpcode=function(_super){function StoreOpcode(name,params){var _ref2;params==null&&(params={}),(_ref2=params.execute)==null&&(params.execute=name.match(/[ld]store/)?function(rs){return rs.put_cl2(this.var_num,rs.pop2())}:function(rs){return rs.put_cl(this.var_num,rs.pop())}),StoreOpcode.__super__.constructor.call(this,name,params)}return __extends(StoreOpcode,_super),StoreOpcode.prototype.take_args=function(code_array){return this.var_num=parseInt(this.name[7])},StoreOpcode}(root.Opcode),root.StoreVarOpcode=function(_super){function StoreVarOpcode(name,params){StoreVarOpcode.__super__.constructor.call(this,name,params)}return __extends(StoreVarOpcode,_super),StoreVarOpcode.prototype.take_args=function(code_array,constant_pool,wide){return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",this.byte_count=3,this.var_num=code_array.get_uint(2)):(this.byte_count=1,this.var_num=code_array.get_uint(1))},StoreVarOpcode.prototype.annotate=function(idx,pool){return"	"+this.var_num},StoreVarOpcode}(root.StoreOpcode),root.SwitchOpcode=function(_super){function SwitchOpcode(name,params){SwitchOpcode.__super__.constructor.call(this,name,params),this.byte_count=null}return __extends(SwitchOpcode,_super),SwitchOpcode.prototype.annotate=function(idx,pool){var match,offset;return"{\n"+function(){var _ref2,_results;_ref2=this.offsets,_results=[];for(match in _ref2)offset=_ref2[match],_results.push("		"+match+": "+(idx+offset)+";\n");return _results}.call(this).join("")+("		default: "+(idx+this._default)+" }")},SwitchOpcode.prototype.execute=function(rs){var key;return key=rs.pop(),key in this.offsets?rs.inc_pc(this.offsets[key]):rs.inc_pc(this._default),!1},SwitchOpcode}(root.BranchOpcode),root.LookupSwitchOpcode=function(_super){function LookupSwitchOpcode(){return LookupSwitchOpcode.__super__.constructor.apply(this,arguments)}return __extends(LookupSwitchOpcode,_super),LookupSwitchOpcode.prototype.take_args=function(code_array,constant_pool){var i,match,offset,padding_size,_i,_ref2;padding_size=(4-code_array.pos()%4)%4,code_array.skip(padding_size),this._default=code_array.get_int(4),this.npairs=code_array.get_int(4),this.offsets={};for(i=_i=0,_ref2=this.npairs;_i<_ref2;i=_i+=1)match=code_array.get_int(4),offset=code_array.get_int(4),this.offsets[match]=offset;return this.byte_count=padding_size+8*(this.npairs+1)},LookupSwitchOpcode}(root.SwitchOpcode),root.TableSwitchOpcode=function(_super){function TableSwitchOpcode(){return TableSwitchOpcode.__super__.constructor.apply(this,arguments)}return __extends(TableSwitchOpcode,_super),TableSwitchOpcode.prototype.take_args=function(code_array,constant_pool){var i,offset,padding_size,total_offsets,_i;padding_size=(4-code_array.pos()%4)%4,code_array.skip(padding_size),this._default=code_array.get_int(4),this.low=code_array.get_int(4),this.high=code_array.get_int(4),this.offsets={},total_offsets=this.high-this.low+1;for(i=_i=0;_i<total_offsets;i=_i+=1)offset=code_array.get_int(4),this.offsets[this.low+i]=offset;return this.byte_count=padding_size+12+4*total_offsets},TableSwitchOpcode}(root.SwitchOpcode),root.NewArrayOpcode=function(_super){function NewArrayOpcode(name,params){NewArrayOpcode.__super__.constructor.call(this,name,params),this.byte_count=1,this.arr_types={4:"Z",5:"C",6:"F",7:"D",8:"B",9:"S",10:"I",11:"J"}}return __extends(NewArrayOpcode,_super),NewArrayOpcode.prototype.take_args=function(code_array,constant_pool){var type_code;return type_code=code_array.get_uint(1),this.element_type=this.arr_types[type_code]},NewArrayOpcode.prototype.annotate=function(idx,pool){return"	"+types.internal2external[this.element_type]},NewArrayOpcode}(root.Opcode),root.MultiArrayOpcode=function(_super){function MultiArrayOpcode(name,params){var _ref2;params==null&&(params={}),(_ref2=params.byte_count)==null&&(params.byte_count=3),MultiArrayOpcode.__super__.constructor.call(this,name,params)}return __extends(MultiArrayOpcode,_super),MultiArrayOpcode.prototype.take_args=function(code_array,constant_pool){return this.class_ref=code_array.get_uint(2),this["class"]=constant_pool.get(this.class_ref).deref(),this.dim=code_array.get_uint(1)},MultiArrayOpcode.prototype.annotate=function(idx,pool){return"	#"+this.class_ref+",  "+this.dim+";"},MultiArrayOpcode.prototype.execute=function(rs){var arr_types,counts,d,default_val,init_arr,_this=this;counts=rs.curr_frame().stack.splice(-this.dim,this.dim),default_val=util.initial_value(this["class"].slice(this.dim)),arr_types=function(){var _i,_ref2,_results;_results=[];for(d=_i=0,_ref2=this.dim;_i<_ref2;d=_i+=1)_results.push(c2t(this["class"].slice(d)));return _results}.call(this),init_arr=function(curr_dim){var array,i,len,type;return len=counts[curr_dim],len<0&&java_throw(rs,"java/lang/NegativeArraySizeException","Tried to init dimension "+curr_dim+" of a "+_this.dim+" dimensional "+(_this["class"]+"")+" array with length "+len),type=arr_types[curr_dim],curr_dim+1===_this.dim?array=function(){var _i,_results;_results=[];for(i=_i=0;_i<len;i=_i+=1)_results.push(default_val);return _results}():array=function(){var _i,_results;_results=[];for(i=_i=0;_i<len;i=_i+=1)_results.push(init_arr(curr_dim+1));return _results}(),new JavaArray(rs,type,array)},rs.push(init_arr(0))},MultiArrayOpcode}(root.Opcode),root.ArrayLoadOpcode=function(_super){function ArrayLoadOpcode(){return ArrayLoadOpcode.__super__.constructor.apply(this,arguments)}return __extends(ArrayLoadOpcode,_super),ArrayLoadOpcode.prototype.execute=function(rs){var array,idx,obj,_ref2;idx=rs.pop(),obj=rs.check_null(rs.pop()),array=obj.array,(0>idx||idx>=array.length)&&java_throw(rs,"java/lang/ArrayIndexOutOfBoundsException",""+idx+" not in length "+array.length+" array of type "+obj.type.toClassString()),rs.push(array[idx]),((_ref2=this.name[0])==="l"||_ref2==="d")&&rs.push(null)},ArrayLoadOpcode}(root.Opcode),root.ArrayStoreOpcode=function(_super){function ArrayStoreOpcode(){return ArrayStoreOpcode.__super__.constructor.apply(this,arguments)}return __extends(ArrayStoreOpcode,_super),ArrayStoreOpcode.prototype.execute=function(rs){var array,idx,obj,value,_ref2;value=(_ref2=this.name[0])==="l"||_ref2==="d"?rs.pop2():rs.pop(),idx=rs.pop(),obj=rs.check_null(rs.pop()),array=obj.array,(0>idx||idx>=array.length)&&java_throw(rs,"java/lang/ArrayIndexOutOfBoundsException",""+idx+" not in length "+array.length+" array of type "+obj.type.toClassString()),array[idx]=value},ArrayStoreOpcode}(root.Opcode),jsr=function(rs){return rs.push(rs.curr_pc()+this.byte_count+1),rs.inc_pc(this.offset),!1},root.opcodes={0:new root.Opcode("nop",{execute:function(){}}),1:new root.Opcode("aconst_null",{execute:function(rs){return rs.push(null)}}),2:new root.Opcode("iconst_m1",{execute:function(rs){return rs.push(-1)}}),3:new root.Opcode("iconst_0",{execute:function(rs){return rs.push(0)}}),4:new root.Opcode("iconst_1",{execute:function(rs){return rs.push(1)}}),5:new root.Opcode("iconst_2",{execute:function(rs){return rs.push(2)}}),6:new root.Opcode("iconst_3",{execute:function(rs){return rs.push(3)}}),7:new root.Opcode("iconst_4",{execute:function(rs){return rs.push(4)}}),8:new root.Opcode("iconst_5",{execute:function(rs){return rs.push(5)}}),9:new root.Opcode("lconst_0",{execute:function(rs){return rs.push2(gLong.ZERO,null)}}),10:new root.Opcode("lconst_1",{execute:function(rs){return rs.push2(gLong.ONE,null)}}),11:new root.Opcode("fconst_0",{execute:function(rs){return rs.push(0)}}),12:new root.Opcode("fconst_1",{execute:function(rs){return rs.push(1)}}),13:new root.Opcode("fconst_2",{execute:function(rs){return rs.push(2)}}),14:new root.Opcode("dconst_0",{execute:function(rs){return rs.push2(0,null)}}),15:new root.Opcode("dconst_1",{execute:function(rs){return rs.push2(1,null)}}),16:new root.PushOpcode("bipush",{byte_count:1}),17:new root.PushOpcode("sipush",{byte_count:2}),18:new root.LoadConstantOpcode("ldc",{byte_count:1}),19:new root.LoadConstantOpcode("ldc_w",{byte_count:2}),20:new root.LoadConstantOpcode("ldc2_w",{byte_count:2,execute:function(rs){return rs.push2(this.constant.value,null)}}),21:new root.LoadVarOpcode("iload"),22:new root.LoadVarOpcode("lload"),23:new root.LoadVarOpcode("fload"),24:new root.LoadVarOpcode("dload"),25:new root.LoadVarOpcode("aload"),26:new root.LoadOpcode("iload_0"),27:new root.LoadOpcode("iload_1"),28:new root.LoadOpcode("iload_2"),29:new root.LoadOpcode("iload_3"),30:new root.LoadOpcode("lload_0"),31:new root.LoadOpcode("lload_1"),32:new root.LoadOpcode("lload_2"),33:new root.LoadOpcode("lload_3"),34:new root.LoadOpcode("fload_0"),35:new root.LoadOpcode("fload_1"),36:new root.LoadOpcode("fload_2"),37:new root.LoadOpcode("fload_3"),38:new root.LoadOpcode("dload_0"),39:new root.LoadOpcode("dload_1"),40:new root.LoadOpcode("dload_2"),41:new root.LoadOpcode("dload_3"),42:new root.LoadOpcode("aload_0"),43:new root.LoadOpcode("aload_1"),44:new root.LoadOpcode("aload_2"),45:new root.LoadOpcode("aload_3"),46:new root.ArrayLoadOpcode("iaload"),47:new root.ArrayLoadOpcode("laload"),48:new root.ArrayLoadOpcode("faload"),49:new root.ArrayLoadOpcode("daload"),50:new root.ArrayLoadOpcode("aaload"),51:new root.ArrayLoadOpcode("baload"),52:new root.ArrayLoadOpcode("caload"),53:new root.ArrayLoadOpcode("saload"),54:new root.StoreVarOpcode("istore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),55:new root.StoreVarOpcode("lstore",{execute:function(rs){return rs.put_cl2(this.var_num,rs.pop2())}}),56:new root.StoreVarOpcode("fstore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),57:new root.StoreVarOpcode("dstore",{execute:function(rs){return rs.put_cl2(this.var_num,rs.pop2())}}),58:new root.StoreVarOpcode("astore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),59:new root.StoreOpcode("istore_0"),60:new root.StoreOpcode("istore_1"),61:new root.StoreOpcode("istore_2"),62:new root.StoreOpcode("istore_3"),63:new root.StoreOpcode("lstore_0"),64:new root.StoreOpcode("lstore_1"),65:new root.StoreOpcode("lstore_2"),66:new root.StoreOpcode("lstore_3"),67:new root.StoreOpcode("fstore_0"),68:new root.StoreOpcode("fstore_1"),69:new root.StoreOpcode("fstore_2"),70:new root.StoreOpcode("fstore_3"),71:new root.StoreOpcode("dstore_0"),72:new root.StoreOpcode("dstore_1"),73:new root.StoreOpcode("dstore_2"),74:new root.StoreOpcode("dstore_3"),75:new root.StoreOpcode("astore_0"),76:new root.StoreOpcode("astore_1"),77:new root.StoreOpcode("astore_2"),78:new root.StoreOpcode("astore_3"),79:new root.ArrayStoreOpcode("iastore"),80:new root.ArrayStoreOpcode("lastore"),81:new root.ArrayStoreOpcode("fastore"),82:new root.ArrayStoreOpcode("dastore"),83:new root.ArrayStoreOpcode("aastore"),84:new root.ArrayStoreOpcode("bastore"),85:new root.ArrayStoreOpcode("castore"),86:new root.ArrayStoreOpcode("sastore"),87:new root.Opcode("pop",{execute:function(rs){return rs.pop()}}),88:new root.Opcode("pop2",{execute:function(rs){return rs.pop2()}}),89:new root.Opcode("dup",{execute:function(rs){var v;return v=rs.pop(),rs.push2(v,v)}}),90:new root.Opcode("dup_x1",{execute:function(rs){var v1,v2;return v1=rs.pop(),v2=rs.pop(),rs.push_array([v1,v2,v1])}}),91:new root.Opcode("dup_x2",{execute:function(rs){var v1,v2,v3,_ref2;return _ref2=[rs.pop(),rs.pop(),rs.pop()],v1=_ref2[0],v2=_ref2[1],v3=_ref2[2],rs.push_array([v1,v3,v2,v1])}}),92:new root.Opcode("dup2",{execute:function(rs){var v1,v2;return v1=rs.pop(),v2=rs.pop(),rs.push_array([v2,v1,v2,v1])}}),93:new root.Opcode("dup2_x1",{execute:function(rs){var v1,v2,v3,_ref2;return _ref2=[rs.pop(),rs.pop(),rs.pop()],v1=_ref2[0],v2=_ref2[1],v3=_ref2[2],rs.push_array([v2,v1,v3,v2,v1])}}),94:new root.Opcode("dup2_x2",{execute:function(rs){var v1,v2,v3,v4,_ref2;return _ref2=[rs.pop(),rs.pop(),rs.pop(),rs.pop()],v1=_ref2[0],v2=_ref2[1],v3=_ref2[2],v4=_ref2[3],rs.push_array([v2,v1,v4,v3,v2,v1])}}),95:new root.Opcode("swap",{execute:function(rs){var v1,v2;return v2=rs.pop(),v1=rs.pop(),rs.push2(v2,v1)}}),96:new root.Opcode("iadd",{execute:function(rs){return rs.push(rs.pop()+rs.pop()|0)}}),97:new root.Opcode("ladd",{execute:function(rs){return rs.push2(rs.pop2().add(rs.pop2()),null)}}),98:new root.Opcode("fadd",{execute:function(rs){return rs.push(util.wrap_float(rs.pop()+rs.pop()))}}),99:new root.Opcode("dadd",{execute:function(rs){return rs.push2(rs.pop2()+rs.pop2(),null)}}),100:new root.Opcode("isub",{execute:function(rs){return rs.push(-rs.pop()+rs.pop()|0)}}),101:new root.Opcode("lsub",{execute:function(rs){return rs.push2(rs.pop2().negate().add(rs.pop2()),null)}}),102:new root.Opcode("fsub",{execute:function(rs){return rs.push(util.wrap_float(-rs.pop()+rs.pop()))}}),103:new root.Opcode("dsub",{execute:function(rs){return rs.push2(-rs.pop2()+rs.pop2(),null)}}),104:new root.Opcode("imul",{execute:function(rs){return rs.push(gLong.fromInt(rs.pop()).multiply(gLong.fromInt(rs.pop())).toInt())}}),105:new root.Opcode("lmul",{execute:function(rs){return rs.push2(rs.pop2().multiply(rs.pop2()),null)}}),106:new root.Opcode("fmul",{execute:function(rs){return rs.push(util.wrap_float(rs.pop()*rs.pop()))}}),107:new root.Opcode("dmul",{execute:function(rs){return rs.push2(rs.pop2()*rs.pop2(),null)}}),108:new root.Opcode("idiv",{execute:function(rs){var v;return v=rs.pop(),rs.push(util.int_div(rs,rs.pop(),v))}}),109:new root.Opcode("ldiv",{execute:function(rs){var v;return v=rs.pop2(),rs.push2(util.long_div(rs,rs.pop2(),v),null)}}),110:new root.Opcode("fdiv",{execute:function(rs){var a;return a=rs.pop(),rs.push(util.wrap_float(rs.pop()/a))}}),111:new root.Opcode("ddiv",{execute:function(rs){var v;return v=rs.pop2(),rs.push2(rs.pop2()/v,null)}}),112:new root.Opcode("irem",{execute:function(rs){var v2;return v2=rs.pop(),rs.push(util.int_mod(rs,rs.pop(),v2))}}),113:new root.Opcode("lrem",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push2(util.long_mod(rs,rs.pop2(),v2),null)}}),114:new root.Opcode("frem",{execute:function(rs){var b;return b=rs.pop(),rs.push(rs.pop()%b)}}),115:new root.Opcode("drem",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push2(rs.pop2()%v2,null)}}),116:new root.Opcode("ineg",{execute:function(rs){return rs.push(-rs.pop()|0)}}),117:new root.Opcode("lneg",{execute:function(rs){return rs.push2(rs.pop2().negate(),null)}}),118:new root.Opcode("fneg",{execute:function(rs){return rs.push(-rs.pop())}}),119:new root.Opcode("dneg",{execute:function(rs){return rs.push2(-rs.pop2(),null)}}),120:new root.Opcode("ishl",{execute:function(rs){var s;return s=rs.pop(),rs.push(rs.pop()<<s)}}),121:new root.Opcode("lshl",{execute:function(rs){var s;return s=rs.pop(),rs.push2(rs.pop2().shiftLeft(gLong.fromInt(s)),null)}}),122:new root.Opcode("ishr",{execute:function(rs){var s;return s=rs.pop(),rs.push(rs.pop()>>s)}}),123:new root.Opcode("lshr",{execute:function(rs){var s;return s=rs.pop(),rs.push2(rs.pop2().shiftRight(gLong.fromInt(s)),null)}}),124:new root.Opcode("iushr",{execute:function(rs){var s;return s=rs.pop(),rs.push(rs.pop()>>>s)}}),125:new root.Opcode("lushr",{execute:function(rs){var s;return s=rs.pop(),rs.push2(rs.pop2().shiftRightUnsigned(gLong.fromInt(s)),null)}}),126:new root.Opcode("iand",{execute:function(rs){return rs.push(rs.pop()&rs.pop())}}),127:new root.Opcode("land",{execute:function(rs){return rs.push2(rs.pop2().and(rs.pop2()),null)}}),128:new root.Opcode("ior",{execute:function(rs){return rs.push(rs.pop()|rs.pop())}}),129:new root.Opcode("lor",{execute:function(rs){return rs.push2(rs.pop2().or(rs.pop2()),null)}}),130:new root.Opcode("ixor",{execute:function(rs){return rs.push(rs.pop()^rs.pop())}}),131:new root.Opcode("lxor",{execute:function(rs){return rs.push2(rs.pop2().xor(rs.pop2()),null)}}),132:new root.IIncOpcode("iinc"),133:new root.Opcode("i2l",{execute:function(rs){return rs.push2(gLong.fromInt(rs.pop()),null)}}),134:new root.Opcode("i2f",{execute:function(rs){}}),135:new root.Opcode("i2d",{execute:function(rs){return rs.push(null)}}),136:new root.Opcode("l2i",{execute:function(rs){return rs.push(rs.pop2().toInt())}}),137:new root.Opcode("l2f",{execute:function(rs){return rs.push(rs.pop2().toNumber())}}),138:new root.Opcode("l2d",{execute:function(rs){return rs.push2(rs.pop2().toNumber(),null)}}),139:new root.Opcode("f2i",{execute:function(rs){return rs.push(util.float2int(rs.pop()))}}),140:new root.Opcode("f2l",{execute:function(rs){return rs.push2(gLong.fromNumber(rs.pop()),null)}}),141:new root.Opcode("f2d",{execute:function(rs){return rs.push(null)}}),142:new root.Opcode("d2i",{execute:function(rs){return rs.push(util.float2int(rs.pop2()))}}),143:new root.Opcode("d2l",{execute:function(rs){var d_val;return d_val=rs.pop2(),d_val===Number.POSITIVE_INFINITY?rs.push2(gLong.MAX_VALUE,null):d_val===Number.NEGATIVE_INFINITY?rs.push2(gLong.MIN_VALUE,null):rs.push2(gLong.fromNumber(d_val),null)}}),144:new root.Opcode("d2f",{execute:function(rs){return rs.push(util.wrap_float(rs.pop2()))}}),145:new root.Opcode("i2b",{execute:function(rs){return rs.push(rs.pop()<<24>>24)}}),146:new root.Opcode("i2c",{execute:function(rs){return rs.push(rs.pop()&65535)}}),147:new root.Opcode("i2s",{execute:function(rs){return rs.push(rs.pop()<<16>>16)}}),148:new root.Opcode("lcmp",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push(rs.pop2().compare(v2))}}),149:new root.Opcode("fcmpl",{execute:function(rs){var v2,_ref2;return v2=rs.pop(),rs.push((_ref2=util.cmp(rs.pop(),v2))!=null?_ref2:-1)}}),150:new root.Opcode("fcmpg",{execute:function(rs){var v2,_ref2;return v2=rs.pop(),rs.push((_ref2=util.cmp(rs.pop(),v2))!=null?_ref2:1)}}),151:new root.Opcode("dcmpl",{execute:function(rs){var v2,_ref2;return v2=rs.pop2(),rs.push((_ref2=util.cmp(rs.pop2(),v2))!=null?_ref2:-1)}}),152:new root.Opcode("dcmpg",{execute:function(rs){var v2,_ref2;return v2=rs.pop2(),rs.push((_ref2=util.cmp(rs.pop2(),v2))!=null?_ref2:1)}}),153:new root.UnaryBranchOpcode("ifeq",{cmp:function(v){return v===0}}),154:new root.UnaryBranchOpcode("ifne",{cmp:function(v){return v!==0}}),155:new root.UnaryBranchOpcode("iflt",{cmp:function(v){return v<0}}),156:new root.UnaryBranchOpcode("ifge",{cmp:function(v){return v>=0}}),157:new root.UnaryBranchOpcode("ifgt",{cmp:function(v){return v>0}}),158:new root.UnaryBranchOpcode("ifle",{cmp:function(v){return v<=0}}),159:new root.BinaryBranchOpcode("if_icmpeq",{cmp:function(v1,v2){return v1===v2}}),160:new root.BinaryBranchOpcode("if_icmpne",{cmp:function(v1,v2){return v1!==v2}}),161:new root.BinaryBranchOpcode("if_icmplt",{cmp:function(v1,v2){return v1<v2}}),162:new root.BinaryBranchOpcode("if_icmpge",{cmp:function(v1,v2){return v1>=v2}}),163:new root.BinaryBranchOpcode("if_icmpgt",{cmp:function(v1,v2){return v1>v2}}),164:new root.BinaryBranchOpcode("if_icmple",{cmp:function(v1,v2){return v1<=v2}}),165:new root.BinaryBranchOpcode("if_acmpeq",{cmp:function(v1,v2){return v1===v2}}),166:new root.BinaryBranchOpcode("if_acmpne",{cmp:function(v1,v2){return v1!==v2}}),167:new root.BranchOpcode("goto",{execute:function(rs){return rs.inc_pc(this.offset),!1}}),168:new root.BranchOpcode("jsr",{execute:jsr}),169:new root.Opcode("ret",{byte_count:1,execute:function(rs){return rs.goto_pc(rs.cl(this.args[0])),!1}}),170:new root.TableSwitchOpcode("tableswitch"),171:new root.LookupSwitchOpcode("lookupswitch"),172:new root.Opcode("ireturn",{execute:function(rs){var cf;throw cf=rs.meta_stack().pop(),rs.push(cf.stack[0]),ReturnException}}),173:new root.Opcode("lreturn",{execute:function(rs){var cf;throw cf=rs.meta_stack().pop(),rs.push2(cf.stack[0],null),ReturnException}}),174:new root.Opcode("freturn",{execute:function(rs){var cf;throw cf=rs.meta_stack().pop(),rs.push(cf.stack[0]),ReturnException}}),175:new root.Opcode("dreturn",{execute:function(rs){var cf;throw cf=rs.meta_stack().pop(),rs.push2(cf.stack[0],null),ReturnException}}),176:new root.Opcode("areturn",{execute:function(rs){var cf;throw cf=rs.meta_stack().pop(),rs.push(cf.stack[0]),ReturnException}}),177:new root.Opcode("return",{execute:function(rs){throw rs.meta_stack().pop(),ReturnException}}),178:new root.FieldOpcode("getstatic",{execute:function(rs){var _ref2;rs.push(rs.static_get(this.field_spec));if((_ref2=this.field_spec.type)==="J"||_ref2==="D")return rs.push(null)}}),179:new root.FieldOpcode("putstatic",{execute:function(rs){return rs.static_put(this.field_spec)}}),180:new root.FieldOpcode("getfield",{execute:function(rs){var field,name,new_execute,_ref2;field=rs.field_lookup(this.field_spec),name=field.class_type.toClassString()+"/"+this.field_spec.name,new_execute=(_ref2=this.field_spec.type)!=="J"&&_ref2!=="D"?function(rs){var val;return val=rs.pop().get_field(rs,name),rs.push(val)}:function(rs){var val;return val=rs.pop().get_field(rs,name),rs.push2(val,null)},new_execute.call(this,rs),this.execute=new_execute}}),181:new root.FieldOpcode("putfield",{execute:function(rs){var cls,field,name,new_execute,_ref2;field=rs.field_lookup(this.field_spec),name=field.class_type.toClassString()+"/"+this.field_spec.name,cls=field.class_type.toClassString(),new_execute=(_ref2=this.field_spec.type)!=="J"&&_ref2!=="D"?function(rs){var val;return val=rs.pop(),rs.pop().set_field(this,name,val)}:function(rs){var val;return val=rs.pop2(),rs.pop().set_field(this,name,val)},new_execute.call(this,rs),this.execute=new_execute}}),182:new root.DynInvokeOpcode("invokevirtual"),183:new root.InvokeOpcode("invokespecial"),184:new root.InvokeOpcode("invokestatic"),185:new root.DynInvokeOpcode("invokeinterface"),187:new root.ClassOpcode("new",{execute:function(rs){return this.type=c2t(this["class"]),this.cls=rs.class_lookup(this.type),rs.push(new JavaObject(rs,this.type,this.cls)),this.execute=function(rs){return rs.push(new JavaObject(rs,this.type,this.cls))}}}),188:new root.NewArrayOpcode("newarray",{execute:function(rs){return rs.push(rs.heap_newarray(this.element_type,rs.pop()))}}),189:new root.ClassOpcode("anewarray",{execute:function(rs){return rs.push(rs.heap_newarray("L"+this["class"]+";",rs.pop()))}}),190:new root.Opcode("arraylength",{execute:function(rs){return rs.push(rs.check_null(rs.pop()).array.length)}}),191:new root.Opcode("athrow",{execute:function(rs){throw new JavaException(rs.pop())}}),192:new root.ClassOpcode("checkcast",{execute:function(rs){var candidate_class,o,target_class;return o=rs.pop(),o==null||types.check_cast(rs,o,this["class"])?rs.push(o):(target_class=c2t(this["class"]).toExternalString(),candidate_class=o.type.toExternalString(),java_throw(rs,"java/lang/ClassCastException",""+candidate_class+" cannot be cast to "+target_class))}}),193:new root.ClassOpcode("instanceof",{execute:function(rs){var o;return o=rs.pop(),rs.push(o!=null?types.check_cast(rs,o,this["class"])+0:0)}}),194:new root.Opcode("monitorenter",{execute:function(rs){var locked_thread,monitor;return monitor=rs.pop(),(locked_thread=rs.lock_refs[monitor])!=null?locked_thread===rs.curr_thread?rs.lock_counts[monitor]++:(rs.inc_pc(1),rs.meta_stack().push({}),rs.wait(monitor)):(rs.lock_refs[monitor]=rs.curr_thread,rs.lock_counts[monitor]=1)}}),195:new root.Opcode("monitorexit",{execute:function(rs){var locked_thread,monitor;monitor=rs.pop();if((locked_thread=rs.lock_refs[monitor])==null)return;if(locked_thread!==rs.curr_thread)return java_throw(rs,"java/lang/IllegalMonitorStateException","Tried to monitorexit on lock not held by current thread");rs.lock_counts[monitor]--;if(rs.lock_counts[monitor]===0)return delete rs.lock_refs[monitor]}}),197:new root.MultiArrayOpcode("multianewarray"),198:new root.UnaryBranchOpcode("ifnull",{cmp:function(v){return v==null}}),199:new root.UnaryBranchOpcode("ifnonnull",{cmp:function(v){return v!=null}}),200:new root.BranchOpcode("goto_w",{byte_count:4,execute:function(rs){return rs.inc_pc(this.offset),!1}}),201:new root.BranchOpcode("jsr_w",{byte_count:4,execute:jsr})}}.call(this),function(){var AnnotationDefault,Code,ConstantValue,Deprecated,EnclosingMethod,ExceptionHandler,Exceptions,InnerClasses,LineNumberTable,LocalVariableTable,RuntimeVisibleAnnotations,Signature,SourceFile,StackMapTable,Synthetic,opcodes,root,util,_ref;util=require("./util"),opcodes=require("./opcodes"),"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref=window.attributes)!=null?_ref:window.attributes={},ExceptionHandler=function(){function ExceptionHandler(){}return ExceptionHandler.prototype.name="ExceptionHandler",ExceptionHandler.prototype.parse=function(bytes_array,constant_pool){var cti;return this.start_pc=bytes_array.get_uint(2),this.end_pc=bytes_array.get_uint(2),this.handler_pc=bytes_array.get_uint(2),cti=bytes_array.get_uint(2),this.catch_type=cti===0?"<any>":constant_pool.get(cti).deref()},ExceptionHandler}(),Code=function(){function Code(){}return Code.prototype.name="Code",Code.prototype.parse=function(bytes_array,constant_pool){var eh,except_len,_i,_len,_ref1;this.constant_pool=constant_pool,this.max_stack=bytes_array.get_uint(2),this.max_locals=bytes_array.get_uint(2),this.code_len=bytes_array.get_uint(4),this.code_len===0&&!0,this._code_array=bytes_array.splice(this.code_len),this.opcodes=null,except_len=bytes_array.get_uint(2),this.exception_handlers=function(){var _i,_results;_results=[];for(_i=0;0>except_len?_i>except_len:_i<except_len;0>except_len?_i--:_i++)_results.push(new ExceptionHandler);return _results}(),_ref1=this.exception_handlers;for(_i=0,_len=_ref1.length;_i<_len;_i++)eh=_ref1[_i],eh.parse(bytes_array,constant_pool);return this.attrs=root.make_attributes(bytes_array,constant_pool),this.run_stamp=0},Code.prototype.parse_code=function(){var c,op,op_index,wide;this.opcodes=Array(this.code_len);while(this._code_array.has_bytes())op_index=this._code_array.pos(),c=this._code_array.get_uint(1),wide=c===196,wide&&(c=this._code_array.get_uint(1)),opcodes.opcodes[c]==null&&!0,op=Object.create(opcodes.opcodes[c]),op.take_args(this._code_array,this.constant_pool,wide),this.opcodes[op_index]=op;this._code_array.rewind()},Code.prototype.each_opcode=function(fn){var i,_i,_ref1,_results;_results=[];for(i=_i=0,_ref1=this.code_len;0>_ref1?_i>=_ref1:_i<=_ref1;i=0>_ref1?--_i:++_i)i in this.opcodes&&_results.push(fn(i,this.opcodes[i]));return _results},Code}(),LineNumberTable=function(){function LineNumberTable(){}return LineNumberTable.prototype.name="LineNumberTable",LineNumberTable.prototype.parse=function(bytes_array,constant_pool){var i,ln,lnt_len,spc,_i,_results;this.entries=[],lnt_len=bytes_array.get_uint(2),_results=[];for(i=_i=0;_i<lnt_len;i=_i+=1)spc=bytes_array.get_uint(2),ln=bytes_array.get_uint(2),_results.push(this.entries.push({start_pc:spc,line_number:ln}));return _results},LineNumberTable.prototype.disassemblyOutput=function(){var entry,rv,_i,_len,_ref1;rv="  LineNumberTable:\n",_ref1=this.entries;for(_i=0,_len=_ref1.length;_i<_len;_i++)entry=_ref1[_i],rv+="   line "+entry.line_number+": "+entry.start_pc+"\n";return rv},LineNumberTable}(),SourceFile=function(){function SourceFile(){}return SourceFile.prototype.name="SourceFile",SourceFile.prototype.parse=function(bytes_array,constant_pool){return this.filename=constant_pool.get(bytes_array.get_uint(2)).value},SourceFile}(),StackMapTable=function(){function StackMapTable(){}var parse_entries,parse_verification_type_info;return StackMapTable.prototype.name="StackMapTable",StackMapTable.prototype.parse=function(bytes_array,constant_pool){var i;return this.num_entries=bytes_array.get_uint(2),this.entries=function(){var _i,_ref1,_results;_results=[];for(i=_i=0,_ref1=this.num_entries;_i<_ref1;i=_i+=1)_results.push(parse_entries(bytes_array,constant_pool));return _results}.call(this)},parse_entries=function(bytes_array,constant_pool){var frame_type,i,num_locals,num_stack_items;frame_type=bytes_array.get_uint(1);if(0<=frame_type&&frame_type<64)return{frame_type:frame_type,frame_name:"same"};if(64<=frame_type&&frame_type<128)return{frame_type:frame_type,frame_name:"same_locals_1_stack_item",stack:[parse_verification_type_info(bytes_array,constant_pool)]};if(128>frame_type||frame_type>=247){if(frame_type===247)return{frame_type:frame_type,frame_name:"same_locals_1_stack_item_extended",offset_delta:bytes_array.get_uint(2),stack:[parse_verification_type_info(bytes_array,constant_pool)]};if(248<=frame_type&&frame_type<251)return{frame_type:frame_type,frame_name:"chop",offset_delta:[bytes_array.get_uint(2)]};if(frame_type===251)return{frame_type:frame_type,frame_name:"same_frame_extended",offset_delta:[bytes_array.get_uint(2)]};if(252<=frame_type&&frame_type<255)return{frame_type:frame_type,frame_name:"append",offset_delta:bytes_array.get_uint(2),locals:function(){var _i,_ref1,_results;_results=[];for(i=_i=0,_ref1=frame_type-251;_i<_ref1;i=_i+=1)_results.push(parse_verification_type_info(bytes_array,constant_pool));return _results}()};if(frame_type===255)return{frame_type:frame_type,frame_name:"full_frame",offset_delta:bytes_array.get_uint(2),num_locals:num_locals=bytes_array.get_uint(2),locals:function(){var _i,_results;_results=[];for(i=_i=0;_i<num_locals;i=_i+=1)_results.push(parse_verification_type_info(bytes_array,constant_pool));return _results}(),num_stack_items:num_stack_items=bytes_array.get_uint(2),stack:function(){var _i,_results;_results=[];for(i=_i=0;_i<num_stack_items;i=_i+=1)_results.push(parse_verification_type_info(bytes_array,constant_pool));return _results}()}}},parse_verification_type_info=function(bytes_array,constant_pool){var cls,tag,tag_to_type;return tag=bytes_array.get_uint(1),tag===7?(cls=constant_pool.get(bytes_array.get_uint(2)).deref(),"class "+(/\w/.test(cls[0])?cls:'"'+cls+'"')):(tag_to_type=["bogus","int","float","double","long","null","this","object","uninitialized"],tag_to_type[tag])},StackMapTable.prototype.disassemblyOutput=function(){var entry,rv,_i,_len,_ref1;rv="  StackMapTable: number_of_entries = "+this.num_entries+"\n",_ref1=this.entries;for(_i=0,_len=_ref1.length;_i<_len;_i++)entry=_ref1[_i],rv+="   frame_type = "+entry.frame_type+" /* "+entry.frame_name+" */\n",entry.offset_delta!=null&&(rv+="     offset_delta = "+entry
.offset_delta+"\n"),entry.locals!=null&&(rv+="     locals = [ "+entry.locals.join(", ")+" ]\n"),entry.stack!=null&&(rv+="     stack = [ "+entry.stack.join(", ")+" ]\n");return rv},StackMapTable}(),LocalVariableTable=function(){function LocalVariableTable(){}return LocalVariableTable.prototype.name="LocalVariableTable",LocalVariableTable.prototype.parse=function(bytes_array,constant_pool){var i;return this.num_entries=bytes_array.get_uint(2),this.entries=function(){var _i,_ref1,_results;_results=[];for(i=_i=0,_ref1=this.num_entries;_i<_ref1;i=_i+=1)_results.push(this.parse_entries(bytes_array,constant_pool));return _results}.call(this)},LocalVariableTable.prototype.parse_entries=function(bytes_array,constant_pool){return{start_pc:bytes_array.get_uint(2),length:bytes_array.get_uint(2),name:constant_pool.get(bytes_array.get_uint(2)).value,descriptor:constant_pool.get(bytes_array.get_uint(2)).value,ref:bytes_array.get_uint(2)}},LocalVariableTable.prototype.disassemblyOutput=function(){var entry,rv,_i,_len,_ref1;rv="  LocalVariableTable:\n   Start  Length  Slot  Name   Signature\n",_ref1=this.entries;for(_i=0,_len=_ref1.length;_i<_len;_i++)entry=_ref1[_i],rv+="   "+entry.start_pc+"      "+entry.length+"      "+entry.ref,rv+=""+entry.name+"      "+entry.descriptor+"\n";return rv},LocalVariableTable}(),Exceptions=function(){function Exceptions(){}return Exceptions.prototype.name="Exceptions",Exceptions.prototype.parse=function(bytes_array,constant_pool){var exc_refs,i,ref;return this.num_exceptions=bytes_array.get_uint(2),exc_refs=function(){var _i,_ref1,_results;_results=[];for(i=_i=0,_ref1=this.num_exceptions;_i<_ref1;i=_i+=1)_results.push(bytes_array.get_uint(2));return _results}.call(this),this.exceptions=function(){var _i,_len,_results;_results=[];for(_i=0,_len=exc_refs.length;_i<_len;_i++)ref=exc_refs[_i],_results.push(constant_pool.get(ref).deref());return _results}()},Exceptions}(),InnerClasses=function(){function InnerClasses(){}return InnerClasses.prototype.name="InnerClasses",InnerClasses.prototype.parse=function(bytes_array,constant_pool){var i,num_classes;return num_classes=bytes_array.get_uint(2),this.classes=function(){var _i,_results;_results=[];for(i=_i=0;_i<num_classes;i=_i+=1)_results.push(this.parse_class(bytes_array,constant_pool));return _results}.call(this)},InnerClasses.prototype.parse_class=function(bytes_array,constant_pool){return{inner_info_index:bytes_array.get_uint(2),outer_info_index:bytes_array.get_uint(2),inner_name_index:bytes_array.get_uint(2),inner_access_flags:bytes_array.get_uint(2)}},InnerClasses}(),ConstantValue=function(){function ConstantValue(){}return ConstantValue.prototype.name="ConstantValue",ConstantValue.prototype.parse=function(bytes_array,constant_pool){return this.ref=bytes_array.get_uint(2),this.value=constant_pool.get(this.ref).value},ConstantValue}(),Synthetic=function(){function Synthetic(){}return Synthetic.prototype.name="Synthetic",Synthetic.prototype.parse=function(){},Synthetic}(),Deprecated=function(){function Deprecated(){}return Deprecated.prototype.name="Deprecated",Deprecated.prototype.parse=function(){},Deprecated}(),Signature=function(){function Signature(){}return Signature.prototype.name="Signature",Signature.prototype.parse=function(bytes_array,constant_pool){var ref;return ref=bytes_array.get_uint(2),this.sig=constant_pool.get(ref).value},Signature}(),RuntimeVisibleAnnotations=function(){function RuntimeVisibleAnnotations(){}return RuntimeVisibleAnnotations.prototype.name="RuntimeVisibleAnnotations",RuntimeVisibleAnnotations.prototype.parse=function(bytes_array,constant_pool,attr_len){return this.raw_bytes=bytes_array.read(attr_len)},RuntimeVisibleAnnotations}(),AnnotationDefault=function(){function AnnotationDefault(){}return AnnotationDefault.prototype.name="AnnotationDefault",AnnotationDefault.prototype.parse=function(bytes_array,constant_pool,attr_len){return this.raw_bytes=bytes_array.read(attr_len)},AnnotationDefault}(),EnclosingMethod=function(){function EnclosingMethod(){}return EnclosingMethod.prototype.name="EnclosingMethod",EnclosingMethod.prototype.parse=function(bytes_array,constant_pool){var method_ref;this.enc_class=constant_pool.get(bytes_array.get_uint(2)).deref(),method_ref=bytes_array.get_uint(2);if(method_ref>0)return this.enc_method=constant_pool.get(method_ref).deref()},EnclosingMethod}(),root.make_attributes=function(bytes_array,constant_pool){var attr,attr_len,attr_types,attrs,i,name,new_len,num_attrs,old_len,_i;attr_types={Code:Code,LineNumberTable:LineNumberTable,SourceFile:SourceFile,StackMapTable:StackMapTable,LocalVariableTable:LocalVariableTable,ConstantValue:ConstantValue,Exceptions:Exceptions,InnerClasses:InnerClasses,Synthetic:Synthetic,Deprecated:Deprecated,Signature:Signature,RuntimeVisibleAnnotations:RuntimeVisibleAnnotations,AnnotationDefault:AnnotationDefault,EnclosingMethod:EnclosingMethod},num_attrs=bytes_array.get_uint(2),attrs=[];for(i=_i=0;_i<num_attrs;i=_i+=1)name=constant_pool.get(bytes_array.get_uint(2)).value,attr_len=bytes_array.get_uint(4),attr_types[name]!=null?(attr=new attr_types[name],old_len=bytes_array.size(),attr.parse(bytes_array,constant_pool,attr_len),new_len=bytes_array.size(),old_len-new_len!==attr_len&&bytes_array.skip(attr_len-old_len+new_len),attrs.push(attr)):bytes_array.skip(attr_len);return attrs}}.call(this),function(){var AbstractMethodFieldReference,ClassReference,ConstDouble,ConstFloat,ConstInt32,ConstLong,ConstString,ConstantPool,FieldReference,InterfaceMethodReference,MethodReference,MethodSignature,SimpleReference,StringReference,gLong,util,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};gLong=require("../vendor/gLong.js"),util=require("./util"),"use strict",SimpleReference=function(){function SimpleReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value}return SimpleReference.size=1,SimpleReference.from_bytes=function(bytes_array,constant_pool){var ref,value;return value=bytes_array.get_uint(2),ref=new this(constant_pool,value),ref},SimpleReference.prototype.deref=function(){var pool_obj;return pool_obj=this.constant_pool[this.value],(typeof pool_obj.deref=="function"?pool_obj.deref():void 0)||pool_obj.value},SimpleReference}(),ClassReference=function(_super){function ClassReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="class"}return __extends(ClassReference,_super),ClassReference}(SimpleReference),StringReference=function(_super){function StringReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="String"}return __extends(StringReference,_super),StringReference}(SimpleReference),AbstractMethodFieldReference=function(){function AbstractMethodFieldReference(){}return AbstractMethodFieldReference.size=1,AbstractMethodFieldReference.from_bytes=function(bytes_array,constant_pool){var class_ref,ref,sig;return class_ref=ClassReference.from_bytes(bytes_array,constant_pool),sig=SimpleReference.from_bytes(bytes_array,constant_pool),ref=new this(constant_pool,{class_ref:class_ref,sig:sig}),ref},AbstractMethodFieldReference.prototype.deref=function(){var sig;return sig=this.value.sig.deref(),{"class":this.value.class_ref.deref(),sig:sig.name+sig.type}},AbstractMethodFieldReference}(),MethodReference=function(_super){function MethodReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="Method"}return __extends(MethodReference,_super),MethodReference}(AbstractMethodFieldReference),InterfaceMethodReference=function(_super){function InterfaceMethodReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="InterfaceMethod"}return __extends(InterfaceMethodReference,_super),InterfaceMethodReference}(AbstractMethodFieldReference),FieldReference=function(_super){function FieldReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="Field"}return __extends(FieldReference,_super),FieldReference.prototype.deref=function(){var sig;return sig=this.value.sig.deref(),{"class":this.value.class_ref.deref(),name:sig.name,type:sig.type}},FieldReference}(AbstractMethodFieldReference),MethodSignature=function(){function MethodSignature(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="NameAndType"}return MethodSignature.size=1,MethodSignature.from_bytes=function(bytes_array,constant_pool){var meth_ref,ref,type_ref;return meth_ref=StringReference.from_bytes(bytes_array,constant_pool),type_ref=StringReference.from_bytes(bytes_array,constant_pool),ref=new this(constant_pool,{meth_ref:meth_ref,type_ref:type_ref}),ref},MethodSignature.prototype.deref=function(){return{name:this.value.meth_ref.deref(),type:this.value.type_ref.deref()}},MethodSignature}(),ConstString=function(){function ConstString(value){this.value=value,this.type="Asciz"}return ConstString.size=1,ConstString.from_bytes=function(bytes_array){var const_string,strlen,value;return strlen=bytes_array.get_uint(2),value=util.bytes2str(bytes_array.read(strlen)),const_string=new this(value),const_string},ConstString}(),ConstInt32=function(){function ConstInt32(value){this.value=value,this.type="int"}return ConstInt32.size=1,ConstInt32.from_bytes=function(bytes_array){var int32,uint32,value;return uint32=bytes_array.get_uint(4),value=-(1+~uint32),int32=new this(value),int32},ConstInt32}(),ConstFloat=function(){function ConstFloat(value){this.value=value,this.type="float"}return ConstFloat.size=1,ConstFloat.from_bytes=function(bytes_array){var float,uint32,value;return uint32=bytes_array.get_uint(4),value=util.intbits2float(uint32|0),float=new this(value),float},ConstFloat}(),ConstLong=function(){function ConstLong(value){this.value=value,this.type="long"}return ConstLong.size=2,ConstLong.from_bytes=function(bytes_array){var high,long,low,value;return high=bytes_array.get_uint(4),low=bytes_array.get_uint(4),value=gLong.fromBits(low,high),long=new this(value),long},ConstLong}(),ConstDouble=function(){function ConstDouble(value){this.value=value,this.type="double"}return ConstDouble.size=2,ConstDouble.from_bytes=function(bytes_array){var double,uint32_a,uint32_b;return uint32_a=bytes_array.get_uint(4),uint32_b=bytes_array.get_uint(4),double=new this(util.longbits2double(uint32_a,uint32_b)),double},ConstDouble}(),ConstantPool=function(){function ConstantPool(){}return ConstantPool.prototype.parse=function(bytes_array){var constant_tags,idx,pool_obj,tag;constant_tags={1:ConstString,3:ConstInt32,4:ConstFloat,5:ConstLong,6:ConstDouble,7:ClassReference,8:StringReference,9:FieldReference,10:MethodReference,11:InterfaceMethodReference,12:MethodSignature},this.cp_count=bytes_array.get_uint(2),this.constant_pool={},idx=1;while(idx<this.cp_count){tag=bytes_array.get_uint(1);if(1>tag||tag>12)throw"invalid tag: "+tag;pool_obj=constant_tags[tag].from_bytes(bytes_array,this.constant_pool),this.constant_pool[idx]=pool_obj,idx+=constant_tags[tag].size}return bytes_array},ConstantPool.prototype.get=function(idx){var _ref;return function(){if((_ref=this.constant_pool[idx])!=null)return _ref;throw Error("Invalid constant_pool reference: "+idx)}.call(this)},ConstantPool.prototype.each=function(fn){var i,_i,_ref,_results;_results=[];for(i=_i=0,_ref=this.cp_count;0>_ref?_i>=_ref:_i<=_ref;i=0>_ref?--_i:++_i)i in this.constant_pool&&_results.push(fn(i,this.constant_pool[i]));return _results},ConstantPool}(),typeof module!="undefined"&&module!==null?module.exports=ConstantPool:window.ConstantPool=ConstantPool}.call(this),function(){var pad_left,root,types,util,_;root=typeof exports!="undefined"&&exports!==null?exports:this.disassembler={},_=require("../vendor/_.js"),util=require("./util"),types=require("./types"),"use strict",pad_left=function(value,padding){var zeroes;return zeroes=Array(padding).join("0"),(zeroes+value).slice(-padding)},root.disassemble=function(class_file){var access,access_string,annotations,astr,attr,b,cls,code,const_attr,deprecated,eh,entry,exc_attr,f,fixed_width,flags,format,format_decimal,i,icls,ifaces,inner_classes,item,m,p,pool,pp_type,print_excs,ret_type,rv,sig,source_file,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6;access_string=function(access_flags){var flag,ordered_flags,privacy;return ordered_flags=["public","protected","private","static","final"],access_flags["interface"]||ordered_flags.push("abstract"),privacy=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ordered_flags.length;_i<_len;_i++)flag=ordered_flags[_i],_results.push(access_flags[flag]?""+flag+" ":void 0);return _results}().join("")},source_file=_.find(class_file.attrs,function(attr){return attr.name==="SourceFile"}),deprecated=_.find(class_file.attrs,function(attr){return attr.name==="Deprecated"}),annotations=_.find(class_file.attrs,function(attr){return attr.name==="RuntimeVisibleAnnotations"}),ifaces=function(){var _i,_len,_ref,_results;_ref=class_file.interfaces,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)i=_ref[_i],_results.push(class_file.constant_pool.get(i).deref());return _results}(),ifaces=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)i=ifaces[_i],_results.push(util.is_string(i)?util.ext_classname(i):i.toExternalString());return _results}().join(","),rv='Compiled from "'+((_ref=source_file!=null?source_file.filename:void 0)!=null?_ref:"unknown")+'"\n',rv+=access_string(class_file.access_flags),class_file.access_flags["interface"]?rv+="interface "+class_file.this_class.toExternalString()+" extends "+ifaces+"\n":(rv+="class "+class_file.this_class.toExternalString()+" extends "+((_ref1=class_file.super_class)!=null?_ref1.toExternalString():void 0),rv+=ifaces&&!class_file.access_flags["interface"]?" implements "+ifaces+"\n":"\n"),source_file&&(rv+='  SourceFile: "'+source_file.filename+'"\n'),deprecated&&(rv+="  Deprecated: length = 0x\n"),annotations&&(rv+="  RuntimeVisibleAnnotations: length = 0x"+annotations.raw_bytes.length.toString(16)+"\n",rv+="   "+function(){var _i,_len,_ref2,_results;_ref2=annotations.raw_bytes,_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++)b=_ref2[_i],_results.push(pad_left(b.toString(16),2));return _results}().join(" ")+"\n"),inner_classes=function(){var _i,_len,_ref2,_results;_ref2=class_file.attrs,_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++)attr=_ref2[_i],attr.name==="InnerClasses"&&_results.push(attr);return _results}();for(_i=0,_len=inner_classes.length;_i<_len;_i++){icls=inner_classes[_i],rv+="  InnerClass:\n",_ref2=icls.classes;for(_j=0,_len1=_ref2.length;_j<_len1;_j++)cls=_ref2[_j],flags=util.parse_flags(cls.inner_access_flags),access=function(){var _k,_len2,_ref3,_results;_ref3=["public","protected","private","abstract"],_results=[];for(_k=0,_len2=_ref3.length;_k<_len2;_k++)f=_ref3[_k],_results.push(flags[f]?f+" ":void 0);return _results}().join(""),cls.outer_info_index>0?rv+="   "+access+"#"+cls.inner_name_index+"= #"+cls.inner_info_index+" of #"+cls.outer_info_index+";\n":rv+="   "+access+"#"+cls.inner_info_index+";\n"}rv+="  minor version: "+class_file.minor_version+"\n",rv+="  major version: "+class_file.major_version+"\n",rv+="  Constant pool:\n",format_decimal=function(val,type_char){var m,str,valStr,_ref3;return valStr=val+"",type_char==="f"&&(val===util.FLOAT_POS_INFINITY||Number.POSITIVE_INFINITY?valStr="Infinity":val===util.FLOAT_NEG_INFINITY||Number.NEGATIVE_INFINITY?valStr="-Infinity":util.is_float_NaN(val)&&(valStr="NaN")),valStr.match(/-?(Infinity|NaN)/)?str=valStr:(m=valStr.match(/(-?\d+)(\.\d+)?(?:e\+?(-?\d+))?/),str=m[1]+(m[2]?m[2]:".0"),type_char==="f"&&((_ref3=m[2])!=null?_ref3.length:void 0)>8&&(str=parseFloat(str).toFixed(7)),str=str.replace(/0+$/,"").replace(/\.$/,".0"),m[3]!=null&&(str+="E"+m[3])),str+type_char},format=function(entry){var val;val=entry.value;switch(entry.type){case"Method":case"InterfaceMethod":case"Field":return"#"+val.class_ref.value+".#"+val.sig.value;case"NameAndType":return"#"+val.meth_ref.value+":#"+val.type_ref.value;case"float":return format_decimal(val,"f");case"double":return format_decimal(val,"d");case"long":return val+"l";default:return util.escape_whitespace((entry.deref!=null?"#":"")+val)}},pool=class_file.constant_pool,pool.each(function(idx,entry){return rv+="const #"+idx+" = "+entry.type+"	"+format(entry)+";",rv+=""+util.format_extra_info(entry)+"\n"}),rv+="\n",pp_type=function(field_type){return field_type instanceof types.ArrayType?pp_type(field_type.component_type)+"[]":field_type.toExternalString()},print_excs=function(exc_attr){var e,excs;return excs=exc_attr.exceptions,"   throws "+function(){var _k,_len2,_results;_results=[];for(_k=0,_len2=excs.length;_k<_len2;_k++)e=excs[_k],_results.push(util.ext_classname(e));return _results}().join(", ")},rv+="{\n",_ref3=class_file.fields;for(_k=0,_len2=_ref3.length;_k<_len2;_k++)f=_ref3[_k],astr=access_string(f.access_flags),astr!==""&&(rv+=""+astr+" "),rv+=""+pp_type(f.type)+" "+f.name+";\n",const_attr=_.find(f.attrs,function(attr){return attr.name==="ConstantValue"}),const_attr!=null&&(entry=pool.get(const_attr.ref),rv+="  Constant value: "+entry.type+" "+((typeof entry.deref=="function"?entry.deref():void 0)||entry.value)+"\n"),rv+="\n\n";_ref4=class_file.methods;for(sig in _ref4){m=_ref4[sig],rv+=access_string(m.access_flags),m.access_flags.synchronized&&(rv+="synchronized "),rv+=m.name==="<init>"?class_file.this_class.toExternalString():m.name==="<clinit>"?"{}":(ret_type=m.return_type!=null?pp_type(m.return_type):"",ret_type+" "+m.name),m.name!=="<clinit>"&&(rv+="("+function(){var _l,_len3,_ref5,_results;_ref5=m.param_types,_results=[];for(_l=0,_len3=_ref5.length;_l<_len3;_l++)p=_ref5[_l],_results.push(pp_type(p));return _results}().join(", ")+")");if(exc_attr=_.find(m.attrs,function(a){return a.name==="Exceptions"}))rv+=print_excs(exc_attr);rv+=";\n";if(!m.access_flags["native"]&&!m.access_flags.abstract){rv+="  Code:\n",code=m.code,rv+="   Stack="+code.max_stack+", Locals="+code.max_locals+", Args_size="+m.num_args+"\n",code.parse_code(),code.each_opcode(function(idx,oc){return rv+="   "+idx+":	"+oc.name,rv+=oc.annotate(idx,pool),rv+="\n"});if(code.exception_handlers.length>0){fixed_width=function(num,width){var num_str;return num_str=num+"",function(){var _l,_ref5,_results;_results=[];for(_l=0,_ref5=width-num_str.length;0>_ref5?_l>_ref5:_l<_ref5;0>_ref5?_l--:_l++)_results.push(" ");return _results}().join("")+num_str},rv+="  Exception table:\n",rv+="   from   to  target type\n",_ref5=code.exception_handlers;for(_l=0,_len3=_ref5.length;_l<_len3;_l++)eh=_ref5[_l],rv+=function(){var _len4,_m,_ref6,_results;_ref6=["start_pc","end_pc","handler_pc"],_results=[];for(_m=0,_len4=_ref6.length;_m<_len4;_m++)item=_ref6[_m],_results.push(fixed_width(eh[item],6));return _results}().join(""),rv+="   "+(eh.catch_type[0]==="<"?"any":"Class "+eh.catch_type+"\n")+"\n";rv+="\n"}_ref6=code.attrs;for(_m=0,_len4=_ref6.length;_m<_len4;_m++)attr=_ref6[_m],rv+=(typeof attr.disassemblyOutput=="function"?attr.disassemblyOutput():void 0)||"";exc_attr&&(rv+="  Exceptions:\n"+print_excs(exc_attr)+"\n")}rv+="\n"}return rv+="}\n",rv}}.call(this),function(){var JavaArray,JavaObject,arraycopy_check,arraycopy_no_check,c2t,debug,doPrivileged,error,exceptions,flatten_pkg,fs,gLong,get_property,log,native_define_class,native_methods,o,path,root,runtime,stat_file,system_properties,thread_name,trapped_methods,types,unsafe_compare_and_swap,util,vendor_path,write_to_file,_,_ref,_ref1,_ref2,_ref3;_=require("../vendor/_.js"),gLong=require("../vendor/gLong.js"),util=require("./util"),types=require("./types"),runtime=require("./runtime"),_ref=require("./java_object"),thread_name=_ref.thread_name,JavaObject=_ref.JavaObject,JavaArray=_ref.JavaArray,exceptions=require("./exceptions"),_ref1=require("./logging"),log=_ref1.log,debug=_ref1.debug,error=_ref1.error,path=(_ref2=typeof node!=="undefined"&&node!==null?node.path:void 0)!=null?_ref2:require("path"),fs=(_ref3=typeof node!=="undefined"&&node!==null?node.fs:void 0)!=null?_ref3:require("fs"),c2t=types.c2t,"use strict",root=typeof exports!="undefined"&&exports!==null?exports:this.natives={},typeof node!="undefined"&&node!==null?vendor_path="/home/doppio/vendor":vendor_path=path.resolve(__dirname,"../vendor"),system_properties={"java.home":""+vendor_path+"/java_home","sun.boot.class.path":""+vendor_path+"/classes","file.encoding":"US_ASCII","java.vendor":"Doppio","java.version":"1.6","java.vendor.url":"https://github.com/int3/doppio","java.class.version":"50.0","line.separator":"\n","file.separator":"/","path.separator":":","user.dir":path.resolve("."),"user.home":".","user.name":"DoppioUser","os.name":"Doppio","os.arch":"js","os.version":"0","java.awt.headless":(typeof node=="undefined"||node===null)+"","java.awt.graphicsenv":"classes.awt.CanvasGraphicsEnvironment",useJavaUtilZip:"true"},get_property=function(rs,jvm_key,_default){var classpath,key,val,_ref4;return _default==null&&(_default=null),key=jvm_key.jvm2js_str(),key==="java.class.path"?(classpath=(_ref4=typeof jvm!=="undefined"&&jvm!==null?jvm.classpath:void 0)!=null?_ref4:require("./jvm").classpath,rs.init_string(classpath.slice(0,classpath.length-1).join(":"))):(val=system_properties[key],val!=null?rs.init_string(val,!0):_default)},o=function(fn_name,fn){return{fn_name:fn_name,fn:fn}},trapped_methods={java:{lang:{ref:{Reference:[o("<clinit>()V",function(rs){})]},System:[o("loadLibrary(L!/!/String;)V",function(rs){}),o("adjustPropertiesForBackwardCompatibility(L!/util/Properties;)V",function(rs){}),o("getProperty(L!/!/String;)L!/!/String;",get_property),o("getProperty(L!/!/String;L!/!/String;)L!/!/String;",get_property)],Terminator:[o("setup()V",function(rs){})],Throwable:[o("fillInStackTrace()L!/!/!;",function(rs,_this){var attrs,cls,cstack,i,line_nums,ln,row,sf,source_file,stack,strace,_i,_len,_ref4,_ref5,_ref6,_ref7,_ref8;stack=[],strace=rs.init_array("[Ljava/lang/StackTraceElement;",stack),_this.set_field(rs,"java/lang/Throwable/stackTrace",strace),cstack=rs.meta_stack()._cs.slice(1,-1);for(_i=0,_len=cstack.length;_i<_len;_i++){sf=cstack[_i];if(sf.fake!=null||sf.locals[0]===_this)continue;cls=sf.method.class_type,_this.type.toClassString()!=="java/lang/NoClassDefFoundError"?(attrs=rs.load_class(cls).attrs,source_file=((_ref4=_.find(attrs,function(attr){return attr.name==="SourceFile"}))!=null?_ref4.filename:void 0)||"unknown"):source_file="unknown",line_nums=(_ref5=sf.method.code)!=null?(_ref6=_ref5.attrs)!=null?(_ref7=_ref6[0])!=null?_ref7.entries:void 0:void 0:void 0,line_nums!=null&&(ln=util.last(function(){var _results;_results=[];for(i in line_nums)row=line_nums[i],row.start_pc<=sf.pc&&_results.push(row.line_number);return _results}())),ln==null&&(ln=-1),stack.push(rs.init_object("java/lang/StackTraceElement",{"java/lang/StackTraceElement/declaringClass":rs.init_string(util.ext_classname(cls.toClassString())),"java/lang/StackTraceElement/methodName":rs.init_string((_ref8=sf.method.name)!=null?_ref8:"unknown"),"java/lang/StackTraceElement/fileName":rs.init_string(source_file),"java/lang/StackTraceElement/lineNumber":ln}))}return stack.reverse(),_this})]},util:{concurrent:{atomic:{AtomicInteger:[o("<clinit>()V",function(rs){}),o("compareAndSet(II)Z",function(rs,_this,expect,update){return _this.set_field(rs,"java/util/concurrent/atomic/AtomicInteger/value",update),!0})]}},Currency:[o("getInstance(Ljava/lang/String;)Ljava/util/Currency;",function(rs){return null})]},nio:{Bits:[o("byteOrder()L!/!/ByteOrder;",function(rs){return rs.static_get({"class":"java/nio/ByteOrder",name:"LITTLE_ENDIAN"})})],charset:{Charset$3:[o("run()L!/lang/Object;",function(rs){return null})]}}}},doPrivileged=function(rs,action){var m,my_sf;throw my_sf=rs.curr_frame(),m=rs.method_lookup({"class":action.type.toClassString(),sig:"run()Ljava/lang/Object;"}),m.access_flags["static"]||rs.push(action),m.setup_stack(rs),my_sf.runner=function(){var rv;return rv=rs.pop(),rs.meta_stack().pop(),rs.push(rv)},exceptions.ReturnException},stat_file=function(fname){try{return util.is_string(fname)?fs.statSync(fname):fs.fstatSync(fname)}catch(e){return null}},arraycopy_no_check=function(src,src_pos,dest,dest_pos,length){var i,j,_i,_ref4;j=dest_pos;for(i=_i=src_pos,_ref4=src_pos+length;_i<_ref4;i=_i+=1)dest.array[j++]=src.array[i]},arraycopy_check=function(rs,src,src_pos,dest,dest_pos,length){var i,j,_i,_ref4;j=dest_pos;for(i=_i=src_pos,_ref4=src_pos+length;_i<_ref4;i=_i+=1)src.array[i]===null||types.is_castable(rs,src.array[i].type,dest.type.component_type)?dest.array[j]=src.array[i]:exceptions.java_throw(rs,"java/lang/ArrayStoreException","Array element in src cannot be cast to dest array type."),j++},unsafe_compare_and_swap=function(rs,_this,obj,offset,expected,x){var actual;return actual=obj.get_field_from_offset(rs,offset),actual===expected?(obj.set_field_from_offset(rs,offset,x),!0):!1},native_define_class=function(rs,name,bytes,offset,len,loader){var b,raw_bytes;return raw_bytes=function(){var _i,_len,_ref4,_results;_ref4=bytes.array.slice(offset,offset+len),_results=[];for(_i=0,_len=_ref4.length;_i<_len;_i++)b=_ref4[_i],_results.push((256+b)%256);return _results}(),rs.define_class(util.int_classname(name.jvm2js_str()),raw_bytes,loader)},write_to_file=function(rs,_this,bytes,offset,len,append){_this.$file==="closed"&&exceptions.java_throw(rs,"java/io/IOException","Bad file descriptor");if(_this.$file!=null){fs.writeSync(_this.$file,new Buffer(bytes.array),offset,len);return}rs.print(util.chars2js_str(bytes,offset,len));if(typeof node!="undefined"&&node!==null)throw rs.curr_frame().runner=function(){return rs.meta_stack().pop()},new exceptions.YieldIOException(function(cb){return setTimeout(cb,0)})},native_methods={java:{lang:{Class:[o("getPrimitiveClass(L!/!/String;)L!/!/!;",function(rs,jvm_str){return rs.jclass_obj(new types.PrimitiveType(jvm_str.jvm2js_str()),!0)}),o("getClassLoader0()L!/!/ClassLoader;",function(rs,_this){return rs.class_states[_this.type.toClassString()].loader}),o("desiredAssertionStatus0(L!/!/!;)Z",function(rs){return!1}),o("getName0()L!/!/String;",function(rs,_this){return rs.init_string(_this.$type.toExternalString())}),o("forName0(L!/!/String;ZL!/!/ClassLoader;)L!/!/!;",function(rs,jvm_str,initialize,loader){var my_sf,rv,type;type=c2t(util.int_classname(jvm_str.jvm2js_str()));if(loader===null)return rv=rs.jclass_obj(type,!0),initialize&&rs.class_lookup(type,!0),rv;throw my_sf=rs.curr_frame(),rs.push2(loader,jvm_str),rs.method_lookup({"class":loader.type.toClassString(),sig:"loadClass(Ljava/lang/String;)Ljava/lang/Class;"}).setup_stack(rs),my_sf.runner=function(){rv=rs.pop(),rs.meta_stack().pop(),rs.push(rv);if(initialize)return rs.class_lookup(type,!0)},exceptions.ReturnException}),o("getComponentType()L!/!/!;",function(rs,_this){var type;return type=_this.$type,type instanceof types.ArrayType?rs.jclass_obj(type.component_type,!0):null}),o("getGenericSignature()Ljava/lang/String;",function(rs,_this){var sig,_ref4;return sig=(_ref4=_.find(_this.file.attrs,function(a){return a.name==="Signature"}))!=null?_ref4.sig:void 0,sig!=null?rs.init_string(sig):null}),o("getProtectionDomain0()Ljava/security/ProtectionDomain;",function(rs,_this){return null}),o("isAssignableFrom(L!/!/!;)Z",function(rs,_this,cls){return types.is_castable(rs,cls.$type,_this.$type)}),o("isInterface()Z",function(rs,_this){return _this.$type instanceof types.ClassType?_this.file.access_flags["interface"]:!1}),o("isInstance(L!/!/Object;)Z",function(rs,_this,obj){return types.is_castable(rs,obj.type,_this.$type)}),o("isPrimitive()Z",function(rs,_this){return _this.$type instanceof types.PrimitiveType}),o("isArray()Z",function(rs,_this){return _this.$type instanceof types.ArrayType}),o("getSuperclass()L!/!/!;",function(rs,_this){var cls;return _this.$type instanceof types.PrimitiveType?null:(cls=_this.file,cls.access_flags["interface"]||cls.super_class==null?null:rs.jclass_obj(cls.super_class,!0))}),o("getDeclaredFields0(Z)[Ljava/lang/reflect/Field;",function(rs,_this,public_only){var f,fields;return fields=_this.file.fields,public_only&&(fields=function(){var _i,_len,_results;_results=[];for(_i=0,_len=fields.length;_i<_len;_i++)f=fields[_i],f.access_flags["public"]&&_results.push(f);return _results}()),rs.init_array("[Ljava/lang/reflect/Field;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=fields.length;_i<_len;_i++)f=fields[_i],_results.push(f.reflector(rs));return _results}())}),o("getDeclaredMethods0(Z)[Ljava/lang/reflect/Method;",function(rs,_this,public_only){var m,methods,sig;return methods=_this.file.methods,methods=function(){var _results;_results=[];for(sig in methods)m=methods[sig],sig[0]!=="<"&&(m.access_flags["public"]||!public_only)&&_results.push(m);return _results}(),rs.init_array("[Ljava/lang/reflect/Method;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],_results.push(m.reflector(rs));return _results}())}),o("getDeclaredConstructors0(Z)[Ljava/lang/reflect/Constructor;",function(rs,_this,public_only){var m,methods,sig;return methods=_this.file.methods,methods=function(){var _results;_results=[];for(sig in methods)m=methods[sig],m.name==="<init>"&&_results.push(m);return _results}(),public_only&&(methods=function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],m.access_flags["public"]&&_results.push(m);return _results}()),rs.init_array("[Ljava/lang/reflect/Constructor;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],_results.push(m.reflector(rs,!0));return _results}())}),o("getInterfaces()[L!/!/!;",function(rs,_this){var cls,i,iface,iface_objs,ifaces;return cls=_this.file,ifaces=function(){var _i,_len,_ref4,_results;_ref4=cls.interfaces,_results=[];for(_i=0,_len=_ref4.length;_i<_len;_i++)i=_ref4[_i],_results.push(cls.constant_pool.get(i).deref());return _results}(),ifaces=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)i=ifaces[_i],_results.push(util.is_string(i)?c2t(i):i);return _results}(),iface_objs=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)iface=ifaces[_i],_results.push(rs.jclass_obj(iface,!0));return _results}(),rs.init_array("[Ljava/lang/Class;",iface_objs)}),o("getModifiers()I",function(rs,_this){return _this.file.access_byte}),o("getRawAnnotations()[B",function(rs,_this){var annotations,cls,m,sig,_ref4;cls=_this.file,annotations=_.find(cls.attrs,function(a){return a.name==="RuntimeVisibleAnnotations"});if(annotations!=null)return new JavaArray(rs,c2t("[B"),annotations.raw_bytes);_ref4=cls.methods;for(sig in _ref4){m=_ref4[sig],annotations=_.find(m.attrs,function(a){return a.name==="RuntimeVisibleAnnotations"});if(annotations!=null)return new JavaArray(rs,c2t("[B"),annotations.raw_bytes)}return null}),o("getConstantPool()Lsun/reflect/ConstantPool;",function(rs,_this){var cls;return cls=_this.file,rs.init_object("sun/reflect/ConstantPool",{"sun/reflect/ConstantPool/constantPoolOop":cls.constant_pool})}),o("getEnclosingMethod0()[L!/!/Object;",function(rs,_this){var cls,em;return _this.$type instanceof types.ClassType?(cls=_this.file,em=_.find(cls.attrs,function(a){return a.name==="EnclosingMethod"}),em==null?null:exceptions.java_throw(rs,"java/lang/Error","native method not finished: java.lang.Class.getEnclosingClass")):null}),o("getDeclaringClass()L!/!/!;",function(rs,_this){var cls,declaring_name,entry,icls,my_class,name,_i,_len,_ref4;if(_this.$type instanceof types.ClassType){cls=_this.file,icls=_.find(cls.attrs,function(a){return a.name==="InnerClasses"});if(icls==null)return null;my_class=_this.$type.toClassString(),_ref4=icls.classes;for(_i=0,_len=_ref4.length;_i<_len;_i++){entry=_ref4[_i];if(entry.outer_info_index>0){name=cls.constant_pool.get(entry.inner_info_index).deref();if(name!==my_class)continue;return declaring_name=cls.constant_pool.get(entry.outer_info_index).deref(),rs.jclass_obj(c2t(declaring_name),!0)}continue}return null}return null}),o("getDeclaredClasses0()[L!/!/!;",function(rs,_this){var a,c,cls,enclosing_name,icls,iclses,my_class,name,ret,_i,_j,_len,_len1,_ref4;ret=new JavaArray(rs,c2t("[Ljava/lang/Class;"),[]);if(_this.$type instanceof types.ClassType){cls=_this.file,my_class=_this.$type.toClassString(),iclses=function(){var _i,_len,_ref4,_results;_ref4=cls.attrs,_results=[];for(_i=0,_len=_ref4.length;_i<_len;_i++)a=_ref4[_i],a.name==="InnerClasses"&&_results.push(a);return _results}();for(_i=0,_len=iclses.length;_i<_len;_i++){icls=iclses[_i],_ref4=icls.classes;for(_j=0,_len1=_ref4.length
;_j<_len1;_j++){c=_ref4[_j];if(c.outer_info_index<=0)continue;enclosing_name=cls.constant_pool.get(c.outer_info_index).deref();if(enclosing_name!==my_class)continue;name=cls.constant_pool.get(c.inner_info_index).deref(),ret.array.push(rs.jclass_obj(c2t(name),!0))}}return ret}return ret})],ClassLoader:[o("findLoadedClass0(L!/!/String;)L!/!/Class;",function(rs,_this,name){var rv,type;type=c2t(util.int_classname(name.jvm2js_str())),rv=null;try{rv=rs.jclass_obj(type,!0)}catch(e){if(!(e instanceof exceptions.JavaException))throw e}return rv}),o("findBootstrapClass(L!/!/String;)L!/!/Class;",function(rs,_this,name){var type;return type=c2t(util.int_classname(name.jvm2js_str())),rs.jclass_obj(type,!0)}),o("getCaller(I)L!/!/Class;",function(rs,i){var type;return type=rs.meta_stack().get_caller(i).method.class_type,rs.jclass_obj(type,!0)}),o("defineClass1(L!/!/String;[BIIL!/security/ProtectionDomain;L!/!/String;Z)L!/!/Class;",function(rs,_this,name,bytes,offset,len,pd,source,unused){return native_define_class(rs,name,bytes,offset,len,_this)}),o("defineClass1(L!/!/String;[BIIL!/security/ProtectionDomain;L!/!/String;)L!/!/Class;",function(rs,_this,name,bytes,offset,len,pd,source){return native_define_class(rs,name,bytes,offset,len,_this)}),o("resolveClass0(L!/!/Class;)V",function(rs,_this,cls){return rs.load_class(cls.$type,!0)})],Compiler:[o("disable()V",function(rs,_this){}),o("enable()V",function(rs,_this){})],Float:[o("floatToRawIntBits(F)I",function(rs,f_val){var exp,f_view,i_view,sig,sign;return typeof Float32Array!="undefined"&&Float32Array!==null?(f_view=new Float32Array([f_val]),i_view=new Int32Array(f_view.buffer),i_view[0]):f_val===0?0:f_val===Number.POSITIVE_INFINITY?util.FLOAT_POS_INFINITY_AS_INT:f_val===Number.NEGATIVE_INFINITY?util.FLOAT_NEG_INFINITY_AS_INT:isNaN(f_val)?util.FLOAT_NaN_AS_INT:(sign=f_val<0?1:0,f_val=Math.abs(f_val),f_val>1.1754942106924411e-38||f_val<1.401298464324817e-45?(exp=Math.floor(Math.log(f_val)/Math.LN2),sig=Math.round((f_val/Math.pow(2,exp)-1)*Math.pow(2,23)),sign<<31|exp+127<<23|sig):(exp=0,sig=Math.round(f_val/Math.pow(2,-126)*Math.pow(2,23)),sign<<31|exp<<23|sig))}),o("intBitsToFloat(I)F",function(rs,i_val){return util.intbits2float(i_val)})],Double:[o("doubleToRawLongBits(D)J",function(rs,d_val){var d_view,exp,high_bits,i_view,sig,sign;return typeof Float64Array!="undefined"&&Float64Array!==null?(d_view=new Float64Array([d_val]),i_view=new Uint32Array(d_view.buffer),gLong.fromBits(i_view[0],i_view[1])):d_val===0?gLong.ZERO:d_val===Number.POSITIVE_INFINITY?gLong.fromBits(0,2146435072):d_val===Number.NEGATIVE_INFINITY?gLong.fromBits(0,-1048576):isNaN(d_val)?gLong.fromBits(0,2146959360):(sign=d_val<0?1<<31:0,d_val=Math.abs(d_val),d_val>2.225073858507201e-308||d_val<5e-324?(exp=Math.floor(Math.log(d_val)/Math.LN2),d_val<Math.pow(2,exp)&&(exp-=1),sig=gLong.fromNumber((d_val/Math.pow(2,exp)-1)*Math.pow(2,52)),exp=exp+1023<<20):(exp=0,sig=gLong.fromNumber(d_val/Math.pow(2,-1022)*Math.pow(2,52))),high_bits=sig.getHighBits()|sign|exp,gLong.fromBits(sig.getLowBits(),high_bits))}),o("longBitsToDouble(J)D",function(rs,l_val){return util.longbits2double(l_val.getHighBits(),l_val.getLowBitsUnsigned())})],Object:[o("getClass()L!/!/Class;",function(rs,_this){return rs.jclass_obj(_this.type,!1)}),o("hashCode()I",function(rs,_this){return _this.ref}),o("clone()L!/!/!;",function(rs,_this){return _this.clone(rs)}),o("notify()V",function(rs,_this){var locker,owner;(locker=rs.lock_refs[_this])!=null&&locker!==rs.curr_thread&&(owner=thread_name(rs,locker),exceptions.java_throw(rs,"java/lang/IllegalMonitorStateException","Thread '"+owner+"' owns this monitor"));if(rs.waiting_threads[_this]!=null)return rs.waiting_threads[_this].shift()}),o("notifyAll()V",function(rs,_this){var locker,owner;(locker=rs.lock_refs[_this])!=null&&locker!==rs.curr_thread&&(owner=thread_name(rs,locker),exceptions.java_throw(rs,"java/lang/IllegalMonitorStateException","Thread '"+owner+"' owns this monitor"));if(rs.waiting_threads[_this]!=null)return rs.waiting_threads[_this]=[]}),o("wait(J)V",function(rs,_this,timeout){var locker,owner;return timeout!==gLong.ZERO&&error("TODO(Object::wait): respect the timeout param ("+timeout+")"),(locker=rs.lock_refs[_this])!=null&&locker!==rs.curr_thread&&(owner=thread_name(rs,locker),exceptions.java_throw(rs,"java/lang/IllegalMonitorStateException","Thread '"+owner+"' owns this monitor")),rs.lock_refs[_this]=null,rs.wait(_this)})],Package:[o("getSystemPackage0(Ljava/lang/String;)Ljava/lang/String;",function(rs){return null})],ProcessEnvironment:[o("environ()[[B",function(rs){var env_arr,k,v,_ref4;env_arr=[],_ref4=process.env;for(k in _ref4)v=_ref4[k],env_arr.push(new JavaArray(rs,c2t("[B"),util.bytestr_to_array(k))),env_arr.push(new JavaArray(rs,c2t("[B"),util.bytestr_to_array(v)));return new JavaArray(rs,c2t("[[B"),env_arr)})],reflect:{Array:[o("newArray(L!/!/Class;I)L!/!/Object;",function(rs,_this,len){return rs.heap_newarray(_this.$type,len)}),o("getLength(Ljava/lang/Object;)I",function(rs,arr){return rs.check_null(arr).array.length})],Proxy:[o("defineClass0(L!/!/ClassLoader;L!/!/String;[BII)L!/!/Class;",function(rs,cl,name,bytes,offset,len){return native_define_class(rs,name,bytes,offset,len,cl)})]},Runtime:[o("availableProcessors()I",function(){return 1}),o("gc()V",function(rs){throw rs.curr_frame().runner=function(){return rs.meta_stack().pop()},new exceptions.YieldIOException(function(cb){return setTimeout(cb,0)})})],Shutdown:[o("halt0(I)V",function(rs,status){throw new exceptions.HaltException(status)})],StrictMath:[o("acos(D)D",function(rs,d_val){return Math.acos(d_val)}),o("asin(D)D",function(rs,d_val){return Math.asin(d_val)}),o("atan(D)D",function(rs,d_val){return Math.atan(d_val)}),o("atan2(DD)D",function(rs,y,x){return Math.atan2(y,x)}),o("cos(D)D",function(rs,d_val){return Math.cos(d_val)}),o("exp(D)D",function(rs,d_val){return Math.exp(d_val)}),o("log(D)D",function(rs,d_val){return Math.log(d_val)}),o("pow(DD)D",function(rs){return Math.pow(rs.cl(0),rs.cl(2))}),o("sin(D)D",function(rs,d_val){return Math.sin(d_val)}),o("sqrt(D)D",function(rs,d_val){return Math.sqrt(d_val)}),o("tan(D)D",function(rs,d_val){return Math.tan(d_val)}),o("floor(D)D",function(rs,d_val){return Math.floor(d_val)}),o("ceil(D)D",function(rs,d_val){return Math.ceil(d_val)})],String:[o("intern()L!/!/!;",function(rs,_this){var js_str,s;return js_str=_this.jvm2js_str(),(s=rs.string_pool.get(js_str))==null&&(s=rs.string_pool.set(js_str,_this)),s})],System:[o("arraycopy(L!/!/Object;IL!/!/Object;II)V",function(rs,src,src_pos,dest,dest_pos,length){return(src==null||dest==null)&&exceptions.java_throw(rs,"java/lang/NullPointerException","Cannot copy to/from a null array."),(!(src.type instanceof types.ArrayType)||!(dest.type instanceof types.ArrayType))&&exceptions.java_throw(rs,"java/lang/ArrayStoreException","src and dest arguments must be of array type."),(src_pos<0||src_pos+length>src.array.length||dest_pos<0||dest_pos+length>dest.array.length||length<0)&&exceptions.java_throw(rs,"java/lang/ArrayIndexOutOfBoundsException","Tried to write to an illegal index in an array."),src===dest&&(src={type:src.type,array:src.array.slice(src_pos,src_pos+length)},src_pos=0),types.is_castable(rs,src.type,dest.type)?arraycopy_no_check(src,src_pos,dest,dest_pos,length):src.type.component_type instanceof types.PrimitiveType||dest.type.component_type instanceof types.PrimitiveType?exceptions.java_throw(rs,"java/lang/ArrayStoreException","If calling arraycopy with a primitive array, both src and dest must be of the same primitive type."):arraycopy_check(rs,src,src_pos,dest,dest_pos,length)}),o("currentTimeMillis()J",function(rs){return gLong.fromNumber((new Date).getTime())}),o("identityHashCode(L!/!/Object;)I",function(rs,x){var _ref4;return(_ref4=x!=null?x.ref:void 0)!=null?_ref4:0}),o("initProperties(L!/util/Properties;)L!/util/Properties;",function(rs,props){return rs.push(null)}),o("nanoTime()J",function(rs){return gLong.fromNumber((new Date).getTime()).multiply(gLong.fromNumber(1e6))}),o("setIn0(L!/io/InputStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"in"})}),o("setOut0(L!/io/PrintStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"out"})}),o("setErr0(L!/io/PrintStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"err"})})],Thread:[o("currentThread()L!/!/!;",function(rs){return rs.curr_thread}),o("setPriority0(I)V",function(rs){}),o("holdsLock(L!/!/Object;)Z",function(rs,obj){return rs.curr_thread===rs.lock_refs[obj]}),o("isAlive()Z",function(rs,_this){var _ref4;return(_ref4=_this.$isAlive)!=null?_ref4:!1}),o("isInterrupted(Z)Z",function(rs,_this,clear_flag){var tmp,_ref4;return tmp=(_ref4=_this.$isInterrupted)!=null?_ref4:!1,clear_flag&&(_this.$isInterrupted=!1),tmp}),o("interrupt0()V",function(rs,_this){var new_thread_sf;return _this.$isInterrupted=!0,new_thread_sf=util.last(_this.$meta_stack._cs),new_thread_sf.runner=function(){return new_thread_sf.method.run_manually(function(){return exceptions.java_throw(rs,"java/lang/InterruptedException","interrupt0 called")},rs,[])},_this.$meta_stack.push({}),rs.yield(_this)}),o("start0()V",function(rs,_this){var new_thread_sf,old_thread_sf,run_method,thread_runner_sf;throw _this.$isAlive=!0,_this.$meta_stack=new runtime.CallStack,rs.thread_pool.push(_this),old_thread_sf=rs.curr_frame(),rs.curr_thread=_this,new_thread_sf=rs.curr_frame(),rs.push(_this),run_method=rs.method_lookup({"class":_this.type.toClassString(),sig:"run()V"}),thread_runner_sf=run_method.setup_stack(rs),new_thread_sf.runner=function(){new_thread_sf.runner=null,_this.$isAlive=!1;return},old_thread_sf.runner=function(){return rs.meta_stack().pop()},exceptions.ReturnException}),o("sleep(J)V",function(rs,millis){throw rs.curr_frame().runner=function(){return rs.meta_stack().pop()},new exceptions.YieldIOException(function(cb){return setTimeout(cb,millis.toNumber())})}),o("yield()V",function(rs,_this){return rs.yield()})]},security:{AccessController:[o("doPrivileged(L!/!/PrivilegedAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("getStackAccessControlContext()Ljava/security/AccessControlContext;",function(rs){return null})]},io:{Console:[o("encoding()L!/lang/String;",function(){return null}),o("istty()Z",function(){return!0})],FileSystem:[o("getFileSystem()L!/!/!;",function(rs){var cache1,cache2,cache_init,my_sf;throw my_sf=rs.curr_frame(),cache1=rs.init_object("java/io/ExpiringCache"),cache2=rs.init_object("java/io/ExpiringCache"),cache_init=rs.method_lookup({"class":"java/io/ExpiringCache",sig:"<init>()V"}),rs.push2(cache1,cache2),cache_init.setup_stack(rs),my_sf.runner=function(){return cache_init.setup_stack(rs),my_sf.runner=function(){var rv;return rv=rs.init_object("java/io/UnixFileSystem",{"java/io/UnixFileSystem/cache":cache1,"java/io/UnixFileSystem/javaHomePrefixCache":cache2,"java/io/UnixFileSystem/slash":system_properties["file.separator"].charCodeAt(0),"java/io/UnixFileSystem/colon":system_properties["path.separator"].charCodeAt(0),"java/io/UnixFileSystem/javaHome":rs.init_string(system_properties["java.home"],!0)}),rs.meta_stack().pop(),rs.push(rv)}},exceptions.ReturnException})],FileOutputStream:[o("open(L!/lang/String;)V",function(rs,_this,fname){return _this.$file=fs.openSync(fname.jvm2js_str(),"w")}),o("writeBytes([BIIZ)V",write_to_file),o("writeBytes([BII)V",write_to_file),o("close0()V",function(rs,_this){return _this.$file!=null&&fs.closeSync(_this.$file),_this.$file="closed"})],FileInputStream:[o("available()I",function(rs,_this){var stats;return _this.$file==="closed"&&exceptions.java_throw(rs,"java/io/IOException","Bad file descriptor"),_this.$file==null?0:(stats=fs.fstatSync(_this.$file),stats.size-_this.$pos)}),o("read()I",function(rs,_this){var buf,bytes_read,data,file;_this.$file==="closed"&&exceptions.java_throw(rs,"java/io/IOException","Bad file descriptor");if((file=_this.$file)!=null)return buf=new Buffer(fs.fstatSync(file).size),bytes_read=fs.readSync(file,buf,0,1,_this.$pos),_this.$pos++,bytes_read===0?-1:buf.readUInt8(0);throw data=null,rs.curr_frame().runner=function(){return rs.meta_stack().pop(),rs.push(data.length===0?-1:data.charCodeAt(0))},new exceptions.YieldIOException(function(cb){return rs.async_input(1,function(byte){return data=byte,cb()})})}),o("readBytes([BII)I",function(rs,_this,byte_arr,offset,n_bytes){var buf,bytes_read,file,i,pos,result,_i;_this.$file==="closed"&&exceptions.java_throw(rs,"java/io/IOException","Bad file descriptor");if(_this.$file!=null){pos=_this.$pos,file=_this.$file,buf=new Buffer(n_bytes);if(pos<fs.fstatSync(file).size-1){bytes_read=fs.readSync(file,buf,0,n_bytes,pos),_this.$pos+=bytes_read;for(i=_i=0;_i<bytes_read;i=_i+=1)byte_arr.array[offset+i]=buf.readUInt8(i);return bytes_read===0&&n_bytes!==0?-1:bytes_read}return-1}throw result=null,rs.curr_frame().runner=function(){return rs.meta_stack().pop(),rs.push(result)},new exceptions.YieldIOException(function(cb){return rs.async_input(n_bytes,function(bytes){var b,idx,_j,_len;for(idx=_j=0,_len=bytes.length;_j<_len;idx=++_j)b=bytes[idx],byte_arr.array[offset+idx]=b;return result=bytes.length,cb()})})}),o("open(Ljava/lang/String;)V",function(rs,_this,filename){var filepath;filepath=filename.jvm2js_str();try{return _this.$file=fs.openSync(filepath,"r"),_this.$pos=0}catch(e){if(e.code==="ENOENT")return exceptions.java_throw(rs,"java/io/FileNotFoundException","Could not open file "+filepath);throw e}}),o("close0()V",function(rs,_this){return _this.$file!=null&&fs.closeSync(_this.$file),_this.$file="closed"}),o("skip(J)J",function(rs,_this,n_bytes){var bytes_left,file,num_skipped,to_skip;_this.$file==="closed"&&exceptions.java_throw(rs,"java/io/IOException","Bad file descriptor");if((file=_this.$file)!=null)return bytes_left=fs.fstatSync(file).size-_this.$pos,to_skip=Math.min(n_bytes.toNumber(),bytes_left),_this.$pos+=to_skip,gLong.fromNumber(to_skip);throw num_skipped=null,rs.curr_frame().runner=function(){return rs.meta_stack().pop(),rs.push(gLong.fromNumber(num_skipped))},new exceptions.YieldIOException(function(cb){return rs.async_input(n_bytes.toNumber(),function(bytes){return num_skipped=bytes.length,cb()})})})],ObjectStreamClass:[o("initNative()V",function(rs){})],RandomAccessFile:[o("open(Ljava/lang/String;I)V",function(rs,_this,filename,mode){var filepath;filepath=filename.jvm2js_str();try{_this.$file=fs.openSync(filepath,"r")}catch(e){if(e.code!=="ENOENT")throw e;exceptions.java_throw(rs,"java/io/FileNotFoundException","Could not open file "+filepath)}return _this.$pos=0}),o("getFilePointer()J",function(rs,_this){return gLong.fromNumber(_this.$pos)}),o("length()J",function(rs,_this){var stats;return stats=stat_file(_this.$file),gLong.fromNumber(stats.size)}),o("seek(J)V",function(rs,_this,pos){return _this.$pos=pos}),o("readBytes([BII)I",function(rs,_this,byte_arr,offset,len){var buf,bytes_read,file,i,pos,_i;pos=_this.$pos.toNumber(),file=_this.$file;if(pos<fs.fstatSync(file).size-1){buf=new Buffer(len),bytes_read=fs.readSync(file,buf,0,len,pos);for(i=_i=0;_i<bytes_read;i=_i+=1)byte_arr.array[offset+i]=buf.readUInt8(i);return _this.$pos=gLong.fromNumber(pos+bytes_read),bytes_read===0&&len!==0?-1:bytes_read}return-1}),o("close0()V",function(rs,_this){return fs.closeSync(_this.$file),_this.$file=null})],UnixFileSystem:[o("canonicalize0(L!/lang/String;)L!/lang/String;",function(rs,_this,jvm_path_str){var js_str;return js_str=jvm_path_str.jvm2js_str(),rs.init_string(path.resolve(path.normalize(js_str)))}),o("checkAccess(Ljava/io/File;I)Z",function(rs,_this,file,access){var filepath,mask,stats;return filepath=file.get_field(rs,"java/io/File/path"),stats=stat_file(filepath.jvm2js_str()),stats==null?!1:(mask=access|access<<3|access<<6,(stats.mode&mask)>0)}),o("createDirectory(Ljava/io/File;)Z",function(rs,_this,file){var filepath;filepath=file.get_field(rs,"java/io/File/path").jvm2js_str();if(stat_file(filepath)!=null)return!1;try{fs.mkdirSync(filepath)}catch(e){return!1}return!0}),o("createFileExclusively(Ljava/lang/String;)Z",function(rs,_this,path){var filepath;filepath=path.jvm2js_str();if(stat_file(filepath)!=null)return!1;try{fs.closeSync(fs.openSync(filepath,"w"))}catch(e){exceptions.java_throw(rs,"java/io/IOException",e.message)}return!0}),o("createFileExclusively(Ljava/lang/String;Z)Z",function(rs,_this,path){var filepath;filepath=path.jvm2js_str();if(stat_file(filepath)!=null)return!1;try{fs.closeSync(fs.openSync(filepath,"w"))}catch(e){exceptions.java_throw(rs,"java/io/IOException",e.message)}return!0}),o("delete0(Ljava/io/File;)Z",function(rs,_this,file){var filepath,stats;filepath=file.get_field(rs,"java/io/File/path").jvm2js_str(),stats=stat_file(filepath);if(stats==null)return!1;try{if(stats.isDirectory()){if(fs.readdirSync(filepath).length>0)return!1;fs.rmdirSync(filepath)}else fs.unlinkSync(filepath)}catch(e){return!1}return!0}),o("getBooleanAttributes0(Ljava/io/File;)I",function(rs,_this,file){var filepath,stats;return filepath=file.get_field(rs,"java/io/File/path"),stats=stat_file(filepath.jvm2js_str()),stats==null?0:stats.isFile()?3:stats.isDirectory()?5:1}),o("getLastModifiedTime(Ljava/io/File;)J",function(rs,_this,file){var filepath,stats;return filepath=file.get_field(rs,"java/io/File/path").jvm2js_str(),stats=stat_file(filepath),stats==null?gLong.ZERO:gLong.fromNumber((new Date(stats.mtime)).getTime())}),o("getLength(Ljava/io/File;)J",function(rs,_this,file){var filepath,length;filepath=file.get_field(rs,"java/io/File/path");try{length=fs.statSync(filepath.jvm2js_str()).size}catch(e){length=0}return gLong.fromNumber(length)}),o("list(Ljava/io/File;)[Ljava/lang/String;",function(rs,_this,file){var f,filepath,files;filepath=file.get_field(rs,"java/io/File/path");try{files=fs.readdirSync(filepath.jvm2js_str())}catch(e){return null}return rs.init_array("[Ljava/lang/String;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++)f=files[_i],_results.push(rs.init_string(f));return _results}())}),o("rename0(Ljava/io/File;Ljava/io/File;)Z",function(rs,_this,file1,file2){var file1path,file2path;file1path=file1.get_field(rs,"java/io/File/path").jvm2js_str(),file2path=file2.get_field(rs,"java/io/File/path").jvm2js_str();try{fs.renameSync(file1path,file2path)}catch(e){return!1}return!0}),o("setPermission(Ljava/io/File;IZZ)Z",function(rs,_this,file,access,enable,owneronly){var existing_access,filepath,stats;filepath=file.get_field(rs,"java/io/File/path").jvm2js_str(),owneronly?access<<=6:access|=access<<6|access<<3,enable||(access=~access);try{stats=stat_file(filepath);if(stats==null)return!1;existing_access=stats.mode,access=enable?existing_access|access:existing_access&access,fs.chmodSync(filepath,access)}catch(e){return!1}return!0}),o("setReadOnly(Ljava/io/File;)Z",function(rs,_this,file){var filepath,mask,stats;filepath=file.get_field(rs,"java/io/File/path").jvm2js_str(),mask=-147;try{stats=stat_file(filepath);if(stats==null)return!1;fs.chmodSync(filepath,stats.mode&mask)}catch(e){return!1}return!0})]},util:{concurrent:{atomic:{AtomicLong:[o("VMSupportsCS8()Z",function(){return!0})]}},jar:{JarFile:[o("getMetaInfEntryNames()[L!/lang/String;",function(rs){return null})]},ResourceBundle:[o("getClassContext()[L!/lang/Class;",function(rs){return rs.init_array("[Ljava/lang/Class;",[null,null,null])})],TimeZone:[o("getSystemTimeZoneID(L!/lang/String;L!/lang/String;)L!/lang/String;",function(rs,java_home,country){return rs.init_string("GMT")}),o("getSystemGMTOffsetID()L!/lang/String;",function(rs){return null})]}},sun:{management:{VMManagementImpl:[o("getStartupTime()J",function(rs){return rs.startup_time}),o("getVersion0()Ljava/lang/String;",function(rs){return rs.init_string("1.2",!0)}),o("initOptionalSupportFields()V",function(rs){var field_names,name,_i,_len,_results;field_names=["compTimeMonitoringSupport","threadContentionMonitoringSupport","currentThreadCpuTimeSupport","otherThreadCpuTimeSupport","bootClassPathSupport","objectMonitorUsageSupport","synchronizerUsageSupport"],_results=[];for(_i=0,_len=field_names.length;_i<_len;_i++)name=field_names[_i],rs.push(0),_results.push(rs.static_put({"class":"sun/management/VMManagementImpl",name:name}));return _results}),o("isThreadAllocatedMemoryEnabled()Z",function(){return!1}),o("isThreadContentionMonitoringEnabled()Z",function(){return!1}),o("isThreadCpuTimeEnabled()Z",function(){return!1}),o("getAvailableProcessors()I",function(){return 1}),o("getProcessId()I",function(){return 1})],MemoryImpl:[o("getMemoryManagers0()[Ljava/lang/management/MemoryManagerMXBean;",function(rs){return rs.init_array("[Lsun/management/MemoryManagerImpl;",[])}),o("getMemoryPools0()[Ljava/lang/management/MemoryPoolMXBean;",function(rs){return rs.init_array("[Lsun/management/MemoryPoolImpl;",[])})]},misc:{VM:[o("initialize()V",function(rs){var vm_cls;vm_cls=rs.class_lookup(c2t("sun/misc/VM"));if(vm_cls.major_version<51)return;return rs.push(rs.static_get({"class":"java/lang/System",name:"props"})),rs.static_put({"class":"sun/misc/VM",name:"savedProps"})})],Unsafe:[o("addressSize()I",function(rs,_this){return 4}),o("allocateInstance(Ljava/lang/Class;)Ljava/lang/Object;",function(rs,_this,cls){return rs.init_object(cls.$type.toClassString(),{})}),o("allocateMemory(J)J",function(rs,_this,size){var i,next_addr,_i;next_addr=util.last(rs.mem_start_addrs);if(typeof DataView!="undefined"&&DataView!==null)rs.mem_blocks[next_addr]=new DataView(new ArrayBuffer(size));else{rs.mem_blocks[next_addr]=size,next_addr+=1;for(i=_i=0;_i<size;i=_i+=1)rs.mem_blocks[next_addr+i]=0}return rs.mem_start_addrs.push(next_addr+size),gLong.fromNumber(next_addr)}),o("setMemory(JJB)V",function(rs,_this,address,bytes,value){var block_addr,i,_i;block_addr=rs.block_addr(address);for(i=_i=0;_i<bytes;i=_i+=1)typeof DataView!="undefined"&&DataView!==null?rs.mem_blocks[block_addr].setInt8(i,value):rs.mem_blocks[block_addr+i]=value}),o("freeMemory(J)V",function(rs,_this,address){var i,num_blocks,_i;if(typeof DataView!="undefined"&&DataView!==null)delete rs.mem_blocks[address.toNumber()];else{address=address.toNumber(),num_blocks=rs.mem_blocks[address-1];for(i=_i=0;_i<num_blocks;i=_i+=1)delete rs.mem_blocks[address+i];delete rs.mem_blocks[address-1],address-=1}return rs.mem_start_addrs.splice(rs.mem_start_addrs.indexOf(address),1)}),o("putLong(JJ)V",function(rs,_this,address,value){var block_addr,offset,store_word;block_addr=rs.block_addr(address),offset=address-block_addr,typeof DataView!="undefined"&&DataView!==null?(rs.mem_blocks[block_addr].setInt32(offset,value.getLowBits(),!0),rs.mem_blocks[block_addr].setInt32(offset+4,value.getHighBits,!0)):(store_word=function(rs_,address,word){return rs_.mem_blocks[address]=word&255,rs_.mem_blocks[address+1]=word>>>8&255,rs_.mem_blocks[address+2]=word>>>16&255,rs_.mem_blocks[address+3]=word>>>24&255},store_word(rs,address,value.getLowBits()),store_word(rs,address+4,value.getHighBits()))}),o("getByte(J)B",function(rs,_this,address){var block_addr;return block_addr=rs.block_addr(address),typeof DataView!="undefined"&&DataView!==null?rs.mem_blocks[block_addr].getInt8(address-block_addr):rs.mem_blocks[block_addr]}),o("arrayBaseOffset(Ljava/lang/Class;)I",function(rs,_this,cls){return 0}),o("arrayIndexScale(Ljava/lang/Class;)I",function(rs,_this,cls){return 1}),o("compareAndSwapObject(Ljava/lang/Object;JLjava/lang/Object;Ljava/lang/Object;)Z",unsafe_compare_and_swap),o("compareAndSwapInt(Ljava/lang/Object;JII)Z",unsafe_compare_and_swap),o("compareAndSwapLong(Ljava/lang/Object;JJJ)Z",unsafe_compare_and_swap),o("ensureClassInitialized(Ljava/lang/Class;)V",function(rs,_this,cls){return rs.class_lookup(cls.$type)}),o("staticFieldOffset(Ljava/lang/reflect/Field;)J",function(rs,_this,field){return gLong.fromNumber(field.get_field(rs,"java/lang/reflect/Field/slot"))}),o("objectFieldOffset(Ljava/lang/reflect/Field;)J",function(rs,_this,field){return gLong.fromNumber(field.get_field(rs,"java/lang/reflect/Field/slot"))}),o("staticFieldBase(Ljava/lang/reflect/Field;)Ljava/lang/Object;",function(rs,_this,field){var cls;return cls=field.get_field(rs,"java/lang/reflect/Field/clazz"),new JavaObject(rs,cls.$type,rs.class_lookup(cls.$type))}),o("getObjectVolatile(Ljava/lang/Object;J)Ljava/lang/Object;",function(rs,_this,obj,offset){return obj.get_field_from_offset(rs,offset)}),o("getObject(Ljava/lang/Object;J)Ljava/lang/Object;",function(rs,_this,obj,offset){return obj.get_field_from_offset(rs,offset)}),o("putObject(Ljava/lang/Object;JLjava/lang/Object;)V",function(rs,_this,obj,offset,new_obj){return obj.set_field_from_offset(rs,offset,new_obj)}),o("putOrderedObject(Ljava/lang/Object;JLjava/lang/Object;)V",function(rs,_this,obj,offset,new_obj){return obj.set_field_from_offset(rs,offset,new_obj)}),o("defineClass(Ljava/lang/String;[BIILjava/lang/ClassLoader;Ljava/security/ProtectionDomain;)Ljava/lang/Class;",function(rs,_this,name,bytes,offset,len,loader,pd){return native_define_class(rs,name,bytes,offset,len,loader)})]},reflect:{ConstantPool:[o("getLongAt0(Ljava/lang/Object;I)J",function(rs,_this,cp,idx){return cp.get(idx).value}),o("getUTF8At0(Ljava/lang/Object;I)Ljava/lang/String;",function(rs,_this,cp,idx){return rs.init_string(cp.get(idx).value)})],NativeMethodAccessorImpl:[o("invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;",function(rs,m,obj,params){var cls,method,my_sf,sig,slot;throw cls=m.get_field(rs,"java/lang/reflect/Method/clazz"),slot=m.get_field(rs,"java/lang/reflect/Method/slot"),method=function(){var _ref4,_results;_ref4=rs.class_lookup(cls.$type,!0).methods,_results=[];for(sig in _ref4)method=_ref4[sig],method.idx===slot&&_results.push(method);return _results}()[0],my_sf=rs.curr_frame(),method.access_flags["static"]||rs.push(obj),rs.push_array(params.array),method.setup_stack(rs),my_sf.runner=function(){var rv;return rv=rs.pop(),rs.meta_stack().pop(),rs.push(rv)},exceptions.ReturnException})],NativeConstructorAccessorImpl:[o("newInstance0(Ljava/lang/reflect/Constructor;[Ljava/lang/Object;)Ljava/lang/Object;",function(rs,m,params){var cls,method,my_sf,obj,sig,slot;throw cls=m.get_field(rs,"java/lang/reflect/Constructor/clazz"),slot=m.get_field(rs,"java/lang/reflect/Constructor/slot"),method=function(){var _ref4,_results;_ref4=rs.class_lookup(cls.$type,!0).methods,_results=[];for(sig in _ref4)method=_ref4[sig],method.idx===slot&&_results.push(method);return _results}()[0],my_sf=rs.curr_frame(),rs.push(obj=new JavaObject(rs,cls.$type,rs.class_lookup(cls.$type))),params!=null&&rs.push_array(params.array),method.setup_stack(rs),my_sf.runner=function(){return rs.meta_stack().pop(),rs.push(obj)},exceptions.ReturnException})],Reflection:[o("getCallerClass(I)Ljava/lang/Class;",function(rs,frames_to_skip){var caller,type;return caller=rs.meta_stack().get_caller(frames_to_skip),type=caller.method.class_type,rs.jclass_obj(type,!0)}),o("getClassAccessFlags(Ljava/lang/Class;)I",function(rs,class_obj){return class_obj.file.access_byte})]}}},flatten_pkg=function(pkg){var pkg_name_arr,rec_flatten,result;return result={},pkg_name_arr=[],rec_flatten=function(pkg){var flattened_inner,fn,fn_name,full_name,full_pkg_name,inner_pkg,method,pkg_name,_i,_len,_results;_results=[];for(pkg_name in pkg){inner_pkg=pkg[pkg_name],pkg_name_arr.push(pkg_name);if(inner_pkg instanceof Array){full_pkg_name=pkg_name_arr.join("/");for(_i=0,_len=inner_pkg.length;_i<_len;_i++)method=inner_pkg[_i],fn_name=method.fn_name,fn=method.fn,fn_name=fn_name.replace(/!|;/g,function(){var depth;return depth=0,function(c){return c==="!"?pkg_name_arr[depth++]:c===";"?(depth=0,c):c}}()),full_name=""+full_pkg_name+"::"+fn_name,result[full_name]=fn}else flattened_inner=rec_flatten(inner_pkg);_results.push(pkg_name_arr.pop(pkg_name))}return _results},rec_flatten(pkg),result},root.trapped_methods=flatten_pkg(trapped_methods),root.native_methods=flatten_pkg(native_methods)}.call(this),function(){var AbstractMethodField,ReturnException,attributes,c2t,carr2type,debug_vars,java_throw,logging,native_methods,natives,opcodes,root,runtime,str2type,trace,trapped_methods,types,util,vtrace,_,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};_=require("../vendor/_.js"),util=require("./util"),opcodes=require("./opcodes"),attributes=require("./attributes"),types=require("./types"),natives=require("./natives"),runtime=require("./runtime"),logging=require("./logging"),vtrace=logging.vtrace,trace=logging.trace,debug_vars=logging.debug_vars,_ref=require("./exceptions"),java_throw=_ref.java_throw,ReturnException=_ref.ReturnException,str2type=types.str2type,carr2type=types.carr2type,c2t=types.c2t,native_methods=natives.native_methods,trapped_methods=natives.trapped_methods,"use strict",root=typeof exports!="undefined"&&exports!==null?exports:this.methods={},AbstractMethodField=function(){function AbstractMethodField(class_type){this.class_type=class_type}return AbstractMethodField.prototype.parse=function(bytes_array,constant_pool,idx){return this.idx=idx,this.access_byte=bytes_array.get_uint(2),this.access_flags=util.parse_flags(this.access_byte),this.name=constant_pool.get(bytes_array.get_uint(2)).value,this.raw_descriptor=constant_pool.get(bytes_array.get_uint(2)).value,this.parse_descriptor(this.raw_descriptor),this.attrs=attributes.make_attributes(bytes_array,constant_pool)},AbstractMethodField}(),root.Field=function(_super){function Field(){return Field.__super__.constructor.apply(this,arguments)}return __extends(Field,_super),Field.prototype.parse_descriptor=function(raw_descriptor){return this.type=str2type(raw_descriptor)},Field.prototype.reflector=function(rs){var sig,_ref1;return sig=(_ref1=_.find(this.attrs,function(a){return a.name==="Signature"}))!=null?_ref1.sig:void 0,rs.init_object("java/lang/reflect/Field",{"java/lang/reflect/Field/clazz":rs.jclass_obj(this.class_type),"java/lang/reflect/Field/name":rs.init_string(this.name,!0),"java/lang/reflect/Field/type":rs.jclass_obj(this.type),"java/lang/reflect/Field/modifiers":this.access_byte,"java/lang/reflect/Field/slot":this.idx,"java/lang/reflect/Field/signature":sig!=null?rs.init_string(sig):null})},Field}(AbstractMethodField),root.Method=function(_super){function Method(){return Method.__super__.constructor.apply(this,arguments)}var padding;return __extends(Method,_super),Method.prototype.parse_descriptor=function(raw_descriptor){var field,p,param_carr,param_str,return_str,__,_i,_len,_ref1,_ref2,_ref3;_ref1=/\(([^)]*)\)(.*)/.exec(raw_descriptor),__=_ref1[0],param_str=_ref1[1],return_str=_ref1[2],param_carr=param_str.split(""),this.param_types=function(){var _results;_results=[];while(field=carr2type(param_carr))_results.push(field);return _results}(),this.param_bytes=0,_ref2=this.param_types;for(_i=0,_len=_ref2.length;_i<_len;_i++)p=_ref2[_i],this.param_bytes+=(_ref3=p+"")==="D"||_ref3==="J"?2:1;return this.access_flags["static"]||this.param_bytes++,this.num_args=this.param_types.length,this.access_flags["static"]||this.num_args++,this.return_type=str2type(return_str)},Method.prototype.full_signature=function(){return""+this.class_type.toClassString()+"::"+this.name+this.raw_descriptor},Method.prototype.parse=function(bytes_array,constant_pool,idx){var c,sig,_this=this;return Method.__super__.parse.call(this,bytes_array,constant_pool,idx),sig=this.full_signature(),(c=trapped_methods[sig])!=null?(this.code=c,this.access_flags["native"]=!0):this.access_flags["native"]?(c=native_methods[sig])!=null?this.code=c:this.code=null:(this.has_bytecode=!0,this.code=_.find(this.attrs,function(a){return a.name==="Code"}))},Method.prototype.reflector=function(rs,is_constructor){var adefs,anns,e,exceptions,f,obj,sig,typestr,_ref1,_ref2,_ref3,_ref4,_ref5;return is_constructor==null&&(is_constructor=!1),typestr=is_constructor?"java/lang/reflect/Constructor":"java/lang/reflect/Method",exceptions=(_ref1=(_ref2=_.find(this.attrs,function(a){return a.name==="Exceptions"}))!=null?_ref2.exceptions:void 0)!=null?_ref1:[],anns=(_ref3=_.find(this.attrs,function(a){return a.name==="RuntimeVisibleAnnotations"}))!=null?_ref3.raw_bytes:void 0,adefs=(_ref4=_.find(this.attrs,function(a){return a.name==="AnnotationDefault"}))!=null?_ref4.raw_bytes:void 0,sig=(_ref5=_.find(this.attrs,function(a){return a.name==="Signature"}
))!=null?_ref5.sig:void 0,obj={},obj[typestr+"/clazz"]=rs.jclass_obj(this.class_type),obj[typestr+"/name"]=rs.init_string(this.name,!0),obj[typestr+"/parameterTypes"]=rs.init_array("[Ljava/lang/Class;",function(){var _i,_len,_ref6,_results;_ref6=this.param_types,_results=[];for(_i=0,_len=_ref6.length;_i<_len;_i++)f=_ref6[_i],_results.push(rs.jclass_obj(f));return _results}.call(this)),obj[typestr+"/returnType"]=rs.jclass_obj(this.return_type),obj[typestr+"/exceptionTypes"]=rs.init_array("[Ljava/lang/Class;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=exceptions.length;_i<_len;_i++)e=exceptions[_i],_results.push(rs.jclass_obj(c2t(e)));return _results}()),obj[typestr+"/modifiers"]=this.access_byte,obj[typestr+"/slot"]=this.idx,obj[typestr+"/signature"]=sig!=null?rs.init_string(sig):null,obj[typestr+"/annotations"]=anns!=null?rs.init_array("[B",anns):null,obj[typestr+"/annotationDefault"]=adefs!=null?rs.init_array("[B",adefs):null,rs.init_object(typestr,obj)},Method.prototype.take_params=function(caller_stack){var params,start;return start=caller_stack.length-this.param_bytes,params=caller_stack.slice(start),caller_stack.length-=this.param_bytes,params},!0,Method.prototype.convert_params=function(rs,params){var converted_params,p,param_idx,_i,_len,_ref1,_ref2;converted_params=[rs],param_idx=0,this.access_flags["static"]||(converted_params.push(params[0]),param_idx=1),_ref1=this.param_types;for(_i=0,_len=_ref1.length;_i<_len;_i++)p=_ref1[_i],converted_params.push(params[param_idx]),param_idx+=(_ref2=p+"")==="J"||_ref2==="D"?2:1;return converted_params},Method.prototype.run_manually=function(func,rs,converted_params){var ret_type,rv;try{rv=func.apply(null,converted_params)}catch(e){if(e===ReturnException)return;throw e}rs.meta_stack().pop(),ret_type=this.return_type+"";if(ret_type!=="V"){ret_type==="Z"?rs.push(rv+0):rs.push(rv);if(ret_type==="J"||ret_type==="D")return rs.push(null)}},Method.prototype.run_bytecode=function(rs){try{return this.bytecode_loop(rs)}catch(e){if(e===ReturnException)return;if(typeof e.method_catch_handler=="function"?!e.method_catch_handler(rs,this,!0):!void 0)throw e;return this.run_bytecode(rs)}},Method.prototype.bytecode_loop=function(rs){var annotation,cf,code,op,pc;code=this.code.opcodes,cf=rs.curr_frame();for(;;)op=code[cf.pc],op.execute(rs)!==!1&&(cf.pc+=1+op.byte_count)},Method.prototype.setup_stack=function(runtime_state){var c_params,caller_stack,ms,params,sf,_this=this;ms=runtime_state.meta_stack(),caller_stack=runtime_state.curr_frame().stack,params=this.take_params(caller_stack);if(this.access_flags["native"]){if(this.code!=null)return ms.push(sf=new runtime.StackFrame(this,[],[])),c_params=this.convert_params(runtime_state,params),sf.runner=function(){return _this.run_manually(_this.code,runtime_state,c_params)},sf;return}return this.access_flags.abstract&&java_throw(runtime_state,"java/lang/Error","called abstract method: "+this.full_signature()),ms.push(sf=new runtime.StackFrame(this,params,[])),this.code.run_stamp<runtime_state.run_stamp&&(this.code.run_stamp=runtime_state.run_stamp,this.code.parse_code()),sf.runner=function(){return _this.run_bytecode(runtime_state)},sf},Method}(AbstractMethodField)}.call(this),function(){var ClassFile,ConstantPool,attributes,c2t,methods,opcodes,types,util;util=require("./util"),ConstantPool=require("./ConstantPool"),attributes=require("./attributes"),opcodes=require("./opcodes"),methods=require("./methods"),types=require("./types"),c2t=types.c2t,"use strict",ClassFile=function(){function ClassFile(bytes_array){var f,i,isize,m,mkey,num_fields,num_methods,super_ref,_i,_j,_len,_ref,_ref1;bytes_array=new util.BytesArray(bytes_array);if(bytes_array.get_uint(4)!==3405691582)throw"Magic number invalid";this.minor_version=bytes_array.get_uint(2),this.major_version=bytes_array.get_uint(2);if(45>(_ref=this.major_version)||_ref>51)throw"Major version invalid";this.constant_pool=new ConstantPool,this.constant_pool.parse(bytes_array),this.access_byte=bytes_array.get_uint(2),this.access_flags=util.parse_flags(this.access_byte),this.this_class=c2t(this.constant_pool.get(bytes_array.get_uint(2)).deref()),this.constant_pool.cls=this.this_class.class_name,super_ref=bytes_array.get_uint(2),super_ref!==0&&(this.super_class=c2t(this.constant_pool.get(super_ref).deref())),isize=bytes_array.get_uint(2),this.interfaces=function(){var _i,_results;_results=[];for(i=_i=0;_i<isize;i=_i+=1)_results.push(bytes_array.get_uint(2));return _results}(),num_fields=bytes_array.get_uint(2),this.fields=function(){var _i,_results;_results=[];for(i=_i=0;_i<num_fields;i=_i+=1)_results.push(new methods.Field(this.this_class));return _results}.call(this),this.fl_cache={},_ref1=this.fields;for(i=_i=0,_len=_ref1.length;_i<_len;i=++_i)f=_ref1[i],f.parse(bytes_array,this.constant_pool,i),this.fl_cache[f.name]=f;num_methods=bytes_array.get_uint(2),this.methods={},this.ml_cache={};for(i=_j=0;_j<num_methods;i=_j+=1)m=new methods.Method(this.this_class),m.parse(bytes_array,this.constant_pool,i),mkey=m.name+m.raw_descriptor,this.methods[mkey]=m,this.ml_cache[mkey]=m;this.attrs=attributes.make_attributes(bytes_array,this.constant_pool);if(bytes_array.has_bytes())throw"Leftover bytes in classfile: "+bytes_array}return ClassFile.for_array_type=function(type){var class_file;return class_file=Object.create(ClassFile.prototype),class_file.constant_pool=new ConstantPool,class_file.ml_cache={},class_file.fl_cache={},class_file.access_flags={},class_file.this_class=type,class_file.super_class=c2t("java/lang/Object"),class_file.interfaces=[],class_file.fields=[],class_file.methods={},class_file.attrs=[],class_file},ClassFile.prototype.field_lookup=function(rs,field_spec){return this.fl_cache[field_spec.name]==null&&(this.fl_cache[field_spec.name]=this._field_lookup(rs,field_spec)),this.fl_cache[field_spec.name]},ClassFile.prototype._field_lookup=function(rs,field_spec){var field,i,ifc_cls,sc,_i,_j,_len,_len1,_ref,_ref1;_ref=this.fields;for(_i=0,_len=_ref.length;_i<_len;_i++){field=_ref[_i];if(field.name===field_spec.name)return field}_ref1=this.interfaces;for(_j=0,_len1=_ref1.length;_j<_len1;_j++){i=_ref1[_j],ifc_cls=rs.class_lookup(c2t(this.constant_pool.get(i).deref())),field=ifc_cls.field_lookup(rs,field_spec);if(field!=null)return field}if(this.super_class!=null){sc=rs.class_lookup(this.super_class),field=sc.field_lookup(rs,field_spec);if(field!=null)return field}return null},ClassFile.prototype.method_lookup=function(rs,method_spec){return this.ml_cache[method_spec.sig]==null&&(this.ml_cache[method_spec.sig]=this._method_lookup(rs,method_spec)),this.ml_cache[method_spec.sig]},ClassFile.prototype._method_lookup=function(rs,method_spec){var i,ifc,method,parent,_i,_len,_ref;method=this.methods[method_spec.sig];if(method!=null)return method;if(this.super_class!=null){parent=rs.class_lookup(this.super_class),method=parent.method_lookup(rs,method_spec);if(method!=null)return method}_ref=this.interfaces;for(_i=0,_len=_ref.length;_i<_len;_i++){i=_ref[_i],ifc=rs.class_lookup(c2t(this.constant_pool.get(i).deref())),method=ifc.method_lookup(rs,method_spec);if(method!=null)return method}return null},ClassFile.prototype.construct_default_fields=function(rs){var cls,f,t,val,_i,_len,_ref,_results;t=this.this_class,this.default_fields=Object.create(null),_results=[];while(t!=null){cls=rs.class_lookup(t),_ref=cls.fields;for(_i=0,_len=_ref.length;_i<_len;_i++){f=_ref[_i];if(!!f.access_flags["static"])continue;val=util.initial_value(f.raw_descriptor),this.default_fields[t.toClassString()+"/"+f.name]=val}_results.push(t=cls.super_class)}return _results},ClassFile.prototype.get_default_fields=function(rs){return this.default_fields!==void 0?this.default_fields:(this.construct_default_fields(rs),this.default_fields)},ClassFile}(),typeof module!="undefined"&&module!==null?module.exports=ClassFile:window.ClassFile=ClassFile}.call(this),function(){var ClassFile,ClassState,JavaArray,JavaClassObject,JavaObject,Method,ReturnException,YieldIOException,c2t,debug,error,gLong,java_throw,log,root,thread_name,trace,types,util,vtrace,_,_ref,_ref1,_ref2,_ref3,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};root=typeof exports!="undefined"&&exports!==null?exports:(_ref=window.runtime)!=null?_ref:window.runtime={},_=require("../vendor/_.js"),gLong=require("../vendor/gLong.js"),util=require("./util"),types=require("./types"),ClassFile=require("./ClassFile"),_ref1=require("./logging"),log=_ref1.log,vtrace=_ref1.vtrace,trace=_ref1.trace,debug=_ref1.debug,error=_ref1.error,_ref2=require("./exceptions"),java_throw=_ref2.java_throw,YieldIOException=_ref2.YieldIOException,ReturnException=_ref2.ReturnException,_ref3=require("./java_object"),JavaObject=_ref3.JavaObject,JavaClassObject=_ref3.JavaClassObject,JavaArray=_ref3.JavaArray,thread_name=_ref3.thread_name,c2t=types.c2t,Method=require("./methods").Method,"use strict",root.CallStack=function(){function CallStack(initial_stack){this._cs=[root.StackFrame.fake_frame("$bootstrap")],initial_stack!=null&&(this._cs[0].stack=initial_stack)}return CallStack.prototype.length=function(){return this._cs.length},CallStack.prototype.push=function(sf){return this._cs.push(sf)},CallStack.prototype.pop=function(){return this._cs.pop()},CallStack.prototype.curr_frame=function(){return util.last(this._cs)},CallStack.prototype.get_caller=function(frames_to_skip){return this._cs[this._cs.length-1-frames_to_skip]},CallStack}(),root.StackFrame=function(){function StackFrame(method,locals,stack){this.method=method,this.locals=locals,this.stack=stack,this.pc=0,this.runner=null,this.name=this.method.full_signature()}return StackFrame.fake_frame=function(name){var sf;return sf=new root.StackFrame(new Method(c2t(name)),[],[]),sf.fake=!0,sf},StackFrame}(),ClassState=function(){function ClassState(loader){this.loader=loader,this.fields=null}return ClassState}(),root.RuntimeState=function(){function RuntimeState(print,async_input,read_classfile){this.print=print,this.async_input=async_input,this.read_classfile=read_classfile,this.startup_time=gLong.fromNumber((new Date).getTime()),this.run_stamp=++run_count,this.class_states=Object.create(null),this.class_states.$bootstrap=new ClassState(null),this.jclass_obj_pool=Object.create(null),this.loaded_classes=Object.create(null),this.mem_start_addrs=[1],this.mem_blocks={},this.high_oref=1,this.string_pool=new util.SafeMap,this.lock_refs={},this.lock_counts={},this.waiting_threads={},this.thread_pool=[],this.curr_thread={$meta_stack:new root.CallStack}}var run_count;return run_count=0,RuntimeState.prototype.init_threads=function(){var group,my_sf,_this=this;return my_sf=this.curr_frame(),this.push(group=this.init_object("java/lang/ThreadGroup")),this.method_lookup({"class":"java/lang/ThreadGroup",sig:"<init>()V"}).setup_stack(this),my_sf.runner=function(){var ct;return ct=null,my_sf.runner=function(){my_sf.runner=null,ct.$meta_stack=_this.meta_stack(),_this.curr_thread=ct,_this.curr_thread.$isAlive=!0,_this.thread_pool.push(_this.curr_thread),_this.class_states["java/lang/Thread"].fields.threadInitNumber=1;return},ct=_this.init_object("java/lang/Thread",{"java/lang/Thread/name":_this.init_carr("main"),"java/lang/Thread/priority":1,"java/lang/Thread/group":group,"java/lang/Thread/threadLocals":null})}},RuntimeState.prototype.meta_stack=function(){return this.curr_thread.$meta_stack},RuntimeState.prototype.init_system_class=function(){var my_sf;return my_sf=this.curr_frame(),this.class_lookup(c2t("java/lang/System")).methods["initializeSystemClass()V"].setup_stack(this),my_sf.runner=function(){my_sf.runner=null,this.system_initialized=!0;return}},RuntimeState.prototype.init_args=function(initial_args){var a,args;args=new JavaArray(this,c2t("[Ljava/lang/String;"),function(){var _i,_len,_results;_results=[];for(_i=0,_len=initial_args.length;_i<_len;_i++)a=initial_args[_i],_results.push(this.init_string(a));return _results}.call(this)),this.curr_thread.$meta_stack=new root.CallStack([args]);return},RuntimeState.prototype.show_state=function(){var cf,l,s,x;cf=this.curr_frame();if(cf!=null){s=function(){var _i,_len,_ref4,_results;_ref4=cf.stack,_results=[];for(_i=0,_len=_ref4.length;_i<_len;_i++)x=_ref4[_i],_results.push((x!=null?x.ref:void 0)!=null?x.ref:x);return _results}(),l=function(){var _i,_len,_ref4,_results;_ref4=cf.locals,_results=[];for(_i=0,_len=_ref4.length;_i<_len;_i++)x=_ref4[_i],_results.push((x!=null?x.ref:void 0)!=null?x.ref:x);return _results}();return}return},RuntimeState.prototype.choose_next_thread=function(blacklist){var b,bl,key,t,_i,_j,_len,_len1,_ref4,_ref5;if(blacklist==null){blacklist=[],_ref4=this.waiting_threads;for(key in _ref4){bl=_ref4[key];for(_i=0,_len=bl.length;_i<_len;_i++)b=bl[_i],blacklist.push(b)}}_ref5=this.thread_pool;for(_j=0,_len1=_ref5.length;_j<_len1;_j++){t=_ref5[_j];if(t===this.curr_thread||!t.$isAlive)continue;if(__indexOf.call(blacklist,t)<0)return t;continue}return this.curr_thread},RuntimeState.prototype.wait=function(monitor,yieldee){return this.waiting_threads[monitor]!=null?this.waiting_threads[monitor].push(this.curr_thread):this.waiting_threads[monitor]=[this.curr_thread],yieldee==null&&(yieldee=this.choose_next_thread(this.waiting_threads[monitor])),this.yield(yieldee)},RuntimeState.prototype.yield=function(yieldee){var new_thread_sf,old_thread_sf,_this=this;throw yieldee==null&&(yieldee=this.choose_next_thread()),old_thread_sf=this.curr_frame(),this.curr_thread=yieldee,new_thread_sf=this.curr_frame(),new_thread_sf.runner=function(){return _this.meta_stack().pop()},old_thread_sf.runner=function(){return _this.meta_stack().pop()},ReturnException},RuntimeState.prototype.curr_frame=function(){return this.meta_stack().curr_frame()},RuntimeState.prototype.cl=function(idx){return this.curr_frame().locals[idx]},RuntimeState.prototype.put_cl=function(idx,val){return this.curr_frame().locals[idx]=val},RuntimeState.prototype.put_cl2=function(idx,val){return this.put_cl(idx,val),!0},RuntimeState.prototype.push=function(arg){return this.curr_frame().stack.push(arg)},RuntimeState.prototype.push2=function(arg1,arg2){return this.curr_frame().stack.push(arg1,arg2)},RuntimeState.prototype.push_array=function(args){var cs;return cs=this.curr_frame().stack,Array.prototype.push.apply(cs,args)},RuntimeState.prototype.pop=function(){return this.curr_frame().stack.pop()},RuntimeState.prototype.pop2=function(){return this.pop(),this.pop()},RuntimeState.prototype.curr_pc=function(){return this.curr_frame().pc},RuntimeState.prototype.goto_pc=function(pc){return this.curr_frame().pc=pc},RuntimeState.prototype.inc_pc=function(n){return this.curr_frame().pc+=n},RuntimeState.prototype.check_null=function(obj){return obj==null&&java_throw(this,"java/lang/NullPointerException",""),obj},RuntimeState.prototype.heap_newarray=function(type,len){var i;return len<0&&java_throw(this,"java/lang/NegativeArraySizeException","Tried to init ["+type+" array with length "+len),type==="J"?new JavaArray(this,c2t("[J"),function(){var _i,_results;_results=[];for(i=_i=0;_i<len;i=_i+=1)_results.push(gLong.ZERO);return _results}()):type[0]==="L"?new JavaArray(this,c2t("["+type),function(){var _i,_results;_results=[];for(i=_i=0;_i<len;i=_i+=1)_results.push(null);return _results}()):new JavaArray(this,c2t("["+type),function(){var _i,_results;_results=[];for(i=_i=0;_i<len;i=_i+=1)_results.push(0);return _results}())},RuntimeState.prototype.static_get=function(field_spec){var f,_base,_name,_ref4;return f=this.field_lookup(field_spec),(_ref4=(_base=this.class_states[f.class_type.toClassString()].fields)[_name=f.name])!=null?_ref4:_base[_name]=util.initial_value(f.raw_descriptor)},RuntimeState.prototype.static_put=function(field_spec){var f,val,_ref4;return val=(_ref4=field_spec.type)==="J"||_ref4==="D"?this.pop2():this.pop(),f=this.field_lookup(field_spec),this.class_states[f.class_type.toClassString()].fields[f.name]=val},RuntimeState.prototype.init_object=function(cls,obj){var type;return type=c2t(cls),new JavaObject(this,type,this.class_lookup(type),obj)},RuntimeState.prototype.init_array=function(cls,obj){var type;return type=c2t(cls),new JavaArray(this,type,obj)},RuntimeState.prototype.init_string=function(str,intern){var carr,jvm_str,s,type;return intern==null&&(intern=!1),intern&&(s=this.string_pool.get(str))!=null?s:(carr=this.init_carr(str),type=c2t("java/lang/String"),jvm_str=new JavaObject(this,type,this.class_lookup(type),{"java/lang/String/value":carr,"java/lang/String/count":str.length}),intern&&this.string_pool.set(str,jvm_str),jvm_str)},RuntimeState.prototype.init_carr=function(str){var i;return new JavaArray(this,c2t("[C"),function(){var _i,_ref4,_results;_results=[];for(i=_i=0,_ref4=str.length;_i<_ref4;i=_i+=1)_results.push(str.charCodeAt(i));return _results}())},RuntimeState.prototype.jclass_obj=function(type,dyn){var etype,file,jco;return dyn==null&&(dyn=!1),jco=this.jclass_obj_pool[type],jco==="not found"?(etype=dyn?"ClassNotFoundException":"NoClassDefFoundError",java_throw(this,"java/lang/"+etype,type.toClassString())):jco===void 0&&(this.jclass_obj_pool[type]="not found",file=type instanceof types.PrimitiveType?null:this.load_class(type,dyn),this.jclass_obj_pool[type]=jco=new JavaClassObject(this,type,file)),jco},RuntimeState.prototype.load_class=function(type,dyn){var class_file,cls,defining_class,defining_class_loader,msg,wrong_name,_ref4;cls=type.toClassString();if(this.loaded_classes[cls]==null)if(type instanceof types.ArrayType)this.loaded_classes[cls]=ClassFile.for_array_type(type),type.component_type instanceof types.PrimitiveType?this.class_states[cls]=new ClassState(null):(this.load_class(type.component_type,dyn),this.class_states[cls]=new ClassState(this.class_states[type.component_type.toClassString()].loader));else{defining_class=this.curr_frame().method.class_type.toClassString(),defining_class_loader=(_ref4=this.class_states[defining_class])!=null?_ref4.loader:void 0;if(defining_class_loader!=null){this.meta_stack().push(root.StackFrame.fake_frame("custom_class_loader")),this.push2(defining_class_loader,this.init_string(util.ext_classname(cls))),this.method_lookup({"class":defining_class_loader.type.toClassString(),sig:"loadClass(Ljava/lang/String;)Ljava/lang/Class;"}).setup_stack(this);if(!this.run_until_finished(function(){},function(){},!0))throw"Error in class initialization";this.meta_stack().pop()}else{this.class_states[cls]=new ClassState(null),class_file=this.read_classfile(cls);if(class_file==null||(wrong_name=class_file.this_class.toClassString()!==cls))msg=cls,wrong_name&&(msg+=" (wrong name: "+class_file.this_class.toClassString()+")"),dyn?java_throw(this,"java/lang/ClassNotFoundException",msg):java_throw(this,"java/lang/NoClassDefFoundError",msg);this.loaded_classes[cls]=class_file}}return this.loaded_classes[cls]},RuntimeState.prototype.class_lookup=function(type,dyn){var c,class_file,cls,component,_ref4;type instanceof types.Type||!0,type instanceof types.PrimitiveType&&!0,class_file=this.load_class(type,dyn),cls=type.toClassString();if(this.class_states[cls].fields==null){this.class_states[cls].fields=Object.create(null);if(type instanceof types.ArrayType)component=type.component_type,(component instanceof types.ArrayType||component instanceof types.ClassType)&&this.class_lookup(component,dyn);else{c=this.class_states[cls],class_file.super_class&&this.class_lookup(class_file.super_class,dyn),this.meta_stack().push(root.StackFrame.fake_frame("class_lookup")),(_ref4=class_file.methods["<clinit>()V"])!=null&&_ref4.setup_stack(this);if(!this.run_until_finished(function(){},function(){},!0))throw"Error in class initialization";this.meta_stack().pop()}}return class_file},RuntimeState.prototype.define_class=function(cls,data,loader){var class_file,type;return class_file=new ClassFile(data),this.class_states[cls]=new ClassState(loader),class_file.super_class&&this.class_lookup(class_file.super_class),this.loaded_classes[cls]=class_file,type=c2t(cls),this.jclass_obj_pool[type]=new JavaClassObject(this,type,class_file)},RuntimeState.prototype.method_lookup=function(method_spec){var cls,method,type;return type=c2t(method_spec["class"]),cls=this.class_lookup(type),method=cls.method_lookup(this,method_spec),method!=null?method:java_throw(this,"java/lang/NoSuchMethodError","No such method found in "+method_spec["class"]+": "+method_spec.sig)},RuntimeState.prototype.field_lookup=function(field_spec){var cls,field;return cls=this.class_lookup(c2t(field_spec["class"])),field=cls.field_lookup(this,field_spec),field!=null?field:java_throw(this,"java/lang/NoSuchFieldError","No such field found in "+field_spec["class"]+": "+field_spec.name)},RuntimeState.prototype.block_addr=function(address){var addr,block_addr,_i,_len,_ref4;address=address.toNumber();if(typeof DataView!="undefined"&&DataView!==null){block_addr=this.mem_start_addrs[0],_ref4=this.mem_start_addrs.slice(1);for(_i=0,_len=_ref4.length;_i<_len;_i++){addr=_ref4[_i];if(address<addr)return block_addr;block_addr=addr}}else if(this.mem_blocks[address]!=null)return address;return!0},RuntimeState.prototype.handle_toplevel_exception=function(e,done_cb,no_threads){var _this=this;return e.toplevel_catch_handler!=null?this.run_until_finished(function(){return e.toplevel_catch_handler(_this)},done_cb,no_threads):(error("\nInternal JVM Error:",e),(e!=null?e.stack:void 0)!=null&&error(e.stack),this.show_state(),typeof done_cb=="function"&&done_cb()),!1},RuntimeState.prototype.run_until_finished=function(setup_fn,done_cb,no_threads){var retval,sf,tos,_this=this;no_threads==null&&(no_threads=!1);try{setup_fn();for(;;){sf=this.curr_frame();while(sf.runner!=null)sf.runner(),sf=this.curr_frame();if(no_threads||this.thread_pool.length<=1)break;this.curr_thread.$isAlive=!1,this.thread_pool.splice(this.thread_pool.indexOf(this.curr_thread),1),this.curr_thread=this.choose_next_thread()}return typeof done_cb=="function"&&done_cb(),!0}catch(e){if(e==="Error in class initialization")return!1;if(e===ReturnException)return this.run_until_finished(function(){},done_cb,no_threads);if(e instanceof YieldIOException)return retval=null,e.condition(function(){return retval=_this.run_until_finished(function(){},done_cb,no_threads)}),retval;if(e.method_catch_handler!=null&&this.meta_stack().length()>1){tos=!0;while(!e.method_catch_handler(this,this.curr_frame().method,tos)){tos=!1;if(this.meta_stack().length()===1)return this.handle_toplevel_exception(e,done_cb,no_threads);this.meta_stack().pop()}return this.run_until_finished(function(){},done_cb,no_threads)}while(this.meta_stack().length()>1)this.meta_stack().pop();return this.handle_toplevel_exception(e,done_cb,no_threads)}},RuntimeState}()}.call(this),function(){var ClassFile,fs,root,util,_ref;require("./runtime"),util=require("./util"),ClassFile=require("../src/ClassFile"),fs=(_ref=typeof node!=="undefined"&&node!==null?node.fs:void 0)!=null?_ref:require("fs"),"use strict",root=typeof exports!="undefined"&&exports!==null?exports:this.jvm={},root.classpath=[],root.jspath=[],root.read_classfile=function(cls){var data,filename,p,_i,_j,_len,_len1,_ref1,_ref2;_ref1=root.jspath;for(_i=0,_len=_ref1.length;_i<_len;_i++){p=_ref1[_i],filename=""+p+"/"+cls+".js";if(!fs.existsSync(filename))continue;return require("../"+filename)}_ref2=root.classpath;for(_j=0,_len1=_ref2.length;_j<_len1;_j++){p=_ref2[_j],filename=""+p+"/"+cls+".class";if(!fs.existsSync(filename))continue;data=util.bytestr_to_array(fs.readFileSync(filename,"binary"));if(data!=null)return new ClassFile(data)}},root.run_class=function(rs,class_name,cmdline_args,done_cb){var main_method,main_spec;if(!rs.run_until_finished(function(){return rs.init_threads()},function(){},!0))return;if(rs.system_initialized==null&&!rs.run_until_finished(function(){return rs.init_system_class()},function(){},!0))return;main_spec={"class":class_name,sig:"main([Ljava/lang/String;)V"},rs.init_args(cmdline_args),main_method=null;if(!rs.run_until_finished(function(){return main_method=rs.method_lookup(main_spec)},function(){},!0))return;return done_cb==null&&(done_cb=function(){}),rs.run_until_finished(function(){return main_method.setup_stack(rs)},done_cb)}}.call(this),function(){var ClassFile,RuntimeState,cleandiff,disassemble,fs,jvm,path,root,run_disasm_test,run_stdout_test,sanitize,util,_ref,_ref1,_ref2;jvm=require("./jvm"),RuntimeState=require("./runtime").RuntimeState,util=require("./util"),disassemble=require("./disassembler").disassemble,ClassFile=require("./ClassFile"),fs=(_ref=typeof node!=="undefined"&&node!==null?node.fs:void 0)!=null?_ref:require("fs"),path=(_ref1=typeof node!=="undefined"&&node!==null?node.path:void 0)!=null?_ref1:require("path"),"use strict",root=typeof exports!="undefined"&&exports!==null?exports:(_ref2=window.testing)!=null?_ref2:window.testing={},root.find_test_classes=function(doppio_dir){var file,test_dir,_i,_len,_ref3,_results;test_dir=path.resolve(doppio_dir,"classes/test"),_ref3=fs.readdirSync(test_dir),_results=[];for(_i=0,_len=_ref3.length;_i<_len;_i++)file=_ref3[_i],path.extname(file)===".java"&&_results.push("classes/test/"+path.basename(file,".java"));return _results},root.run_tests=function(test_classes,stdout,hide_diffs,quiet,keep_going,callback){var doppio_dir,jcl_dir,tc,_runner;return doppio_dir=typeof node!="undefined"&&node!==null?"/home/doppio/":path.resolve(__dirname,".."),(test_classes!=null?test_classes.length:void 0)>0?test_classes=function(){var _i,_len,_results;_results=[];for(_i=0,_len=test_classes.length;_i<_len;_i++)tc=test_classes[_i],_results.push(tc.replace(/\.class$/,""));return _results}():test_classes=root.find_test_classes(doppio_dir),jcl_dir=path.resolve(doppio_dir,"vendor/classes"),jvm.classpath=[doppio_dir,jcl_dir],_runner=function(){var disasm_diff,test;if(test_classes.length===0)return quiet||keep_going||stdout("Pass\n"),callback(!1);test=test_classes.shift(),quiet||stdout("testing "+test+"...\n");if((disasm_diff=run_disasm_test(doppio_dir,test))!=null){stdout("Failed disasm test "+test+"\n"),hide_diffs||stdout(""+disasm_diff+"\n");if(!keep_going)return callback(!0)}return run_stdout_test(doppio_dir,test,function(diff){if(diff!=null){stdout("Failed output test "+test+"\n"),hide_diffs||stdout(""+diff+"\n");if(!keep_going)return callback(!0)}return _runner()})},_runner()},sanitize=function(str){return str.replace(/\/\/.*/g,"").replace(/^\s*$[\n\r]+/mg,"").replace(/(float|double)\t.*/g,"$1").replace(/[ \t\r]+/g," ").replace(/[ ]\n/g,"\n").replace(/\[ \]/g,"[]")},run_disasm_test=function(doppio_dir,test_class){var bytes_array,doppio_disasm,javap_disasm,test_path;return test_path=path.resolve(doppio_dir,test_class),javap_disasm=sanitize(fs.readFileSync(""+test_path+".disasm","utf8")),bytes_array=util.bytestr_to_array(fs.readFileSync(""+test_path+".class","binary")),doppio_disasm=sanitize(disassemble(new ClassFile(bytes_array))),cleandiff(doppio_disasm,javap_disasm)},run_stdout_test=function(doppio_dir,test_class,callback){var doppio_output,java_output,rs,stdout;return java_output=fs.readFileSync(""+path.resolve(doppio_dir,test_class)+".runout","utf8"),doppio_output="",stdout=function(str){return doppio_output+=str},rs=new RuntimeState(stdout,function(){},jvm.read_classfile),jvm.run_class(rs,test_class,[],function(){return callback(cleandiff(doppio_output,java_output))})},cleandiff=function(our_str,their_str){var diff,extra,oidx,our_lines,their_lines,tidx,_i,_j,_len,_len1,_ref3,_ref4,_ref5;our_lines=our_str.split(/\n/),their_lines=their_str.split(/\n/),_ref3=[0,0],oidx=_ref3[0],tidx=_ref3[1],diff=[];while(oidx<our_lines.length&&tidx<their_lines.length){if(our_lines[oidx++]===their_lines[tidx++])continue;diff.push("D:"+our_lines[oidx-1]+"\nJ:"+their_lines[tidx-1])}_ref4=our_lines.slice(oidx);for(_i=0,_len=_ref4.length;_i<_len;_i++)extra=_ref4[_i],diff.push("D:"+extra);_ref5=their_lines.slice(tidx);for(_j=0,_len1=_ref5.length;_j<_len1;_j++)extra=_ref5[_j],diff.push("J:"+extra);if(diff.length>0)return diff.join("\n")}}.call(this),function(){var asyncExecute,data,fs,octal2num,root,shift_file,util,_ref;root=this,util=require("../src/util"),asyncExecute=(_ref=this.asyncExecute)!=null?_ref:require("./util").asyncExecute,"use strict",root.untar=function(bytes,cb,done_cb){var next_file;return next_file=function(){var body,path,percent,_ref1;return _ref1=shift_file(bytes),path=_ref1[0],body=_ref1[1],percent=bytes.pos()/bytes.size(),cb(percent,path,body),bytes.peek()!==0?asyncExecute(next_file):typeof done_cb=="function"?done_cb():void 0},asyncExecute(next_file,0)},shift_file=function(bytes){var body,file,fname,fullname,header,prefix,size;return header=bytes.read(512),fname=util.bytes2str(header.slice(0,100)),size=octal2num(header.slice(124,135)),prefix=util.bytes2str(header.slice(345,500)),fullname=prefix?""+prefix+"/"+fname:fname,body=bytes.read(Math.ceil(size/512)*512),file=body.slice(0,size),[fullname,file]},octal2num=function(bytes){var b,digit,idx,msd,num,_i,_len;num=0,msd=bytes.length-1;for(idx=_i=0,_len=bytes.length;_i<_len;idx=++_i)b=bytes[idx],digit=parseInt(String.fromCharCode(b)),num+=digit*Math.pow(8,msd-idx);return num},typeof module!="undefined"&&module!==null&&!module.parent&&(fs=require("fs"),data=new util.BytesArray(util.bytestr_to_array(fs.readFileSync("/dev/stdin","binary"))),root.untar(data,function(percent,path,file){return console.log(path)}))}.call(this),function($){$.fn.console=function(config){function newPromptBox(){typeof extern.onreprompt=="function"&&extern.onreprompt(),column=0,promptText="",ringn=0,enableInput(),promptBox=$('<div class="jquery-console-prompt-box"></div>');var label=$('<span class="jquery-console-prompt-label"></span>'),labelText=extern.continuedPrompt?extern.continuedPromptLabel:extern.promptLabel;if(lastMsg){var text=lastMsg.text();if(_.last(text)!=="\n"){var lines=text.split("\n");labelText=_.last(lines)+labelText,lines.length--,lastMsg.text(lines.join("\n"))}}promptBox.append(label.text(labelText).show()),label.html(label.html().replace(" ","&nbsp;")),prompt=$('<span class="jquery-console-prompt"></span>'),promptBox.append(prompt),inner.append(promptBox),updatePromptDisplay(),lastMsg=null}function isIgnorableKey(e){return(e.keyCode==9||e.keyCode==192)&&e.altKey}function rotateHistory(n){if(history.length==0)return;ringn+=n,ringn<0?ringn=history.length:ringn>history.length&&(ringn=0);var prevText=promptText;ringn==0?promptText=restoreText:promptText=history[ringn-1],config.historyPreserveColumn?promptText.length<column+1?column=promptText.length:column==0&&(column=promptText.length):column=promptText.length,updatePromptDisplay()}function previousHistory(){rotateHistory(-1)}function nextHistory(){rotateHistory(1)}function addToHistory(line){history.push(line),restoreText=""}function deleteCharAtPos(){return column<promptText.length?(promptText=promptText.substring(0,column)+promptText.substring(column+1),restoreText=promptText,!0):!1}function backDelete(){moveColumn(-1)&&(deleteCharAtPos(),updatePromptDisplay())}function forwardDelete(){promptText.length==0?extern.commandHandle&&extern.commandHandle("\0"):deleteCharAtPos()&&updatePromptDisplay()}function deleteUntilEnd(){while(deleteCharAtPos())updatePromptDisplay()}function deleteNextWord(){while(column<promptText.length&&!isCharAlphanumeric(promptText[column]))deleteCharAtPos(),updatePromptDisplay();while(column<promptText.length&&isCharAlphanumeric(promptText[column]))deleteCharAtPos(),updatePromptDisplay()}function commandTrigger(){var line=promptText;if(typeof config.commandValidate=="function"){var ret=config.commandValidate(line);ret==1||ret==0?ret&&handleCommand():commandResult(ret,"jquery-console-message-error")}else handleCommand()}function scrollToBottom(){jQuery.fn.jquery>"1.6"?inner.prop({scrollTop:inner.prop("scrollHeight")}):inner.attr({scrollTop:inner.attr("scrollHeight")})}function cancelExecution(){typeof config.cancelHandle=="function"&&config.cancelHandle()}function handleCommand(){if(typeof extern.commandHandle=="function"){disableInput(),addToHistory(promptText);var text=promptText;extern.continuedPrompt?continuedText?continuedText+="\n"+promptText:continuedText=promptText:continuedText=undefined,continuedText&&(text=continuedText);var ret=extern.commandHandle(text);extern.continuedPrompt&&!continuedText&&(continuedText=promptText);if(ret===null)return;typeof ret=="boolean"?ret?commandResult():commandResult("Command failed.","jquery-console-message-error"):typeof ret=="string"?commandResult(ret,"jquery-console-message-success"):typeof ret=="object"&&ret.length?commandResult(ret):extern.continuedPrompt&&commandResult()}}function disableInput(){acceptInput=!1}function enableInput(){acceptInput=!0}function commandResult(msg,className,noreprompt){column=-1,updatePromptDisplay(),typeof msg=="string"?message(msg
,className,noreprompt):$.isArray(msg)?message(msg[0],type2css[msg[1]]):inner.append(msg),noreprompt||newPromptBox()}function message(msg,className,noreprompt){noreprompt?(lastMsg||(lastMsg=$('<div class="jquery-console-message"></div>')),lastMsg.text(lastMsg.text()+msg),lastMsg.hide(),inner.append(lastMsg),lastMsg.show()):(mesg=$('<div class="jquery-console-message"></div>'),className&&mesg.addClass(className),mesg.text(msg),mesg.hide(),inner.append(mesg),mesg.show()),scrollToBottom()}function moveColumn(n){return column+n<0||column+n>promptText.length?!1:(column+=n,!0)}function moveForward(){return moveColumn(1)?(updatePromptDisplay(),!0):!1}function moveBackward(){return moveColumn(-1)?(updatePromptDisplay(),!0):!1}function moveToStart(){moveColumn(-column)&&updatePromptDisplay()}function moveToEnd(){moveColumn(promptText.length-column)&&updatePromptDisplay()}function moveToNextWord(){while(column<promptText.length&&!isCharAlphanumeric(promptText[column])&&moveForward());while(column<promptText.length&&isCharAlphanumeric(promptText[column])&&moveForward());}function moveToPreviousWord(){while(column-1>=0&&!isCharAlphanumeric(promptText[column-1])&&moveBackward());while(column-1>=0&&isCharAlphanumeric(promptText[column-1])&&moveBackward());}function isCharAlphanumeric(charToTest){if(typeof charToTest=="string"){var code=charToTest.charCodeAt();return code>="A".charCodeAt()&&code<="Z".charCodeAt()||code>="a".charCodeAt()&&code<="z".charCodeAt()||code>="0".charCodeAt()&&code<="9".charCodeAt()}return!1}function doNothing(){}function tabComplete(){if(config.tabComplete)return config.tabComplete()}function updatePromptDisplay(){var line=promptText,html="";if(column>0&&line=="")html=cursor;else if(column==promptText.length)html=htmlEncode(line)+cursor;else{var before=line.substring(0,column),current=line.substring(column,column+1);current&&(current='<span class="jquery-console-cursor">'+htmlEncode(current)+"</span>");var after=line.substring(column+1);html=htmlEncode(before)+current+htmlEncode(after)}prompt.html(html),scrollToBottom()}function htmlEncode(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br />")}config===undefined&&(config={});var extern={},keyCodes={37:moveBackward,39:moveForward,38:previousHistory,40:nextHistory,8:backDelete,9:tabComplete,46:forwardDelete,35:moveToEnd,36:moveToStart,13:commandTrigger,18:doNothing},ctrlCodes={65:moveToStart,68:forwardDelete,69:moveToEnd,78:nextHistory,80:previousHistory,66:moveBackward,70:moveForward,75:deleteUntilEnd},altCodes={70:moveToNextWord,66:moveToPreviousWord,68:deleteNextWord},cursor='<span class="jquery-console-cursor">&nbsp;</span>',container=$(this),inner=$('<pre class="jquery-console-inner"></pre>'),typer=$('<textarea class="jquery-console-typer"></textarea>'),promptBox,prompt;extern.promptLabel=config.promptLabel?config.promptLabel:"> ",extern.continuedPromptLabel=config.continuedPromptLabel?config.continuedPromptLabel:"> ";var column=0,promptText="",restoreText="",continuedText="",history=[],ringn=0,cancelKeyPress=0,acceptInput=!0,cancelCommand=!1;extern.commandHandle=config.commandHandle;var lastMsg=null;(function(){container.append(inner),inner.append(typer),typer.css({position:"absolute",top:0,left:"-9999px"}),config.welcomeMessage&&message(config.welcomeMessage,"jquery-console-welcome"),newPromptBox(),config.autofocus&&(inner.addClass("jquery-console-focus"),typer.focus(),setTimeout(function(){inner.addClass("jquery-console-focus"),typer.focus()},100)),extern.inner=inner,extern.typer=typer,extern.scrollToBottom=scrollToBottom})(),extern.reset=function(){var welcome=typeof config.welcomeMessage!="undefined";inner.parent().fadeOut(function(){inner.find("div").each(function(){welcome?welcome=!1:$(this).remove()}),newPromptBox(),inner.parent().fadeIn(function(){inner.addClass("jquery-console-focus"),typer.focus()})})},extern.notice=function(msg,style){var n=$('<div class="notice"></div>').append($("<div></div>").text(msg)).css({visibility:"hidden"});container.append(n);var focused=!0;if(style=="fadeout")setTimeout(function(){n.fadeOut(function(){n.remove()})},4e3);else if(style=="prompt"){var a=$('<br/><div class="action"><a href="javascript:">OK</a><div class="clear"></div></div>');n.append(a),focused=!1,a.click(function(){n.fadeOut(function(){n.remove(),inner.css({opacity:1})})})}var h=n.height();return n.css({height:"0px",visibility:"visible"}).animate({height:h+"px"},function(){focused||inner.css({opacity:.5})}),n.css("cursor","default"),n},container.click(function(){return inner.addClass("jquery-console-focus"),inner.removeClass("jquery-console-nofocus"),typer.focus(),scrollToBottom(),!1}),typer.blur(function(){inner.removeClass("jquery-console-focus"),inner.addClass("jquery-console-nofocus")}),typer.bind("paste",function(e){typer.val(""),setTimeout(function(){typer.consoleInsert(typer.val()),typer.val("")},0)}),typer.keydown(function(e){cancelKeyPress=0;var keyCode=e.keyCode;if(e.ctrlKey&&keyCode==67)return cancelKeyPress=keyCode,cancelExecution(),!1;if(acceptInput){if(keyCode in keyCodes)return cancelKeyPress=keyCode,keyCodes[keyCode](),!1;if(e.ctrlKey&&keyCode in ctrlCodes)return cancelKeyPress=keyCode,ctrlCodes[keyCode](),!1;if(e.altKey&&keyCode in altCodes)return cancelKeyPress=keyCode,altCodes[keyCode](),!1}}),typer.keypress(function(e){var keyCode=e.keyCode||e.which;if(isIgnorableKey(e))return!1;if(e.ctrlKey&&String.fromCharCode(keyCode).toLowerCase()=="v")return!0;if(acceptInput&&cancelKeyPress!=keyCode&&keyCode>=32){if(cancelKeyPress)return!1;(typeof config.charInsertTrigger=="undefined"||typeof config.charInsertTrigger=="function"&&config.charInsertTrigger(keyCode,promptText))&&typer.consoleInsert(keyCode)}if($.browser.webkit||$.browser.opera)return!1});var type2css={success:"jquery-console-message-success",error:"jquery-console-message-error"};return extern.message=function(msg,type,noreprompt){commandResult(msg,type2css[type],noreprompt)},extern.reprompt=function(){commandResult()},typer.consoleInsert=function(data){var text=isNaN(data)?data:String.fromCharCode(data),before=promptText.substring(0,column),after=promptText.substring(column);promptText=before+text+after,moveColumn(text.length),restoreText=promptText,updatePromptDisplay()},extern.promptText=function(text){return text&&(promptText=text,column=promptText.length,updatePromptDisplay()),promptText},extern}}(jQuery),function(){var class_cache,commandCompletions,commands,controller,defaultFile,editor,fetch_rhino,fileNameCompletions,longestCommmonPrefix,preload,process_bytecode,progress,raw_cache,read_classfile,root,stdout,tabComplete,try_path,user_input,__slice=[].slice;root=this,"use strict",stdout=null,user_input=null,controller=null,editor=null,progress=null,class_cache={},raw_cache={},preload=function(){var data,done,file_count,on_complete,start_untar,update_bar;try{data=node.fs.readFileSync("/home/doppio/browser/mini-rt.tar")}catch(e){console.error(e)}if(data!=null)return file_count=0,done=!1,start_untar=(new Date).getTime(),on_complete=function(){var end_untar;return end_untar=(new Date).getTime(),console.log("Untarring took a total of "+(end_untar-start_untar)+"ms."),$("#overlay").fadeOut("slow"),$("#progress-container").fadeOut("slow"),$("#console").click()},update_bar=_.throttle(function(percent,path){var bar,display_perc,preloading_file;return bar=$("#progress > .bar"),preloading_file=$("#preloading-file"),display_perc=Math.min(Math.ceil(percent*100),100),bar.width(""+display_perc+"%",150),preloading_file.text(display_perc<100?"Loading "+path:"Done!")}),untar(new util.BytesArray(util.bytestr_to_array(data)),function(percent,path,file){var base,base_dir,cls,ext,_ref;update_bar(percent,path),raw_cache[path]=file,base_dir="vendor/classes/",_ref=path.split("."),base=_ref[0],ext=_ref[1];if(ext!=="class"){percent===100&&on_complete();return}return file_count++,cls=base.substr(base_dir.length),asyncExecute(function(){node.fs.writeFileSync(path,util.array_to_bytestr(file),!0),class_cache[cls]=new ClassFile(file);if(--file_count===0&&done)return on_complete()},0)},function(){done=!0;if(file_count===0)return on_complete()})},fetch_rhino=function(){var data;try{data=node.fs.readFileSync("/home/doppio/vendor/classes/com/sun/tools/script/shell/Main.class")}catch(e){console.error(e)}if(data!=null)return class_cache["!rhino"]=process_bytecode(data)},try_path=function(path){try{return util.bytestr_to_array(node.fs.readFileSync(path))}catch(e){return null}},read_classfile=function(cls){var fullpath,path,_i,_len,_ref;if(class_cache[cls]==null){_ref=jvm.classpath;for(_i=0,_len=_ref.length;_i<_len;_i++){path=_ref[_i],fullpath=""+path+cls+".class";if(fullpath in raw_cache){if(raw_cache[fullpath]===null)continue;class_cache[cls]=new ClassFile(raw_cache[fullpath]);break}raw_cache[fullpath]=try_path(fullpath);if(raw_cache[fullpath]!=null){class_cache[cls]=new ClassFile(raw_cache[fullpath]);break}}}return class_cache[cls]},root.read_raw_class=function(path){var data;return raw_cache[path]==null&&(data=try_path(path),data!=null&&(raw_cache[path]=data)),raw_cache[path]},process_bytecode=function(bytecode_string){var bytes_array;return bytes_array=util.bytestr_to_array(bytecode_string),new ClassFile(bytes_array)},$(document).ready(function(){var close_editor,jqconsole;return editor=$("#editor"),$("#file").change(function(ev){var f,file_fcn,files_uploaded,num_files,_i,_len,_ref;if(typeof FileReader=="undefined"||FileReader===null)return controller.message("Your browser doesn't support file loading.\nTry using the editor to create files instead.","error"),$("#console").click();num_files=ev.target.files.length,files_uploaded=0,controller.message("Uploading "+num_files+" files...\n","success",!0),file_fcn=function(f){var ext,isClass,reader;return reader=new FileReader,reader.onerror=function(e){switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:return alert("404'd");case e.target.error.NOT_READABLE_ERR:return alert("unreadable");case e.target.error.SECURITY_ERR:return alert("only works with --allow-file-access-from-files")}},ext=f.name.split(".")[1],isClass=ext==="class",reader.onload=function(e){return files_uploaded++,node.fs.writeFileSync(node.process.cwd()+"/"+f.name,e.target.result),controller.message("["+files_uploaded+"/"+num_files+"] File '"+f.name+"' saved.\n","success",files_uploaded!==num_files),isClass?typeof editor.getSession=="function"&&editor.getSession().setValue("/*\n * Binary file: "+f.name+"\n */"):typeof editor.getSession=="function"&&editor.getSession().setValue(e.target.result),$("#console").click()},isClass?reader.readAsBinaryString(f):reader.readAsText(f)},_ref=ev.target.files;for(_i=0,_len=_ref.length;_i<_len;_i++)f=_ref[_i],file_fcn(f)}),jqconsole=$("#console"),controller=jqconsole.console({promptLabel:"doppio > ",commandHandle:function(line){var a,args,cmd,handler,_ref;_ref=line.trim().split(/\s+/),cmd=_ref[0],args=2>_ref.length?[]:__slice.call(_ref,1);if(cmd==="")return!0;handler=commands[cmd];try{return handler!=null?handler(function(){var _i,_len,_results;_results=[];for(_i=0,_len=args.length;_i<_len;_i++)a=args[_i],a.length>0&&_results.push(a.trim());return _results}()):"Unknown command '"+cmd+"'. Enter 'help' for a list of commands."}catch(e){return controller.message(e+"","error")}},tabComplete:tabComplete,autofocus:!1,animateScroll:!0,promptHistory:!0,welcomeMessage:"Welcome to Doppio! You may wish to try the following Java programs:\n  java classes/test/FileRead\n  java classes/demo/Fib <num>\n  java classes/demo/Chatterbot\n  java classes/demo/RegexTestHarness\n  java classes/demo/Lzw c Hello.txt hello.lzw (compress)\n  java classes/demo/Lzw d hello.lzw hello (decompress)\n  java classes/demo/DiffPrint Hello.txt hello\n\nWe support the stock Sun Java Compiler:\n  javac classes/test/FileRead.java\n  javac classes/demo/Fib.java\n\nAnd we can even run Rhino, the Java-based JS engine!\n  rhino\n\nText files can be edited by typing `edit [filename]`.\n\nYou can also upload your own files using the uploader above the top-right\ncorner of the console.\n\nEnter 'help' for full a list of commands. Ctrl-D is EOF."}),stdout=function(str){return controller.message(str,"",!0)},user_input=function(n_bytes,resume){var oldHandle,oldPrompt;return oldPrompt=controller.promptLabel,controller.promptLabel="",controller.reprompt(),oldHandle=controller.commandHandle,controller.commandHandle=function(line){var i;return controller.commandHandle=oldHandle,controller.promptLabel=oldPrompt,line==="\0"?resume(0):(line+="\n",resume(function(){var _i,_ref,_results;_results=[];for(i=_i=0,_ref=Math.min(n_bytes,line.length);_i<_ref;i=_i+=1)_results.push(line.charCodeAt(i));return _results}()))}},close_editor=function(){return $("#ide").fadeOut("fast",function(){return $("#console").fadeIn("fast").click()})},$("#save_btn").click(function(e){var contents,fname;return fname=$("#filename").val(),contents=editor.getSession().getValue(),contents[contents.length-1]!=="\n"&&(contents+="\n"),node.fs.writeFileSync(fname,contents),controller.message("File saved as '"+fname+"'.","success"),close_editor(),e.preventDefault()}),$("#close_btn").click(function(e){return close_editor(),e.preventDefault()}),preload(),fetch_rhino()}),commands={javac:function(args,cb){var rs;return jvm.classpath=["./","/home/doppio/vendor/classes/","/home/doppio"],rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,"classes/util/Javac",args,function(){return controller.reprompt()}),null},java:function(args,cb){var class_args,class_name,rs;return args[0]==null||args[0]==="-classpath"&&args.length<3?"Usage: java [-classpath path1:path2...] class [args...]":(args[0]==="-classpath"?(jvm.classpath=args[1].split(":"),jvm.classpath.push("/home/doppio/vendor/classes/"),class_name=args[2],class_args=args.slice(3)):(jvm.classpath=["./","/home/doppio/vendor/classes/"],class_name=args[0],class_args=args.slice(1)),rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,class_name,class_args,function(){return controller.reprompt()}),null)},test:function(args){return args[0]==null?"Usage: test all|[class(es) to test]":(args[0]==="all"?testing.run_tests([],stdout,!0,!1,!0,function(){return controller.reprompt()}):testing.run_tests(args,stdout,!1,!1,!0,function(){return controller.reprompt()}),null)},javap:function(args){var raw_data;if(args[0]==null)return"Usage: javap class";try{raw_data=node.fs.readFileSync(""+args[0]+".class")}catch(e){return["Could not find class '"+args[0]+"'.","error"]}return disassembler.disassemble(process_bytecode(raw_data)),null},rhino:function(args,cb){var rs;return jvm.classpath=["./","/home/doppio/vendor/classes/"],rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,"!rhino",args,function(){return controller.reprompt()}),null},list_cache:function(){var name,val;return function(){var _results;_results=[];for(name in raw_cache)val=raw_cache[name],_results.push((val!=null?"":"-")+name);return _results}().join("\n")},clear_cache:function(args){return raw_cache={},class_cache={},"Cache cleared."},ls:function(args){var d,read_dir;return read_dir=function(dir){return node.fs.readdirSync(dir).sort().join("\n")},args.length===0?read_dir("."):args.length===1?read_dir(args[0]):function(){var _i,_len,_results;_results=[];for(_i=0,_len=args.length;_i<_len;_i++)d=args[_i],_results.push(""+d+":\n"+read_dir(d)+"\n");return _results}().join("\n")},edit:function(args){var data;try{data=args[0]!=null?node.fs.readFileSync(args[0]):defaultFile}catch(e){data=defaultFile}return $("#console").fadeOut("fast",function(){var JavaMode,TextMode,ext,_ref;return $("#filename").val(args[0]),$("#ide").fadeIn("fast"),editor=ace.edit("source"),editor.setTheme("ace/theme/twilight"),ext=(_ref=args[0])!=null?_ref.split(".")[1]:void 0,ext==="java"||args[0]==null?(JavaMode=require("ace/mode/java").Mode,editor.getSession().setMode(new JavaMode)):(TextMode=require("ace/mode/text").Mode,editor.getSession().setMode(new TextMode)),editor.getSession().setValue(data)}),!0},cat:function(args){var fname;fname=args[0];if(fname==null)return"Usage: cat <file>";try{return node.fs.readFileSync(fname)}catch(e){return"ERROR: "+fname+" does not exist."}},mv:function(args){if(args.length<2)return"Usage: mv <from-file> <to-file>";try{node.fs.renameSync(args[0],args[1])}catch(e){return"Invalid arguments."}return!0},cd:function(args){if(args.length>1)return"Usage: cd <directory>";args.length===0&&args.push("~");try{node.process.chdir(args[0])}catch(e){return"Invalid directory."}return!0},rm:function(args){var fname,fnames,fstat,_i,_len;if(args[0]==null)return"Usage: rm <file>";if(args[0]==="*"){fnames=node.fs.readdirSync(".");for(_i=0,_len=fnames.length;_i<_len;_i++){fname=fnames[_i],fstat=node.fs.statSync(fname);if(fstat.is_directory)return"ERROR: '"+fname+"' is a directory.";node.fs.unlinkSync(fname)}}else node.fs.unlinkSync(args[0]);return!0},emacs:function(){return"Try 'vim'."},vim:function(){return"Try 'emacs'."},time:function(args){var start;return start=(new Date).getTime(),console.profile(args[0]),controller.onreprompt=function(){var end;return controller.onreprompt=null,console.profileEnd(),end=(new Date).getTime(),controller.message("\nCommand took a total of "+(end-start)+"ms to run.\n","",!0)},commands[args.shift()](args)},profile:function(args){var count,duration,runs,time_once;return count=0,runs=5,duration=0,time_once=function(){var start;return start=(new Date).getTime(),controller.onreprompt=function(){var end;if(count<runs)return end=(new Date).getTime(),count++===0?time_once():(duration+=end-start,time_once());controller.onreprompt=null,controller.message("\n"+args[0]+" took an average of "+duration/runs+"ms.\n","",!0);return},commands[args.shift()](args)},time_once()},help:function(args){return"Ctrl-D is EOF.\n\nJava-related commands:\n  javac <source file>    -- Invoke the Java 6 compiler.\n  java <class> [args...] -- Run with command-line arguments.\n  javap <class>          -- Display disassembly.\n  time                   -- Measure how long it takes to run a command.\n\nFile management:\n  cat <file>             -- Display a file in the console.\n  edit <file>            -- Edit a file.\n  ls <dir>               -- List files.\n  mv <src> <dst>         -- Move / rename a file.\n  rm <file>              -- Delete a file.\n  cd <dir>               -- Change current directory.\n\nCache management:\n  list_cache             -- List the cached class files.\n  clear_cache            -- Clear the cached class files."}},tabComplete=function(){var args,getCompletions,prefix,promptText;promptText=controller.promptText(),args=promptText.split(/\s+/),getCompletions=function(args){return args.length===1?commandCompletions(args[0]):args[0]==="time"?getCompletions(args.slice(1)):fileNameCompletions(args[0],args)},prefix=longestCommmonPrefix(getCompletions(args));if(prefix==="")return;return promptText=promptText.substr(0,promptText.length-util.last(args).length),controller.promptText(promptText+prefix)},commandCompletions=function(cmd){var handler,name,_results;_results=[];for(name in commands)handler=commands[name],name.substr(0,cmd.length)===cmd&&_results.push(name);return _results},fileNameCompletions=function(cmd,args){var chopExt,completions,dirList,dirPfx,isDir,item,lastSlash,searchPfx,toComplete,validExtension,_i,_len,_ref;validExtension=function(fname){var dot,ext;return dot=fname.lastIndexOf("."),ext=dot===-1?"":fname.slice(dot+1),cmd==="javac"?ext==="java":cmd==="javap"||cmd==="java"?ext==="class":!0},chopExt=args.length===2&&(cmd==="javap"||cmd==="java"),toComplete=util.last(args),lastSlash=toComplete.lastIndexOf("/"),lastSlash<0?(dirPfx="",searchPfx=toComplete):(dirPfx=toComplete.slice(0,lastSlash+1),searchPfx=toComplete.slice(lastSlash+1));try{dirList=node.fs.readdirSync(dirPfx===""?".":dirPfx),dirList.push(".."),dirList.push(".")}catch(e){return[]}completions=[];for(_i=0,_len=dirList.length;_i<_len;_i++){item=dirList[_i],isDir=(_ref=node.fs.statSync(dirPfx+item))!=null?_ref.isDirectory():void 0;if(!validExtension(item)&&!isDir)continue;item.slice(0,searchPfx.length)===searchPfx&&(isDir?completions.push(dirPfx+item+"/"):cmd!=="cd"&&completions.push(dirPfx+(chopExt?item.split(".",1)[0]:item)))}return completions},longestCommmonPrefix=function(lst){return lst.join(" ").match(/^(\S*)\S*(?: \1\S*)*$/i)[1]},defaultFile="class Test {\n  public static void main(String[] args) {\n    // enter code here\n  }\n}"}.call(this);
// Underscore.js 1.3.1
// (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;a._chain&&(a=a._wrapped),c._chain&&(c=c._wrapped);if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return!1;switch(e){case"[object String]":return a==c+"";case"[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,g=!0;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,h)&&!(f--))break;g=!f}}return d.pop(),g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=b),exports._=b):r._=b,b.VERSION="1.3.1";var j=b.each=b.forEach=function(a,c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];return a==null?e:x&&a.map===x?a.map(c,b):(j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)}),a.length===+a.length&&(e.length=a.length),e)},b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(y&&a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d},b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();return e&&!f&&(c=b.bind(c,e)),f?b.reduce(g,c,d,e):b.reduce(g,c)},b.find=b.detect=function(a,c,b){var e;return E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,!0}),e},b.filter=b.select=function(a,c,b){var e=[];return a==null?e:A&&a.filter===A?a.filter(c,b):(j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)}),e)},b.reject=function(a,c,b){var e=[];return a==null?e:(j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)}),e)},b.every=b.all=function(a,c,b){var e=!0;return a==null?e:B&&a.every===B?a.every(c,b):(j(a,function(a,g,h){if(!(e=e&&c.call(b,a,g,h)))return n}),e)};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=!1;return a==null?e:C&&a.some===C?a.some(c,d):(j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n}),!!e)};b.include=b.contains=function(a,c){var b=!1;return a==null?b:p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})},b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})},b.pluck=function(a,c){return b.map(a,function(a){return a[c]})},b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};return j(a,function(a,b,h){b=c?c.call(d,a,b,h):a,b>=e.computed&&(e={value:a,computed:b})}),e.value},b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};return j(a,function(a,b,h){b=c?c.call(d,a,b,h):a,b<e.computed&&(e={value:a,computed:b})}),e.value},b.shuffle=function(a){var b=[],d;return j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)}),b},b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};return j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)}),d},b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e},b.toArray=function(a){return a?a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a):[]},b.size=function(a){return b.toArray(a).length},b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]},b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))},b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]},b.rest=b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)},b.compact=function(a){return b.filter(a,function(a){return!!a})},b.flatten=function(a,c){return b.reduce(a,function(a,e){return b.isArray(e)?a.concat(c?e:b.flatten(e)):(a[a.length]=e,a)},[])},b.without=function(a){return b.difference(a,i.call(arguments,1))},b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];return b.reduce(d,function(d,g,h){if(0==h||(c===!0?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]),e},b.union=function(){return b.uniq(b.flatten(arguments,!0))},b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})},b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})},b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d},b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1},b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1},b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;return e=i.call(arguments,2),d=function(){if(this instanceof d){F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}return a.apply(c,e.concat(i.call(arguments)))}},b.bindAll=function(a){var c=i.call(arguments,1);return c.length==0&&(c=b.functions(a)),j(c,function(c){a[c]=b.bind(a[c],a)}),a},b.memoize=function(a,c){var d={};return c||(c=b.identity),function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}},b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)},b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))},b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=!1},c);return function(){d=this,e=arguments;var b;f||(f=setTimeout(function(){f=null,h&&a.apply(d,e),i()},c)),g?h=!0:a.apply(d,e),i(),g=!0}},b.debounce=function(a,b){var d;return function(){var e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,a.apply(e,f)},b)}},b.once=function(a){var b=!1,d;return function(){return b?d:(b=!0,d=a.apply(this,arguments))}},b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}},b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}},b.after=function(a,b){return a>0?function(){if(--a<1)return b.apply(this,arguments)}:b()},b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c},b.values=function(a){return b.map(a,b.identity)},b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()},b.extend=function(a){return j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]}),a},b.defaults=function(a){return j(i.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])}),a},b.clone=function(a){return b.isObject(a)?b.isArray(a)?a.slice():b.extend({},a):a},b.tap=function(a,b){return b(a),a},b.isEqual=function(a,b){return q(a,b,[])},b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return!1;return!0},b.isElement=function(a){return!!a&&a.nodeType==1},b.isArray=o||function(a){return l.call(a)=="[object Array]"},b.isObject=function(a){return a===Object(a)},b.isArguments=function(a){return l.call(a)=="[object Arguments]"},b.isArguments(arguments)||(b.isArguments=function(a){return!!a&&!!b.has(a,"callee")}),b.isFunction=function(a){return l.call(a)=="[object Function]"},b.isString=function(a){return l.call(a)=="[object String]"},b.isNumber=function(a){return l.call(a)=="[object Number]"},b.isNaN=function(a){return a!==a},b.isBoolean=function(a){return a===!0||a===!1||l.call(a)=="[object Boolean]"},b.isDate=function(a){return l.call(a)=="[object Date]"},b.isRegExp=function(a){return l.call(a)=="[object RegExp]"},b.isNull=function(a){return a===null},b.isUndefined=function(a){return a===void 0},b.has=function(a,b){return I.call(a,b)},b.noConflict=function(){return r._=G,this},b.identity=function(a){return a},b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)},b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},b.mixin=function(a){j(b.functions(a),function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}},b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=function(){var a=i.call(arguments);return H.call(a,this._wrapped),v(c.apply(b,a),this._chain)}};b.mixin(b),j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;return(a=="shift"||a=="splice")&&e===0&&delete d[0],v(d,this._chain)}}),j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}}),m.prototype.chain=function(){return this._chain=!0,this},m.prototype.value=function(){return this._wrapped}}).call(this),function(){var root=this;root.gLong=function(low,high){this.low_=low|0,this.high_=high|0},root.gLong.IntCache_={},root.gLong.fromInt=function(value){if(-128<=value&&value<128){var cachedObj=root.gLong.IntCache_[value];if(cachedObj)return cachedObj}var obj=new root.gLong(value|0,value<0?-1:0);return-128<=value&&value<128&&(root.gLong.IntCache_[value]=obj),obj},root.gLong.fromNumber=function(value){return isNaN(value)||!isFinite(value)?root.gLong.ZERO:value>-root.gLong.TWO_PWR_63_DBL_?value+1<root.gLong.TWO_PWR_63_DBL_?value<0?root.gLong.fromNumber(-value).negate():new root.gLong(value%root.gLong.TWO_PWR_32_DBL_|0,value/root.gLong.TWO_PWR_32_DBL_|0):root.gLong.MAX_VALUE:root.gLong.MIN_VALUE},root.gLong.fromBits=function(lowBits,highBits){return new root.gLong(lowBits,highBits)},root.gLong.fromString=function(str,opt_radix){if(str.length==0)throw Error("number format error: empty string");var radix=opt_radix||10;if(radix<2||36<radix)throw Error("radix out of range: "+radix);if(str.charAt(0)=="-")return root.gLong.fromString(str.substring(1),radix).negate();if(str.indexOf("-")<0){var radixToPower=root.gLong.fromNumber(Math.pow(radix,8)),result=root.gLong.ZERO;for(var i=0;i<str.length;i+=8){var size=Math.min(8,str.length-i),value=parseInt(str.substring(i,i+size),radix);if(size<8){var power=root.gLong.fromNumber(Math.pow(radix,size));result=result.multiply(power).add(root.gLong.fromNumber(value))}else result=result.multiply(radixToPower),result=result.add(root.gLong.fromNumber(value))}return result}throw Error('number format error: interior "-" character: '+str)},root.gLong.TWO_PWR_16_DBL_=65536,root.gLong.TWO_PWR_24_DBL_=1<<24,root.gLong.TWO_PWR_32_DBL_=root.gLong.TWO_PWR_16_DBL_*root.gLong.TWO_PWR_16_DBL_,root.gLong.TWO_PWR_31_DBL_=root.gLong.TWO_PWR_32_DBL_/2,root.gLong.TWO_PWR_48_DBL_=root.gLong.TWO_PWR_32_DBL_*root.gLong.TWO_PWR_16_DBL_,root.gLong.TWO_PWR_64_DBL_=root.gLong.TWO_PWR_32_DBL_*root.gLong.TWO_PWR_32_DBL_,root.gLong.TWO_PWR_63_DBL_=root.gLong.TWO_PWR_64_DBL_/2,root.gLong.ZERO=root.gLong.fromInt(0),root.gLong.ONE=root.gLong.fromInt(1),root.gLong.NEG_ONE=root.gLong.fromInt(-1),root.gLong.MAX_VALUE=root.gLong.fromBits(-1,2147483647),root.gLong.MIN_VALUE=root.gLong.fromBits(0,-2147483648),root.gLong.TWO_PWR_24_=root.gLong.fromInt(1<<24),root.gLong.prototype.toInt=function(){return this.low_},root.gLong.prototype.toNumber=function(){return this.high_*root.gLong.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},root.gLong.prototype.toString=function(opt_radix){var radix=opt_radix||10;if(radix<2||36<radix)throw Error("radix out of range: "+radix);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(root.gLong.MIN_VALUE)){var radixLong=root.gLong.fromNumber(radix),div=this.div(radixLong),rem=div.multiply(radixLong).subtract(this);return div.toString(radix)+rem.toInt().toString(radix)}return"-"+this.negate().toString(radix)}var radixToPower=root.gLong.fromNumber(Math.pow(radix,6)),rem=this,result="";for(;;){var remDiv=rem.div(radixToPower),intval=rem.subtract(remDiv.multiply(radixToPower)).toInt(),digits=intval.toString(radix);rem=remDiv;if(rem.isZero())return digits+result;while(digits.length<6)digits="0"+digits;result=""+digits+result}},root.gLong.prototype.getHighBits=function(){return this.high_},root.gLong.prototype.getLowBits=function(){return this.low_},root.gLong.prototype.getLowBitsUnsigned=function(){return this.low_<0?root.gLong.TWO_PWR_32_DBL_+this.low_:this.low_},root.gLong.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(root.gLong.MIN_VALUE)?64:this.negate().getNumBitsAbs();var val=this.high_!=0?this.high_:this.low_;for(var bit=31;bit>0;bit--)if((val&1<<bit)!=0)break;return this.high_!=0?bit+33:bit+1},root.gLong.prototype.isZero=function(){return this.high_==0&&this.low_==0},root.gLong.prototype.isNegative=function(){return this.high_<0},root.gLong.prototype.isOdd=function(){return(this.low_&1)==1},root.gLong.prototype.equals=function(other){return this.high_==other.high_&&this.low_==other.low_},root.gLong.prototype.notEquals=function(other){return this.high_!=other.high_||this.low_!=other.low_},root.gLong.prototype.lessThan=function(other){return this.compare(other)<0},root.gLong.prototype.lessThanOrEqual=function(other){return this.compare(other)<=0},root.gLong.prototype.greaterThan=function(other){return this.compare(other)>0},root.gLong.prototype.greaterThanOrEqual=function(other){return this.compare(other)>=0},root.gLong.prototype.compare=function(other){if(this.equals(other))return 0;var thisNeg=this.isNegative(),otherNeg=other.isNegative();return thisNeg&&!otherNeg?-1:!thisNeg&&otherNeg?1:this.subtract(other).isNegative()?-1:1},root.gLong.prototype.negate=function(){return this.equals(root.gLong.MIN_VALUE)?root.gLong.MIN_VALUE:this.not().add(root.gLong.ONE)},root.gLong.prototype.add=function(other){var a48=this.high_>>>16,a32=this.high_&65535,a16=this.low_>>>16,a00=this.low_&65535,b48=other.high_>>>16,b32=other.high_&65535,b16=other.low_>>>16,b00=other.low_&65535,c48=0,c32=0,c16=0,c00=0;return c00+=a00+b00,c16+=c00>>>16,c00&=65535,c16+=a16+b16,c32+=c16>>>16,c16&=65535,c32+=a32+b32,c48+=c32>>>16,c32&=65535,c48+=a48+b48,c48&=65535,root.gLong.fromBits(c16<<16|c00,c48<<16|c32)},root.gLong.prototype.subtract=function(other){return this.add(other.negate())},root.gLong.prototype.multiply=function(other){if(this.isZero())return root.gLong.ZERO;if(other.isZero())return root.gLong.ZERO;if(this.equals(root.gLong.MIN_VALUE))return other.isOdd()?root.gLong.MIN_VALUE:root.gLong.ZERO;if(other.equals(root.gLong.MIN_VALUE))return this.isOdd()?root.gLong.MIN_VALUE:root.gLong.ZERO;if(this.isNegative())return other.isNegative()?this.negate().multiply(other.negate()):this.negate().multiply(other).negate();if(other.isNegative())return this.multiply(other.negate()).negate();if(this.lessThan(root.gLong.TWO_PWR_24_)&&other.lessThan(root.gLong.TWO_PWR_24_))return root.gLong.fromNumber(this.toNumber()*other.toNumber());var a48=this.high_>>>16,a32=this.high_&65535,a16=this.low_>>>16,a00=this.low_&65535,b48=other.high_>>>16,b32=other.high_&65535,b16=other.low_>>>16,b00=other.low_&65535,c48=0,c32=0,c16=0,c00=0;return c00+=a00*b00,c16+=c00>>>16,c00&=65535,c16+=a16*b00,c32+=c16>>>16,c16&=65535,c16+=a00*b16,c32+=c16>>>16,c16&=65535,c32+=a32*b00,c48+=c32>>>16,c32&=65535,c32+=a16*b16,c48+=c32>>>16,c32&=65535,c32+=a00*b32,c48+=c32>>>16,c32&=65535,c48+=a48*b00+a32*b16+a16*b32+a00*b48,c48&=65535,root.gLong.fromBits(c16<<16|c00,c48<<16|c32)},root.gLong.prototype.div=function(other){if(other.isZero())throw Error("division by zero");if(this.isZero())return root.gLong.ZERO;if(this.equals(root.gLong.MIN_VALUE)){if(other.equals(root.gLong.ONE)||other.equals(root.gLong.NEG_ONE))return root.gLong.MIN_VALUE;if(other.equals(root.gLong.MIN_VALUE))return root.gLong.ONE;var halfThis=this.shiftRight(1),approx=halfThis.div(other).shiftLeft(1);if(approx.equals(root.gLong.ZERO))return other.isNegative()?root.gLong.ONE:root.gLong.NEG_ONE;var rem=this.subtract(other.multiply(approx)),result=approx.add(rem.div(other));return result}if(other.equals(root.gLong.MIN_VALUE))return root.gLong.ZERO;if(this.isNegative())return other.isNegative()?this.negate().div(other.negate()):this.negate().div(other).negate();if(other.isNegative())return this.div(other.negate()).negate();var res=root.gLong.ZERO,rem=this;while(rem.greaterThanOrEqual(other)){var approx=Math.max(1,Math.floor(rem.toNumber()/other.toNumber())),log2=Math.ceil(Math.log(approx)/Math.LN2),delta=log2>48?Math.pow(2,log2-48):1,approxRes=root.gLong.fromNumber(approx),approxRem=approxRes.multiply(other);while(approxRem.isNegative()||approxRem.greaterThan(rem))approx-=delta,approxRes=root.gLong.fromNumber(approx),approxRem=approxRes.multiply(other);approxRes.isZero()&&(approxRes=root.gLong.ONE),res=res.add(approxRes),rem=rem.subtract(approxRem)}return res},root.gLong.prototype.modulo=function(other){return this.subtract(this.div(other).multiply(other))},root.gLong.prototype.not=function(){return root.gLong.fromBits(~this.low_,~this.high_)},root.gLong.prototype.and=function(other){return root.gLong.fromBits(this.low_&other.low_,this.high_&other.high_)},root.gLong.prototype.or=function(other){return root.gLong.fromBits(this.low_|other.low_,this.high_|other.high_)},root.gLong.prototype.xor=function(other){return root.gLong.fromBits(this.low_^other.low_,this.high_^other.high_)},root.gLong.prototype.shiftLeft=function(numBits){numBits&=63;if(numBits==0)return this;var low=this.low_;if(numBits<32){var high=this.high_;return root.gLong.fromBits(low<<numBits,high<<numBits|low>>>32-numBits)}return root.gLong.fromBits(0,low<<numBits-32)},root.gLong.prototype.shiftRight=function(numBits){numBits&=63;if(numBits==0)return this;var high=this.high_;if(numBits<32){var low=this.low_;return root.gLong.fromBits(low>>>numBits|high<<32-numBits,high>>numBits)}return root.gLong.fromBits(high>>numBits-32,high<0?-1:0)},root.gLong.prototype.shiftRightUnsigned=function(numBits){numBits&=63;if(numBits==0)return this;var high=this.high_;if(numBits<32){var low=this.low_;return root.gLong.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits)}return numBits==32?root.gLong.fromBits(high,0):root.gLong.fromBits(high>>>numBits-32,0)},typeof module!="undefined"&&module!==null&&(module.exports=root.gLong)}.call(this),function(){var nonAsyncCount,root;root=typeof exports!="undefined"&&exports!==null?exports:this,nonAsyncCount=0,root.asyncExecute=function(fn){return typeof document!="undefined"&&document!==null&&(document.hidden||document.mozHidden||document.webkitHidden||document.msHidden)&&nonAsyncCount++<1e4?fn():(nonAsyncCount=0,setTimeout(fn,0))}}.call(this),function(){var Stat,basename,root,win,__indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};root=this.node={},win=window,win.DoppioFile=function(){function DoppioFile(name){this.name=name,this.mtime=(new Date).getTime(),this.data=""}return DoppioFile.load=function(fname){var data,file,k,rawData,v;fname=basename(root.path.resolve(fname)),rawData=localStorage["file::"+(fname!=null?fname.toLowerCase():void 0)];if(!rawData)return null;data=JSON.parse(rawData),file=new win.DoppioFile(fname);for(k in data)v=data[k],file[k]=v;return file},DoppioFile.prototype.read=function(length,pos){return length==null?this.data:this.data.substr(pos,length)},DoppioFile.prototype.write=function(newData){return this.data+=newData,this},DoppioFile.prototype.save=function(){return localStorage["file::"+this.name.toLowerCase()]=JSON.stringify({name:this.name,data:this.data,mtime:this.mtime}),this},DoppioFile["delete"]=function(fname){return fname=basename(root.path.resolve(fname)),localStorage.removeItem("file::"+fname.toLowerCase())},DoppioFile}(),win.Buffer=function(){function Buffer(obj){obj instanceof Array?this.array=obj:this.array=Array(obj)}return Buffer.prototype.readUInt8=function(i){return util.int2uint(this.array[i],1)},Buffer}(),Stat=function(){function Stat(file){this.file=file,this.file!=null&&(this.size=this.file.data.length,this.mtime=this.file.mtime,this.is_file=!0,this.is_directory=!1)}return Stat.fromPath=function(path){var file,stat;return path===""?(stat=new Stat,stat.size=1,stat.mtime=(new Date).getTime(),stat.is_file=!1,stat.is_directory=!0,stat):(file=win.DoppioFile.load(path),file==null?null:new Stat(file))},Stat.prototype.isFile=function(){return this.is_file},Stat.prototype.isDirectory=function(){return this.is_directory},Stat}(),root.fs={statSync:function(fname){var stat;return fname=root.path.resolve(fname),fname!=="/System/Library/Frameworks/JavaVM.framework/Classes/classes.jar"?Stat.fromPath(fname):(stat=new Stat,stat.size=21090,stat.mtime=(new Date).getTime()-1e4,stat.is_file=!0,stat.is_directory=!1,stat)},fstatSync:function(fp){return new Stat(fp)},openSync:function(fname,mode){var err,f;fname=root.path.resolve(fname);if(__indexOf.call(mode,"r")<0)return new DoppioFile(fname);f=win.DoppioFile.load(fname);if(f==null)throw err=Error(),err.code="ENOENT",err;return f},readSync:function(file,buf,offset,length,pos){var d,data,i,_len;data=file.read(length,pos);for(i=0,_len=data.length;i<_len;i++)d=data[i],buf.array[offset+i]=data.charCodeAt(i)&255;return data.length},writeSync:function(file,buffer,offset,len){var i;return file.write(function(){var _ref,_results;_results=[];for(i=offset,_ref=offset+len;offset>_ref?i>_ref:i<_ref;offset>_ref?i--:i++)_results.push(String.fromCharCode(buffer.readUInt8(i)));return _results}().join(""))},closeSync:function(file){return file.save()},readdirSync:function(path){var file,key,_results;_results=[];for(key in localStorage)file=localStorage[key],key.slice(0,6)==="file::"&&_results.push(DoppioFile.load(key.slice(6)).name);return _results}},root.path={normalize:function(path){return path},resolve:function(path){var absolute,c,components,idx,_len;absolute=path[0]==="/",components=path.split("/");for(idx=0,_len=components.length;idx<_len;idx++)c=components[idx],c==="."&&(components[idx]="");return path=function(){var _len2,_results;_results=[];for(idx=0,_len2=components.length;idx<_len2;idx++)c=components[idx],c!==""&&_results.push(c);return _results}().join("/"),(absolute?"/":"")+path}},basename=function(path){return _.last(path.split("/"))}}.call(this),function(){var root,__slice=Array.prototype.slice;if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");root=typeof exports!="undefined"&&exports!==null?exports:this.util={},root.sum=function(list){return _.reduce(list,function(a,b){return a+b},0)},root.cmp=function(a,b){return a===b?0:a<b?-1:a>b?1:null},root.lshift=function(x,n){return x*Math.pow(2,n)},root.read_uint=function(bytes){var i,n;return n=bytes.length-1,root.sum(function(){var _results;_results=[];for(i=0;0>n?i>=n:i<=n;0>n?i--:i++)_results.push(root.lshift(bytes[i],8*(n-i)));return _results}())},root.uint2int=function(uint,bytes_count){return uint>Math.pow(2,8*bytes_count-1)?uint-Math.pow(2,8*bytes_count):uint},root.int2uint=function(int,bytes_count){return int<0?int+Math.pow(2,bytes_count*8):int},root.bytestr_to_array=function(bytecode_string){var i,_ref,_results;_results=[];for(i=0,_ref=bytecode_string.length;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(bytecode_string.charCodeAt(i)&255);return _results},root.parse_flags=function(flag_byte){var f,flags,s;flags={"public":flag_byte&1,"private":flag_byte&2,"protected":flag_byte&4,"static":flag_byte&8,"final":flag_byte&16,"synchronized":flag_byte&32,"super":flag_byte&32,"volatile":flag_byte&64,"transient":flag_byte&128,"native":flag_byte&256,"interface":flag_byte&512,"abstract":flag_byte&1024,strict:flag_byte&2048},s=root.sum(function(){var _i,_len,_ref,_results;_ref=["public","private","protected"],_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)f=_ref[_i],flags[f]!==0&&_results.push(1);return _results}());if(s>1)throw Error("Too many access flags, invalid classfile parse");return flags},root.BytesArray=function(){function BytesArray(raw_array,start,end){this.raw_array=raw_array,this.start=start!=null?start:0,this.end=end!=null?end:this.raw_array.length,this._index=0}return BytesArray.prototype.pos=function(){return this._index},BytesArray.prototype.skip=function(bytes_count){return this._index+=bytes_count},BytesArray.prototype.has_bytes=function(){return this.start+this._index<this.end},BytesArray.prototype.get_uint=function(bytes_count){var rv;return rv=root.read_uint(this.raw_array.slice(this.start+this._index,this.start+this._index+bytes_count)),this._index+=bytes_count,rv},BytesArray.prototype.get_int=function(bytes_count){return root.uint2int(this.get_uint(bytes_count),bytes_count)},BytesArray.prototype.read=function(bytes_count){var rv;return rv=this.raw_array.slice(this.start+this._index,this.start+this._index+bytes_count),this._index+=bytes_count,rv},BytesArray.prototype.peek=function(){return this.raw_array[this.start+this._index]},BytesArray.prototype.size=function(){return this.end-this.start-this._index},BytesArray.prototype.splice=function(len){var arr;return arr=new root.BytesArray(this.raw_array,this.start+this._index,this.start+this._index+len),this._index+=len,arr},BytesArray}(),root.is_string=function(obj){return typeof obj=="string"||obj instanceof String},root.lookup_handler=function(){var args,handler,handlers,obj,object;handlers=arguments[0],object=arguments[1],args=3>arguments.length?[]:__slice.call(arguments,2),obj=object;while(obj!=null){handler=handlers[obj.constructor.name];if(handler)return handler.apply(object,args);obj=Object.getPrototypeOf(obj)}},root.BranchException=function(){function BranchException(dst_pc){this.dst_pc=dst_pc}return BranchException}(),root.HaltException=function(){function HaltException(exit_code){this.exit_code=exit_code}return HaltException}(),root.ReturnException=function(){function ReturnException(){var values;values=1>arguments.length?[]:__slice.call(arguments,0),this.values=values}return ReturnException}(),root.YieldException=function(){function YieldException(condition){this.condition=condition}return YieldException}(),root.JavaException=function(){function JavaException(rs,exception){this.exception=exception}return JavaException}(),root.java_throw=function(rs,cls,msg){var method_spec,v;throw method_spec={"class":cls,sig:"<init>(Ljava/lang/String;)V"},v=rs.init_object(cls),rs.push(v,v,rs.init_string(msg)),rs.method_lookup(method_spec).run(rs),new root.JavaException(rs,rs.pop())},root.DEBUG=10,root.ERROR=1,root.log_level==null&&(root.log_level=root.ERROR),root.log=function(){var level,msgs;level=arguments[0],msgs=2>arguments.length?[]:__slice.call(arguments,1);if(level<=root.log_level)return console[level===1?"error":"log"].apply(console,msgs)},root.debug=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.DEBUG].concat(__slice.call(msgs)))},root.error=function(){var msgs;return msgs=1>arguments.length?[]:__slice.call(arguments,0),root.log.apply(root,[root.ERROR].concat(__slice.call(msgs)))},root.ext_classname=function(str){return str.replace(/\//g,".")},root.int_classname=function(str){return str.replace(/\./g,"/")},root.bytes2str=function(bytes){var char_array,idx,x,y,z;return idx=0,char_array=function(){var _results;_results=[];while(idx<bytes.length){x=root.int2uint(bytes[idx++],1);if(x===0)break;_results.push(String.fromCharCode(x>127?x>223?(y=bytes[idx++],z=bytes[idx++],((x&15)<<12)+((y&63)<<6)+(z&63)):(y=bytes[idx++],((x&31)<<6)+(y&63)):x))}return _results}(),char_array.join("")}}.call(this),function(){var external2internal,internal2external,is_subclass,is_subinterface,k,root,v,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};root=typeof exports!="undefined"&&exports!==null?exports:this.types={},internal2external={B:"byte",C:"char",D:"double",F:"float",I:"int",J:"long",S:"short",V:"void",Z:"boolean"},external2internal={};for(k in internal2external)v=internal2external[k],external2internal[v]=k;root.str2type=function(type_str){return root.carr2type(type_str.split(""))},root.carr2type=function(carr){var c;c=carr.shift();if(c==null)return null;if(c in internal2external)return new root.PrimitiveType(internal2external[c]);if(c==="L")return new root.ClassType(function(){var _results;_results=[];while((c=carr.shift())!==";")_results.push(c);return _results}().join(""));if(c==="[")return new root.ArrayType(root.carr2type(carr));throw carr.unshift(c),Error("Unrecognized type string: "+carr.join(""))},root.c2t=function(type_str){if(type_str instanceof root.Type)throw""+type_str+" is already a Type";return type_str[0]==="["?root.str2type(type_str):new root.ClassType(type_str)},root.Type=function(){function Type(){}return Type.prototype.toString=function(){return this.valueOf()},Type}(),root.PrimitiveType=function(_super){function PrimitiveType(name){this.name=name}return __extends(PrimitiveType,_super),PrimitiveType.prototype.valueOf=function(){return external2internal[this.name]},PrimitiveType.prototype.toExternalString=function(){return this.name},PrimitiveType}(root.Type),root.ArrayType=function(_super){function ArrayType(component_type){this.component_type=component_type}return __extends(ArrayType,_super),ArrayType.prototype.valueOf=function(){return"["+this.component_type},ArrayType.prototype.toClassString=function(){return this.valueOf()},ArrayType.prototype.toExternalString=function(){return util.ext_classname(this.valueOf())},ArrayType}(root.Type),root.ClassType=function(_super){function ClassType(class_name){this.class_name=class_name}return __extends(ClassType,_super),ClassType.prototype.valueOf=function(){return"L"+this.
class_name+";"},ClassType.prototype.toClassString=function(){return this.class_name},ClassType.prototype.toExternalString=function(){return util.ext_classname(this.class_name)},ClassType}(root.Type),is_subclass=function(rs,class1,class2){return class1.this_class===class2.this_class?!0:class1.super_class?is_subclass(rs,rs.class_lookup(class1.super_class),class2):!1},is_subinterface=function(rs,iface1,iface2){var i,super_iface,_i,_len,_ref;if(iface1.this_class===iface2.this_class)return!0;_ref=iface1.interfaces;for(_i=0,_len=_ref.length;_i<_len;_i++){i=_ref[_i],super_iface=rs.class_lookup(root.c2t(iface1.constant_pool.get(i).deref()));if(is_subinterface(rs,super_iface,iface2))return!0}return iface1.super_class?is_subinterface(rs,rs.class_lookup(iface1.super_class),iface2):!1},root.check_cast=function(rs,obj,classname){return root.is_castable(rs,obj.type,root.c2t(classname))},root.is_castable=function(rs,type1,type2){var c1,c2,_ref;return type1 instanceof types.PrimitiveType||type2 instanceof types.PrimitiveType?type1.name===type2.name:type1 instanceof types.ArrayType?type2 instanceof types.ArrayType?root.is_castable(rs,type1.component_type,type2.component_type):(c2=rs.class_lookup(type2),c2.access_flags.interface?(_ref=type2.class_name)==="java/lang/Cloneable"||_ref==="java/io/Serializable":type2.class_name==="java/lang/Object"):type2 instanceof types.ArrayType?!1:(c1=rs.class_lookup(type1),c2=rs.class_lookup(type2),c1.access_flags.interface?c2.access_flags.interface?is_subinterface(rs,c1,c2):type2.class_name==="java/lang/Object":c2.access_flags.interface?is_subinterface(rs,c1,c2):is_subclass(rs,c1,c2))}}.call(this),function(){var BranchException,JavaException,ReturnException,c2t,float2int,int_div,int_mod,java_throw,jsr,long_div,long_mod,root,towards_zero,truncate,wrap_float,wrap_int,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(typeof gLong=="undefined"||gLong===null)gLong=require("../third_party/gLong.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof types=="undefined"||types===null)types=require("./types");java_throw=util.java_throw,BranchException=util.BranchException,ReturnException=util.ReturnException,JavaException=util.JavaException,c2t=types.c2t,root=typeof exports!="undefined"&&exports!==null?exports:this.opcodes={},root.Opcode=function(){function Opcode(name,params){var prop,val,_ref;this.name=name,params==null&&(params={});for(prop in params)val=params[prop],this[prop]=val;this.execute==null&&(this.execute=this._execute),this.byte_count=(_ref=params.byte_count)!=null?_ref:0}return Opcode.prototype.take_args=function(code_array){return this.args=function(){var _i,_ref,_results;_results=[];for(_i=0,_ref=this.byte_count;0>_ref?_i>_ref:_i<_ref;0>_ref?_i--:_i++)_results.push(code_array.get_uint(1));return _results}.call(this)},Opcode}(),root.FieldOpcode=function(_super){function FieldOpcode(name,params){FieldOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(FieldOpcode,_super),FieldOpcode.prototype.take_args=function(code_array,constant_pool){return this.field_spec_ref=code_array.get_uint(2),this.field_spec=constant_pool.get(this.field_spec_ref).deref()},FieldOpcode}(root.Opcode),root.ClassOpcode=function(_super){function ClassOpcode(name,params){ClassOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(ClassOpcode,_super),ClassOpcode.prototype.take_args=function(code_array,constant_pool){return this.class_ref=code_array.get_uint(2),this["class"]=constant_pool.get(this.class_ref).deref()},ClassOpcode}(root.Opcode),root.InvokeOpcode=function(_super){function InvokeOpcode(name,params){InvokeOpcode.__super__.constructor.call(this,name,params),this.byte_count=2}return __extends(InvokeOpcode,_super),InvokeOpcode.prototype.take_args=function(code_array,constant_pool){return this.method_spec_ref=code_array.get_uint(2),this.name==="invokeinterface"&&(this.count=code_array.get_uint(1),code_array.skip(1),this.byte_count+=2),this.method_spec=constant_pool.get(this.method_spec_ref).deref()},InvokeOpcode}(root.Opcode),root.LoadConstantOpcode=function(_super){function LoadConstantOpcode(){LoadConstantOpcode.__super__.constructor.apply(this,arguments)}return __extends(LoadConstantOpcode,_super),LoadConstantOpcode.prototype.take_args=function(code_array,constant_pool){return this.cls=constant_pool.cls,this.constant_ref=code_array.get_uint(this.byte_count),this.constant=constant_pool.get(this.constant_ref)},LoadConstantOpcode.prototype._execute=function(rs){var jvm_str,val;val=this.constant.value,this.constant.type==="String"&&(val=rs.string_redirect(val,this.cls)),this.constant.type==="class"&&(jvm_str=rs.string_redirect(val,this.cls),val=rs.class_lookup(c2t(rs.jvm2js_str(jvm_str)),!0)),rs.push(val);if(this.name==="ldc2_w")return rs.push(null)},LoadConstantOpcode}(root.Opcode),root.BranchOpcode=function(_super){function BranchOpcode(name,params){params==null&&(params={}),params.byte_count==null&&(params.byte_count=2),BranchOpcode.__super__.constructor.call(this,name,params)}return __extends(BranchOpcode,_super),BranchOpcode.prototype.take_args=function(code_array){return this.offset=code_array.get_int(this.byte_count)},BranchOpcode}(root.Opcode),root.UnaryBranchOpcode=function(_super){function UnaryBranchOpcode(name,params){UnaryBranchOpcode.__super__.constructor.call(this,name,{execute:function(rs){var v;v=rs.pop();if(params.cmp(v))throw new BranchException(rs.curr_pc()+this.offset)}})}return __extends(UnaryBranchOpcode,_super),UnaryBranchOpcode}(root.BranchOpcode),root.BinaryBranchOpcode=function(_super){function BinaryBranchOpcode(name,params){BinaryBranchOpcode.__super__.constructor.call(this,name,{execute:function(rs){var v1,v2;v2=rs.pop(),v1=rs.pop();if(params.cmp(v1,v2))throw new BranchException(rs.curr_pc()+this.offset)}})}return __extends(BinaryBranchOpcode,_super),BinaryBranchOpcode}(root.BranchOpcode),root.PushOpcode=function(_super){function PushOpcode(){PushOpcode.__super__.constructor.apply(this,arguments)}return __extends(PushOpcode,_super),PushOpcode.prototype.take_args=function(code_array){return this.value=code_array.get_int(this.byte_count)},PushOpcode.prototype._execute=function(rs){return rs.push(this.value)},PushOpcode}(root.Opcode),root.IIncOpcode=function(_super){function IIncOpcode(name,params){IIncOpcode.__super__.constructor.call(this,name,params)}return __extends(IIncOpcode,_super),IIncOpcode.prototype.take_args=function(code_array,constant_pool,wide){var arg_size;return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",arg_size=2,this.byte_count=5):(arg_size=1,this.byte_count=2),this.index=code_array.get_uint(arg_size),this["const"]=code_array.get_int(arg_size)},IIncOpcode.prototype._execute=function(rs){return rs.put_cl(this.index,rs.cl(this.index)+this["const"])},IIncOpcode}(root.Opcode),root.LoadOpcode=function(_super){function LoadOpcode(name,params){params==null&&(params={}),params.execute==null&&(params.execute=name.match(/[ld]load/)?function(rs){return rs.push(rs.cl(this.var_num),null)}:function(rs){return rs.push(rs.cl(this.var_num))}),LoadOpcode.__super__.constructor.call(this,name,params)}return __extends(LoadOpcode,_super),LoadOpcode.prototype.take_args=function(code_array){return this.var_num=parseInt(this.name[6])},LoadOpcode}(root.Opcode),root.LoadVarOpcode=function(_super){function LoadVarOpcode(){LoadVarOpcode.__super__.constructor.apply(this,arguments)}return __extends(LoadVarOpcode,_super),LoadVarOpcode.prototype.take_args=function(code_array,constant_pool,wide){return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",this.byte_count=3,this.var_num=code_array.get_uint(2)):(this.byte_count=1,this.var_num=code_array.get_uint(1))},LoadVarOpcode}(root.LoadOpcode),root.StoreOpcode=function(_super){function StoreOpcode(name,params){params==null&&(params={}),params.execute==null&&(params.execute=name.match(/[ld]store/)?function(rs){return rs.put_cl2(this.var_num,rs.pop2())}:function(rs){return rs.put_cl(this.var_num,rs.pop())}),StoreOpcode.__super__.constructor.call(this,name,params)}return __extends(StoreOpcode,_super),StoreOpcode.prototype.take_args=function(code_array){return this.var_num=parseInt(this.name[7])},StoreOpcode}(root.Opcode),root.StoreVarOpcode=function(_super){function StoreVarOpcode(name,params){StoreVarOpcode.__super__.constructor.call(this,name,params)}return __extends(StoreVarOpcode,_super),StoreVarOpcode.prototype.take_args=function(code_array,constant_pool,wide){return this.wide=wide!=null?wide:!1,this.wide?(this.name+="_w",this.byte_count=3,this.var_num=code_array.get_uint(2)):(this.byte_count=1,this.var_num=code_array.get_uint(1))},StoreVarOpcode}(root.StoreOpcode),root.SwitchOpcode=function(_super){function SwitchOpcode(name,params){SwitchOpcode.__super__.constructor.call(this,name,params),this.byte_count=null}return __extends(SwitchOpcode,_super),SwitchOpcode.prototype.execute=function(rs){var key;throw key=rs.pop(),new BranchException(rs.curr_pc()+(this.offsets[key]!=null?this.offsets[key]:this._default))},SwitchOpcode}(root.BranchOpcode),root.LookupSwitchOpcode=function(_super){function LookupSwitchOpcode(){LookupSwitchOpcode.__super__.constructor.apply(this,arguments)}return __extends(LookupSwitchOpcode,_super),LookupSwitchOpcode.prototype.take_args=function(code_array,constant_pool){var match,offset,padding_size,_i,_ref;padding_size=(4-code_array.pos()%4)%4,code_array.skip(padding_size),this._default=code_array.get_int(4),this.npairs=code_array.get_int(4),this.offsets={};for(_i=0,_ref=this.npairs;0>_ref?_i>_ref:_i<_ref;0>_ref?_i--:_i++)match=code_array.get_int(4),offset=code_array.get_int(4),this.offsets[match]=offset;return this.byte_count=padding_size+8*(this.npairs+1)},LookupSwitchOpcode}(root.SwitchOpcode),root.TableSwitchOpcode=function(_super){function TableSwitchOpcode(){TableSwitchOpcode.__super__.constructor.apply(this,arguments)}return __extends(TableSwitchOpcode,_super),TableSwitchOpcode.prototype.take_args=function(code_array,constant_pool){var i,offset,padding_size,total_offsets;padding_size=(4-code_array.pos()%4)%4,code_array.skip(padding_size),this._default=code_array.get_int(4),this.low=code_array.get_int(4),this.high=code_array.get_int(4),this.offsets={},total_offsets=this.high-this.low+1;for(i=0;0>total_offsets?i>total_offsets:i<total_offsets;0>total_offsets?i--:i++)offset=code_array.get_int(4),this.offsets[this.low+i]=offset;return this.byte_count=padding_size+12+4*total_offsets},TableSwitchOpcode}(root.SwitchOpcode),root.NewArrayOpcode=function(_super){function NewArrayOpcode(name,params){NewArrayOpcode.__super__.constructor.call(this,name,params),this.byte_count=1,this.arr_types={4:"Z",5:"C",6:"F",7:"D",8:"B",9:"S",10:"I",11:"J"}}return __extends(NewArrayOpcode,_super),NewArrayOpcode.prototype.take_args=function(code_array,constant_pool){var type_code;return type_code=code_array.get_uint(1),this.element_type=this.arr_types[type_code]},NewArrayOpcode}(root.Opcode),root.MultiArrayOpcode=function(_super){function MultiArrayOpcode(name,params){params==null&&(params={}),params.byte_count==null&&(params.byte_count=3),MultiArrayOpcode.__super__.constructor.call(this,name,params)}return __extends(MultiArrayOpcode,_super),MultiArrayOpcode.prototype.take_args=function(code_array,constant_pool){return this.class_ref=code_array.get_uint(2),this["class"]=constant_pool.get(this.class_ref).deref(),this.dim=code_array.get_uint(1)},MultiArrayOpcode.prototype.execute=function(rs){var counts,init_arr,_this=this;return counts=rs.curr_frame().stack.splice(rs.length-this.dim),init_arr=function(curr_dim){var typestr;return curr_dim===_this.dim?0:(typestr=_this["class"].slice(curr_dim),rs.init_object(typestr,function(){var _i,_ref,_results;_results=[];for(_i=0,_ref=counts[curr_dim];0>_ref?_i>_ref:_i<_ref;0>_ref?_i--:_i++)_results.push(init_arr(curr_dim+1));return _results}()))},rs.push(init_arr(0))},MultiArrayOpcode}(root.Opcode),root.ArrayLoadOpcode=function(_super){function ArrayLoadOpcode(){ArrayLoadOpcode.__super__.constructor.apply(this,arguments)}return __extends(ArrayLoadOpcode,_super),ArrayLoadOpcode.prototype.execute=function(rs){var array,idx;idx=rs.pop(),array=rs.check_null(rs.pop()).array,(0>idx||idx>=array.length)&&java_throw(rs,"java/lang/ArrayIndexOutOfBoundsException",""+idx+" not in [0,"+array.length+")"),rs.push(array[idx]);if(this.name.match(/[ld]aload/))return rs.push(null)},ArrayLoadOpcode}(root.Opcode),towards_zero=function(a){return Math[a>0?"floor":"ceil"](a)},int_mod=function(rs,a,b){return b===0&&java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a%b},int_div=function(rs,a,b){return b===0&&java_throw(rs,"java/lang/ArithmeticException","/ by zero"),towards_zero(a/b)},long_mod=function(rs,a,b){return b.isZero()&&java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a.modulo(b)},long_div=function(rs,a,b){return b.isZero()&&java_throw(rs,"java/lang/ArithmeticException","/ by zero"),a.div(b)},float2int=function(a){var INT_MAX,INT_MIN;return INT_MAX=Math.pow(2,31)-1,INT_MIN=-Math.pow(2,31),a===NaN?0:a>INT_MAX?INT_MAX:a<INT_MIN?INT_MIN:a!==Infinity&&a!==-Infinity?towards_zero(a):a>0?INT_MAX:INT_MIN},truncate=function(a,n_bits){return a=(a+Math.pow(2,n_bits))%Math.pow(2,n_bits),util.uint2int(a,n_bits/8)},wrap_int=function(a){return truncate(a,32)},wrap_float=function(a){return a>3.4028234663852886e+38?Infinity:0<a&&a<1.401298464324817e-45?0:a<-3.4028234663852886e+38?-Infinity:0>a&&a>-1.401298464324817e-45?0:a},jsr=function(rs){throw rs.push(rs.curr_pc()+this.byte_count+1),new BranchException(rs.curr_pc()+this.offset)},root.opcodes={0:new root.Opcode("nop",{execute:function(){}}),1:new root.Opcode("aconst_null",{execute:function(rs){return rs.push(null)}}),2:new root.Opcode("iconst_m1",{execute:function(rs){return rs.push(-1)}}),3:new root.Opcode("iconst_0",{execute:function(rs){return rs.push(0)}}),4:new root.Opcode("iconst_1",{execute:function(rs){return rs.push(1)}}),5:new root.Opcode("iconst_2",{execute:function(rs){return rs.push(2)}}),6:new root.Opcode("iconst_3",{execute:function(rs){return rs.push(3)}}),7:new root.Opcode("iconst_4",{execute:function(rs){return rs.push(4)}}),8:new root.Opcode("iconst_5",{execute:function(rs){return rs.push(5)}}),9:new root.Opcode("lconst_0",{execute:function(rs){return rs.push(gLong.ZERO,null)}}),10:new root.Opcode("lconst_1",{execute:function(rs){return rs.push(gLong.ONE,null)}}),11:new root.Opcode("fconst_0",{execute:function(rs){return rs.push(0)}}),12:new root.Opcode("fconst_1",{execute:function(rs){return rs.push(1)}}),13:new root.Opcode("fconst_2",{execute:function(rs){return rs.push(2)}}),14:new root.Opcode("dconst_0",{execute:function(rs){return rs.push(0,null)}}),15:new root.Opcode("dconst_1",{execute:function(rs){return rs.push(1,null)}}),16:new root.PushOpcode("bipush",{byte_count:1}),17:new root.PushOpcode("sipush",{byte_count:2}),18:new root.LoadConstantOpcode("ldc",{byte_count:1}),19:new root.LoadConstantOpcode("ldc_w",{byte_count:2}),20:new root.LoadConstantOpcode("ldc2_w",{byte_count:2}),21:new root.LoadVarOpcode("iload"),22:new root.LoadVarOpcode("lload"),23:new root.LoadVarOpcode("fload"),24:new root.LoadVarOpcode("dload"),25:new root.LoadVarOpcode("aload"),26:new root.LoadOpcode("iload_0"),27:new root.LoadOpcode("iload_1"),28:new root.LoadOpcode("iload_2"),29:new root.LoadOpcode("iload_3"),30:new root.LoadOpcode("lload_0"),31:new root.LoadOpcode("lload_1"),32:new root.LoadOpcode("lload_2"),33:new root.LoadOpcode("lload_3"),34:new root.LoadOpcode("fload_0"),35:new root.LoadOpcode("fload_1"),36:new root.LoadOpcode("fload_2"),37:new root.LoadOpcode("fload_3"),38:new root.LoadOpcode("dload_0"),39:new root.LoadOpcode("dload_1"),40:new root.LoadOpcode("dload_2"),41:new root.LoadOpcode("dload_3"),42:new root.LoadOpcode("aload_0"),43:new root.LoadOpcode("aload_1"),44:new root.LoadOpcode("aload_2"),45:new root.LoadOpcode("aload_3"),46:new root.ArrayLoadOpcode("iaload"),47:new root.ArrayLoadOpcode("laload"),48:new root.ArrayLoadOpcode("faload"),49:new root.ArrayLoadOpcode("daload"),50:new root.ArrayLoadOpcode("aaload"),51:new root.ArrayLoadOpcode("baload"),52:new root.ArrayLoadOpcode("caload"),53:new root.ArrayLoadOpcode("saload"),54:new root.StoreVarOpcode("istore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),55:new root.StoreVarOpcode("lstore",{execute:function(rs){return rs.put_cl2(this.var_num,rs.pop2())}}),56:new root.StoreVarOpcode("fstore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),57:new root.StoreVarOpcode("dstore",{execute:function(rs){return rs.put_cl2(this.var_num,rs.pop2())}}),58:new root.StoreVarOpcode("astore",{execute:function(rs){return rs.put_cl(this.var_num,rs.pop())}}),59:new root.StoreOpcode("istore_0"),60:new root.StoreOpcode("istore_1"),61:new root.StoreOpcode("istore_2"),62:new root.StoreOpcode("istore_3"),63:new root.StoreOpcode("lstore_0"),64:new root.StoreOpcode("lstore_1"),65:new root.StoreOpcode("lstore_2"),66:new root.StoreOpcode("lstore_3"),67:new root.StoreOpcode("fstore_0"),68:new root.StoreOpcode("fstore_1"),69:new root.StoreOpcode("fstore_2"),70:new root.StoreOpcode("fstore_3"),71:new root.StoreOpcode("dstore_0"),72:new root.StoreOpcode("dstore_1"),73:new root.StoreOpcode("dstore_2"),74:new root.StoreOpcode("dstore_3"),75:new root.StoreOpcode("astore_0"),76:new root.StoreOpcode("astore_1"),77:new root.StoreOpcode("astore_2"),78:new root.StoreOpcode("astore_3"),79:new root.Opcode("iastore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),80:new root.Opcode("lastore",{execute:function(rs){var i,v;return v=rs.pop2(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),81:new root.Opcode("fastore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),82:new root.Opcode("dastore",{execute:function(rs){var i,v;return v=rs.pop2(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),83:new root.Opcode("aastore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),84:new root.Opcode("bastore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),85:new root.Opcode("castore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),86:new root.Opcode("sastore",{execute:function(rs){var i,v;return v=rs.pop(),i=rs.pop(),rs.check_null(rs.pop()).array[i]=v}}),87:new root.Opcode("pop",{execute:function(rs){return rs.pop()}}),88:new root.Opcode("pop2",{execute:function(rs){return rs.pop2()}}),89:new root.Opcode("dup",{execute:function(rs){var v;return v=rs.pop(),rs.push(v,v)}}),90:new root.Opcode("dup_x1",{execute:function(rs){var v1,v2;return v1=rs.pop(),v2=rs.pop(),rs.push(v1,v2,v1)}}),91:new root.Opcode("dup_x2",{execute:function(rs){var v1,v2,v3,_ref;return _ref=[rs.pop(),rs.pop(),rs.pop()],v1=_ref[0],v2=_ref[1],v3=_ref[2],rs.push(v1,v3,v2,v1)}}),92:new root.Opcode("dup2",{execute:function(rs){var v1,v2;return v1=rs.pop(),v2=rs.pop(),rs.push(v2,v1,v2,v1)}}),93:new root.Opcode("dup2_x1",{execute:function(rs){var v1,v2,v3,_ref;return _ref=[rs.pop(),rs.pop(),rs.pop()],v1=_ref[0],v2=_ref[1],v3=_ref[2],rs.push(v2,v1,v3,v2,v1)}}),94:new root.Opcode("dup2_x2",{execute:function(rs){var v1,v2,v3,v4,_ref;return _ref=[rs.pop(),rs.pop(),rs.pop(),rs.pop()],v1=_ref[0],v2=_ref[1],v3=_ref[2],v4=_ref[3],rs.push(v2,v1,v4,v3,v2,v1)}}),95:new root.Opcode("swap",{execute:function(rs){var v1,v2;return v2=rs.pop(),v1=rs.pop(),rs.push(v2,v1)}}),96:new root.Opcode("iadd",{execute:function(rs){return rs.push(wrap_int(rs.pop()+rs.pop()))}}),97:new root.Opcode("ladd",{execute:function(rs){return rs.push(rs.pop2().add(rs.pop2()),null)}}),98:new root.Opcode("fadd",{execute:function(rs){return rs.push(wrap_float(rs.pop()+rs.pop()))}}),99:new root.Opcode("dadd",{execute:function(rs){return rs.push(rs.pop2()+rs.pop2(),null)}}),100:new root.Opcode("isub",{execute:function(rs){return rs.push(wrap_int(-rs.pop()+rs.pop()))}}),101:new root.Opcode("lsub",{execute:function(rs){return rs.push(rs.pop2().negate().add(rs.pop2()),null)}}),102:new root.Opcode("fsub",{execute:function(rs){return rs.push(wrap_float(-rs.pop()+rs.pop()))}}),103:new root.Opcode("dsub",{execute:function(rs){return rs.push(-rs.pop2()+rs.pop2(),null)}}),104:new root.Opcode("imul",{execute:function(rs){return rs.push(gLong.fromInt(rs.pop()).multiply(gLong.fromInt(rs.pop())).toInt())}}),105:new root.Opcode("lmul",{execute:function(rs){return rs.push(rs.pop2().multiply(rs.pop2()),null)}}),106:new root.Opcode("fmul",{execute:function(rs){return rs.push(wrap_float(rs.pop()*rs.pop()))}}),107:new root.Opcode("dmul",{execute:function(rs){return rs.push(rs.pop2()*rs.pop2(),null)}}),108:new root.Opcode("idiv",{execute:function(rs){var v;return v=rs.pop(),rs.push(int_div(rs,rs.pop(),v))}}),109:new root.Opcode("ldiv",{execute:function(rs){var v;return v=rs.pop2(),rs.push(long_div(rs,rs.pop2(),v),null)}}),110:new root.Opcode("fdiv",{execute:function(rs){var v;return v=rs.pop(),rs.push(wrap_float(rs.pop()/v))}}),111:new root.Opcode("ddiv",{execute:function(rs){var v;return v=rs.pop2(),rs.push(rs.pop2()/v,null)}}),112:new root.Opcode("irem",{execute:function(rs){var v2;return v2=rs.pop(),rs.push(int_mod(rs,rs.pop(),v2))}}),113:new root.Opcode("lrem",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push(long_mod(rs,rs.pop2(),v2),null)}}),114:new root.Opcode("frem",{execute:function(rs){var v2;return v2=rs.pop(),rs.push(rs.pop()%v2)}}),115:new root.Opcode("drem",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push(rs.pop2()%v2,null)}}),116:new root.Opcode("ineg",{execute:function(rs){return rs.push(-rs.pop())}}),117:new root.Opcode("lneg",{execute:function(rs){return rs.push(rs.pop2().negate(),null)}}),118:new root.Opcode("fneg",{execute:function(rs){return rs.push(-rs.pop())}}),119:new root.Opcode("dneg",{execute:function(rs){return rs.push(-rs.pop2(),null)}}),120:new root.Opcode("ishl",{execute:function(rs){var s;return s=rs.pop()&31,rs.push(rs.pop()<<s)}}),121:new root.Opcode("lshl",{execute:function(rs){var s;return s=rs.pop()&63,rs.push(rs.pop2().shiftLeft(gLong.fromInt(s)),null)}}),122:new root.Opcode("ishr",{execute:function(rs){var s;return s=rs.pop()&31,rs.push(rs.pop()>>s)}}),123:new root.Opcode("lshr",{execute:function(rs){var s;return s=rs.pop()&63,rs.push(rs.pop2().shiftRight(gLong.fromInt(s)),null)}}),124:new root.Opcode("iushr",{execute:function(rs){var s;return s=rs.pop()&31,rs.push(rs.pop()>>>s)}}),125:new root.Opcode("lushr",{execute:function(rs){var s;return s=rs.pop()&63,rs.push(rs.pop2().shiftRightUnsigned(gLong.fromInt(s)),null)}}),126:new root.Opcode("iand",{execute:function(rs){return rs.push(rs.pop()&rs.pop())}}),127:new root.Opcode("land",{execute:function(rs){return rs.push(rs.pop2().and(rs.pop2()),null)}}),128:new root.Opcode("ior",{execute:function(rs){return rs.push(rs.pop()|rs.pop())}}),129:new root.Opcode("lor",{execute:function(rs){return rs.push(rs.pop2().or(rs.pop2()),null)}}),130:new root.Opcode("ixor",{execute:function(rs){return rs.push(rs.pop()^rs.pop())}}),131:new root.Opcode("lxor",{execute:function(rs){return rs.push(rs.pop2().xor(rs.pop2()),null)}}),132:new root.IIncOpcode("iinc"),133:new root.Opcode("i2l",{execute:function(rs){return rs.push(gLong.fromNumber(rs.pop()),null)}}),134:new root.Opcode("i2f",{execute:function(rs){}}),135:new root.Opcode("i2d",{execute:function(rs){return rs.push(null)}}),136:new root.Opcode("l2i",{execute:function(rs){return rs.push(rs.pop2().toInt())}}),137:new root.Opcode("l2f",{execute:function(rs){return rs.push(rs.pop2().toNumber())}}),138:new root.Opcode("l2d",{execute:function(rs){return rs.push(rs.pop2().toNumber(),null)}}),139:new root.Opcode("f2i",{execute:function(rs){return rs.push(float2int(rs.pop()))}}),140:new root.Opcode("f2l",{execute:function(rs){return rs.push(gLong.fromNumber(rs.pop()),null)}}),141:new root.Opcode("f2d",{execute:function(rs){return rs.push(null)}}),142:new root.Opcode("d2i",{execute:function(rs){return rs.push(float2int(rs.pop2()))}}),143:new root.Opcode("d2l",{execute:function(rs){return rs.push(gLong.fromNumber(rs.pop2()),null)}}),144:new root.Opcode("d2f",{execute:function(rs){return rs.push(wrap_float(rs.pop2()))}}),145:new root.Opcode("i2b",{execute:function(rs){return rs.push(truncate(rs.pop(),8))}}),146:new root.Opcode("i2c",{execute:function(rs){return rs.push(truncate(rs.pop(),8))}}),147:new root.Opcode("i2s",{execute:function(rs){return rs.push(truncate(rs.pop(),16))}}),148:new root.Opcode("lcmp",{execute:function(rs){var v2;return v2=rs.pop2(),rs.push(rs.pop2().compare(v2))}}),149:new root.Opcode("fcmpl",{execute:function(rs){var v2,_ref;return v2=rs.pop(),rs.push((_ref=util.cmp(rs.pop(),v2))!=null?_ref:-1)}}),150:new root.Opcode("fcmpg",{execute:function(rs){var v2,_ref;return v2=rs.pop(),rs.push((_ref=util.cmp(rs.pop(),v2))!=null?_ref:1)}}),151:new root.Opcode("dcmpl",{execute:function(rs){var v2,_ref;return v2=rs.pop2(),rs.push((_ref=util.cmp(rs.pop2(),v2))!=null?_ref:-1)}}),152:new root.Opcode("dcmpg",{execute:function(rs){var v2,_ref;return v2=rs.pop2(),rs.push((_ref=util.cmp(rs.pop2(),v2))!=null?_ref:1)}}),153:new root.UnaryBranchOpcode("ifeq",{cmp:function(v){return v===0}}),154:new root.UnaryBranchOpcode("ifne",{cmp:function(v){return v!==0}}),155:new root.UnaryBranchOpcode("iflt",{cmp:function(v){return v<0}}),156:new root.UnaryBranchOpcode("ifge",{cmp:function(v){return v>=0}}),157:new root.UnaryBranchOpcode("ifgt",{cmp:function(v){return v>0}}),158:new root.UnaryBranchOpcode("ifle",{cmp:function(v){return v<=0}}),159:new root.BinaryBranchOpcode("if_icmpeq",{cmp:function(v1,v2){return v1===v2}}),160:new root.BinaryBranchOpcode("if_icmpne",{cmp:function(v1,v2){return v1!==v2}}),161:new root.BinaryBranchOpcode("if_icmplt",{cmp:function(v1,v2){return v1<v2}}),162:new root.BinaryBranchOpcode("if_icmpge",{cmp:function(v1,v2){return v1>=v2}}),163:new root.BinaryBranchOpcode("if_icmpgt",{cmp:function(v1,v2){return v1>v2}}),164:new root.BinaryBranchOpcode("if_icmple",{cmp:function(v1,v2){return v1<=v2}}),165:new root.BinaryBranchOpcode("if_acmpeq",{cmp:function(v1,v2){return v1===v2}}),166:new root.BinaryBranchOpcode("if_acmpne",{cmp:function(v1,v2){return v1!==v2}}),167:new root.BranchOpcode("goto",{execute:function(rs){throw new BranchException(rs.curr_pc()+this.offset)}}),168:new root.BranchOpcode("jsr",{execute:jsr}),169:new root.Opcode("ret",{byte_count:1,execute:function(rs){throw new BranchException(rs.cl(this.args[0]))}}),170:new root.TableSwitchOpcode("tableswitch"),171:new root.LookupSwitchOpcode("lookupswitch"),172:new root.Opcode("ireturn",{execute:function(rs){throw new ReturnException(rs.curr_frame().stack[0])}}),173:new root.Opcode("lreturn",{execute:function(rs){throw new ReturnException(rs.curr_frame().stack[0],null)}}),174:new root.Opcode("freturn",{execute:function(rs){throw new ReturnException(rs.curr_frame().stack[0])}}),175:new root.Opcode("dreturn",{execute:function(rs){throw new ReturnException(rs.curr_frame().stack[0],null)}}),176:new root.Opcode("areturn",{execute:function(rs){throw new ReturnException(rs.curr_frame().stack[0])}}),177:new root.Opcode("return",{execute:function(rs){throw rs.curr_frame().stack.length>0?Error("too many values on stack for void return"):new ReturnException}}),178:new root.FieldOpcode("getstatic",{execute:function(rs){var _ref;rs.push(rs.static_get(this.field_spec));if((_ref=this.field_spec.type)==="J"||_ref==="D")return rs.push(null)}}),179:new root.FieldOpcode("putstatic",{execute:function(rs){return rs.static_put(this.field_spec)}}),180:new root.FieldOpcode("getfield",{execute:function(rs){return rs.heap_get(this.field_spec,rs.pop())}}),181:new root.FieldOpcode("putfield",{execute:function(rs){return rs.heap_put(this.field_spec)}}),182:new root.InvokeOpcode("invokevirtual",{execute:function(rs){return rs.method_lookup(this.method_spec).run(rs,!0)}}),183:new root.InvokeOpcode("invokespecial",{execute:function(rs){return rs.method_lookup(this.method_spec).run(rs)}}),184:new root.InvokeOpcode("invokestatic",{execute:function(rs){return rs.method_lookup(this.method_spec).run(rs)}}),185:new root.InvokeOpcode("invokeinterface",{execute:function(rs){return rs.method_lookup(this.method_spec).run(rs,!0)}}),187:new root.ClassOpcode("new",{execute:function(rs){return rs.push(rs.init_object(this["class"]))}}),188:new root.NewArrayOpcode("newarray",{execute:function(rs){return rs.push(rs.heap_newarray(this.element_type,rs.pop()))}}),189:new root.ClassOpcode("anewarray",{execute:function(rs){return rs.push(rs.heap_newarray("L"+this["class"]+";",rs.pop()))}}),190:new root.Opcode("arraylength",{execute:function(rs){return rs.push(rs.check_null(rs.pop()).array.length)}}),191:new root.Opcode("athrow",{execute:function(rs){throw new JavaException(rs,rs.pop())}}),192:new root.ClassOpcode("checkcast",{execute:function(rs){var candidate_class,o,target_class;return o=rs.pop(),o==null||types.check_cast(rs,o,this["class"])?rs.push(o):(target_class=c2t(this["class"]).toExternalString(),candidate_class=o!=null?o.type.toExternalString():"null",java_throw(rs,"java/lang/ClassCastException",""+candidate_class+" cannot be cast to "+target_class))}}),193:new root.ClassOpcode("instanceof",{execute:function(rs){var o;return o=rs.pop(),rs.push(o!=null?types.check_cast(rs,o,this["class"])+0:0)}}),194:new root.Opcode("monitorenter",{execute:function(rs){return rs.pop()}}),195:new root.Opcode("monitorexit",{execute:function(rs){return rs.pop()}}),197:new root.MultiArrayOpcode("multianewarray"),198:new root.UnaryBranchOpcode("ifnull",{cmp:function(v){return v==null}}),199:new root.UnaryBranchOpcode("ifnonnull",{cmp:function(v){return v!=null}}),200:new root.BranchOpcode("goto_w",{byte_count:4,execute:function(rs){throw new BranchException(rs.curr_pc()+this.offset)}}),201:new root.BranchOpcode("jsr_w",{byte_count:4,execute:jsr})}}.call(this),function(){var Code,ConstantValue,ExceptionHandler,Exceptions,InnerClasses,LineNumberTable,LocalVariableTable,SourceFile,StackMapTable,Synthetic,root,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof opcodes=="undefined"||opcodes===null)opcodes=require("./opcodes");root=this,ExceptionHandler=function(){function ExceptionHandler(){}return ExceptionHandler.prototype.parse=function(bytes_array,constant_pool){var cti;return this.start_pc=bytes_array.get_uint(2),this.end_pc=bytes_array.get_uint(2),this.handler_pc=bytes_array.get_uint(2),cti=bytes_array.get_uint(2),this.catch_type=cti===0?"<any>":constant_pool.get(cti).deref(),bytes_array},ExceptionHandler}(),Code=function(){function Code(){}return Code.prototype.parse=function(bytes_array,constant_pool){var code_array,eh,except_len,_i,_len,_ref;this.max_stack=bytes_array.get_uint(2),this.max_locals=bytes_array.get_uint(2),this.code_len=bytes_array.get_uint(4);if(this.code_len===0)throw"Attribute._parse_code: Code length is zero";code_array=bytes_array.splice(this.code_len),this.opcodes=this.parse_code(code_array,constant_pool),except_len=bytes_array.get_uint(2),this.exception_handlers=function(){var _i,_results;_results=[];for(_i=0;0>except_len?_i>except_len:_i<except_len;0>except_len?_i--:_i++)_results.push(new ExceptionHandler);return _results}(),_ref=this.exception_handlers;for(_i=0,_len=_ref.length;_i<_len;_i++)eh=_ref[_i],bytes_array=eh.parse(bytes_array,constant_pool);return this.attrs=root.make_attributes(bytes_array,constant_pool),bytes_array},Code.prototype.parse_code=function(bytes_array,constant_pool){var c,op,op_index,rv,wide;rv=Array(this.code_len);while(bytes_array.has_bytes()){op_index=bytes_array.pos(),c=bytes_array.get_uint(1),wide=c===196,wide&&(c=bytes_array.get_uint(1));if(opcodes.opcodes[c]==null)throw"unknown opcode code: "+c;op=Object.create(opcodes.opcodes[c]),op.take_args(bytes_array,constant_pool,wide),rv[op_index]=op}return rv},Code.prototype.each_opcode=function(fn){var i,_ref,_results;_results=[];for(i=0,_ref=this.code_len;0>_ref?i>=_ref:i<=_ref;0>_ref?i--:i++)i in this.opcodes&&_results.push(fn(i,this.opcodes[i]));return _results},Code}(),LineNumberTable=function(_super){function LineNumberTable(){LineNumberTable.__super__
.constructor.apply(this,arguments)}return __extends(LineNumberTable,_super),LineNumberTable.prototype.parse=function(bytes_array,constant_pool){var ln,lnt_len,spc,_i;lnt_len=bytes_array.get_uint(2);for(_i=0;0>lnt_len?_i>lnt_len:_i<lnt_len;0>lnt_len?_i--:_i++)spc=bytes_array.get_uint(2),ln=bytes_array.get_uint(2),this.push({start_pc:spc,line_number:ln});return bytes_array},LineNumberTable}(Array),SourceFile=function(){function SourceFile(){}return SourceFile.prototype.parse=function(bytes_array,constant_pool){return this.name=constant_pool.get(bytes_array.get_uint(2)).value,bytes_array},SourceFile}(),StackMapTable=function(){function StackMapTable(){}return StackMapTable.prototype.parse=function(bytes_array,constant_pool){var i,parse_entries,parse_verification_type_info;return parse_entries=function(){var frame_type,i,num_locals,num_stack_items;frame_type=bytes_array.get_uint(1);if(0<=frame_type&&frame_type<64)return{frame_type:frame_type,frame_name:"same"};if(64<=frame_type&&frame_type<128)return{frame_type:frame_type,frame_name:"same_locals_1_stack_item",stack:parse_verification_type_info()};if(128>frame_type||frame_type>=247){if(frame_type===247)return{frame_type:frame_type,frame_name:"same_locals_1_stack_item_extended",offset_delta:bytes_array.get_uint(2),stack:parse_verification_type_info()};if(248<=frame_type&&frame_type<251)return{frame_type:frame_type,frame_name:"chop",offset_delta:bytes_array.get_uint(2)};if(frame_type===251)return{frame_type:frame_type,frame_name:"same_frame_extended",offset_delta:bytes_array.get_uint(2)};if(252<=frame_type&&frame_type<255)return{frame_type:frame_type,frame_name:"append",offset_delta:bytes_array.get_uint(2),locals:function(){var _ref,_results;_results=[];for(i=0,_ref=frame_type-251;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(parse_verification_type_info());return _results}()};if(frame_type===255)return{frame_type:frame_type,frame_name:"full_frame",offset_delta:bytes_array.get_uint(2),num_locals:num_locals=bytes_array.get_uint(2),locals:function(){var _results;_results=[];for(i=0;0>num_locals?i>num_locals:i<num_locals;0>num_locals?i--:i++)_results.push(parse_verification_type_info());return _results}(),num_stack_items:num_stack_items=bytes_array.get_uint(2),stack:function(){var _results;_results=[];for(i=0;0>num_stack_items?i>num_stack_items:i<num_stack_items;0>num_stack_items?i--:i++)_results.push(parse_verification_type_info());return _results}()}}},parse_verification_type_info=function(){var cls,tag,tag_to_type;return tag=bytes_array.get_uint(1),tag===7?(cls=constant_pool.get(bytes_array.get_uint(2)).deref(),"class "+(/\w/.test(cls[0])?cls:'"'+cls+'"')):(tag_to_type=["bogus","int","float","double","long","null","this","object","uninitialized"],tag_to_type[tag])},this.num_entries=bytes_array.get_uint(2),this.entries=function(){var _ref,_results;_results=[];for(i=0,_ref=this.num_entries;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(parse_entries());return _results}.call(this),bytes_array},StackMapTable}(),LocalVariableTable=function(){function LocalVariableTable(){}return LocalVariableTable.prototype.parse=function(bytes_array,constant_pool){var i;return this.num_entries=bytes_array.get_uint(2),this.entries=function(){var _ref,_results;_results=[];for(i=0,_ref=this.num_entries;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(this.parse_entries(bytes_array,constant_pool));return _results}.call(this),bytes_array},LocalVariableTable.prototype.parse_entries=function(bytes_array,constant_pool){return{start_pc:bytes_array.get_uint(2),length:bytes_array.get_uint(2),name:constant_pool.get(bytes_array.get_uint(2)).value,descriptor:constant_pool.get(bytes_array.get_uint(2)).value,ref:bytes_array.get_uint(2)}},LocalVariableTable}(),Exceptions=function(){function Exceptions(){}return Exceptions.prototype.parse=function(bytes_array,constant_pool){var exc_refs,i,ref;return this.num_exceptions=bytes_array.get_uint(2),exc_refs=function(){var _ref,_results;_results=[];for(i=0,_ref=this.num_exceptions;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(bytes_array.get_uint(2));return _results}.call(this),this.exceptions=function(){var _i,_len,_results;_results=[];for(_i=0,_len=exc_refs.length;_i<_len;_i++)ref=exc_refs[_i],_results.push(constant_pool.get(ref).deref());return _results}(),bytes_array},Exceptions}(),InnerClasses=function(){function InnerClasses(){}return InnerClasses.prototype.parse=function(bytes_array,constant_pool){var i,num_classes;return num_classes=bytes_array.get_uint(2),this.classes=function(){var _results;_results=[];for(i=0;0>num_classes?i>num_classes:i<num_classes;0>num_classes?i--:i++)_results.push(this.parse_class(bytes_array,constant_pool));return _results}.call(this),bytes_array},InnerClasses.prototype.parse_class=function(bytes_array,constant_pool){return{inner_info_index:bytes_array.get_uint(2),outer_info_index:bytes_array.get_uint(2),inner_name_index:bytes_array.get_uint(2),inner_access_flags:bytes_array.get_uint(2)}},InnerClasses}(),ConstantValue=function(){function ConstantValue(){}return ConstantValue.prototype.parse=function(bytes_array,constant_pool){return this.ref=bytes_array.get_uint(2),this.value=constant_pool.get(this.ref).value,bytes_array},ConstantValue}(),Synthetic=function(){function Synthetic(){}return Synthetic.prototype.parse=function(bytes_array){return bytes_array},Synthetic}(),root.make_attributes=function(bytes_array,constant_pool){var attr,attr_len,attr_types,attrs,name,new_len,num_attrs,old_len,_i;attr_types={Code:Code,LineNumberTable:LineNumberTable,SourceFile:SourceFile,StackMapTable:StackMapTable,LocalVariableTable:LocalVariableTable,ConstantValue:ConstantValue,Exceptions:Exceptions,InnerClasses:InnerClasses,Synthetic:Synthetic},num_attrs=bytes_array.get_uint(2),attrs=[];for(_i=0;0>num_attrs?_i>num_attrs:_i<num_attrs;0>num_attrs?_i--:_i++)name=constant_pool.get(bytes_array.get_uint(2)).value,attr_len=bytes_array.get_uint(4),attr_types[name]!=null?(attr=new attr_types[name],old_len=bytes_array.size(),bytes_array=attr.parse(bytes_array,constant_pool),new_len=bytes_array.size(),old_len-new_len!==attr_len&&bytes_array.skip(attr_len-old_len+new_len),attrs.push(attr)):bytes_array.skip(attr_len);return attrs},typeof module!="undefined"&&module!==null&&(module.exports=root.make_attributes)}.call(this),function(){var AbstractMethodFieldReference,ClassReference,ConstDouble,ConstFloat,ConstInt32,ConstLong,ConstString,FieldReference,InterfaceMethodReference,MethodReference,MethodSignature,SimpleReference,StringReference,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof gLong=="undefined"||gLong===null)gLong=require("../third_party/gLong.js");if(typeof util=="undefined"||util===null)util=require("./util");SimpleReference=function(){function SimpleReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value}return SimpleReference.from_bytes=function(bytes_array,constant_pool){var ref,value;return value=bytes_array.get_uint(2),ref=new this(constant_pool,value),[ref,1,bytes_array]},SimpleReference.prototype.deref=function(){var pool_obj;return pool_obj=this.constant_pool[this.value],(typeof pool_obj.deref=="function"?pool_obj.deref():void 0)||pool_obj.value},SimpleReference}(),ClassReference=function(_super){function ClassReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="class"}return __extends(ClassReference,_super),ClassReference}(SimpleReference),StringReference=function(_super){function StringReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="String"}return __extends(StringReference,_super),StringReference}(SimpleReference),AbstractMethodFieldReference=function(){function AbstractMethodFieldReference(){}return AbstractMethodFieldReference.from_bytes=function(bytes_array,constant_pool){var class_ref,ref,sig,tmp,_ref,_ref2;return _ref=ClassReference.from_bytes(bytes_array,constant_pool),class_ref=_ref[0],tmp=_ref[1],bytes_array=_ref[2],_ref2=SimpleReference.from_bytes(bytes_array,constant_pool),sig=_ref2[0],tmp=_ref2[1],bytes_array=_ref2[2],ref=new this(constant_pool,{class_ref:class_ref,sig:sig}),[ref,1,bytes_array]},AbstractMethodFieldReference.prototype.deref=function(){var sig;return sig=this.value.sig.deref(),{"class":this.value.class_ref.deref(),sig:sig.name+sig.type}},AbstractMethodFieldReference}(),MethodReference=function(_super){function MethodReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="Method"}return __extends(MethodReference,_super),MethodReference}(AbstractMethodFieldReference),InterfaceMethodReference=function(_super){function InterfaceMethodReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="InterfaceMethod"}return __extends(InterfaceMethodReference,_super),InterfaceMethodReference}(AbstractMethodFieldReference),FieldReference=function(_super){function FieldReference(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="Field"}return __extends(FieldReference,_super),FieldReference.prototype.deref=function(){var sig;return sig=this.value.sig.deref(),{"class":this.value.class_ref.deref(),name:sig.name,type:sig.type}},FieldReference}(AbstractMethodFieldReference),MethodSignature=function(){function MethodSignature(constant_pool,value){this.constant_pool=constant_pool,this.value=value,this.type="NameAndType"}return MethodSignature.from_bytes=function(bytes_array,constant_pool){var meth_ref,ref,tmp,type_ref,_ref,_ref2;return _ref=StringReference.from_bytes(bytes_array,constant_pool),meth_ref=_ref[0],tmp=_ref[1],bytes_array=_ref[2],_ref2=StringReference.from_bytes(bytes_array,constant_pool),type_ref=_ref2[0],tmp=_ref2[1],bytes_array=_ref2[2],ref=new this(constant_pool,{meth_ref:meth_ref,type_ref:type_ref}),[ref,1,bytes_array]},MethodSignature.prototype.deref=function(){return{name:this.value.meth_ref.deref(),type:this.value.type_ref.deref()}},MethodSignature}(),ConstString=function(){function ConstString(value){this.value=value,this.type="Asciz"}return ConstString.from_bytes=function(bytes_array){var const_string,strlen,value;return strlen=bytes_array.get_uint(2),value=util.bytes2str(bytes_array.read(strlen)),const_string=new this(value),[const_string,1,bytes_array]},ConstString}(),ConstInt32=function(){function ConstInt32(value){this.value=value,this.type="int"}return ConstInt32.from_bytes=function(bytes_array){var int32,uint32,value;return uint32=bytes_array.get_uint(4),value=-(1+~uint32),int32=new this(value),[int32,1,bytes_array]},ConstInt32}(),ConstFloat=function(){function ConstFloat(value){this.value=value,this.type="float"}return ConstFloat.from_bytes=function(bytes_array){var exponent,float,sign,significand,uint32,value;return uint32=bytes_array.get_uint(4),sign=(uint32&2147483648)>>>31,exponent=(uint32&2139095040)>>>23,significand=uint32&8388607,exponent===0?value=Math.pow(-1,sign)*significand*Math.pow(2,-149):value=Math.pow(-1,sign)*(1+significand*Math.pow(2,-23))*Math.pow(2,exponent-127),float=new this(value),[float,1,bytes_array]},ConstFloat}(),ConstLong=function(){function ConstLong(value){this.value=value,this.type="long"}return ConstLong.from_bytes=function(bytes_array){var high,long,low,value;return high=bytes_array.get_uint(4),low=bytes_array.get_uint(4),value=gLong.fromBits(low,high),long=new this(value),[long,2,bytes_array]},ConstLong}(),ConstDouble=function(){function ConstDouble(value){this.value=value,this.type="double"}return ConstDouble.from_bytes=function(bytes_array){var double,exponent,sign,significand,uint32_a,uint32_b,value;return uint32_a=bytes_array.get_uint(4),uint32_b=bytes_array.get_uint(4),sign=(uint32_a&2147483648)>>>31,exponent=(uint32_a&2146435072)>>>20,significand=util.lshift(uint32_a&1048575,32)+uint32_b,exponent===0?value=Math.pow(-1,sign)*significand*Math.pow(2,-1074):value=Math.pow(-1,sign)*(1+significand*Math.pow(2,-52))*Math.pow(2,exponent-1023),double=new this(value),[double,2,bytes_array]},ConstDouble}(),this.ConstantPool=function(){function ConstantPool(){}return ConstantPool.prototype.parse=function(bytes_array){var constant_tags,idx,pool_obj,size,tag,_ref;constant_tags={1:ConstString,3:ConstInt32,4:ConstFloat,5:ConstLong,6:ConstDouble,7:ClassReference,8:StringReference,9:FieldReference,10:MethodReference,11:InterfaceMethodReference,12:MethodSignature},this.cp_count=bytes_array.get_uint(2),this.constant_pool={},idx=1;while(idx<this.cp_count){tag=bytes_array.get_uint(1);if(1>tag||tag>12)throw"invalid tag: "+tag;_ref=constant_tags[tag].from_bytes(bytes_array,this.constant_pool),pool_obj=_ref[0],size=_ref[1],bytes_array=_ref[2],this.constant_pool[idx]=pool_obj,idx+=size}return bytes_array},ConstantPool.prototype.get=function(idx){var _ref;return function(){if((_ref=this.constant_pool[idx])!=null)return _ref;throw Error("Invalid constant_pool reference: "+idx)}.call(this)},ConstantPool.prototype.each=function(fn){var i,_ref,_results;_results=[];for(i=0,_ref=this.cp_count;0>_ref?i>=_ref:i<=_ref;0>_ref?i--:i++)i in this.constant_pool&&_results.push(fn(i,this.constant_pool[i]));return _results},ConstantPool}(),typeof module!="undefined"&&module!==null&&(module.exports=this.ConstantPool)}.call(this),function(){var escape_whitespace,format_extra_info,primitive_types,root;root=typeof exports!="undefined"&&exports!==null?exports:this.disassembler={};if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof opcodes=="undefined"||opcodes===null)opcodes=require("./opcodes");root.disassemble=function(class_file){var access,access_string,attr,cls,code,const_attr,eh,entry,exc_attr,f,fixed_width,flags,format,format_decimal,i,icls,ifaces,inner_classes,item,m,p,pool,pp_type,print_excs,ret_type,rv,sig,source_file,_i,_j,_k,_l,_len,_len2,_len3,_len4,_len5,_len6,_len7,_len8,_m,_n,_o,_p,_ref,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;access_string=function(access_flags){var flag,ordered_flags,privacy;return ordered_flags=["public","protected","private","static","final"],access_flags.interface||ordered_flags.push("abstract"),privacy=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ordered_flags.length;_i<_len;_i++)flag=ordered_flags[_i],_results.push(access_flags[flag]?""+flag+" ":void 0);return _results}().join("")},source_file=_.find(class_file.attrs,function(attr){return attr.constructor.name==="SourceFile"}),ifaces=function(){var _i,_len,_ref,_results;_ref=class_file.interfaces,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)i=_ref[_i],_results.push(class_file.constant_pool.get(i).deref());return _results}(),ifaces=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)i=ifaces[_i],_results.push(util.is_string(i)?i:i.toExternalString());return _results}().join(","),rv='Compiled from "'+source_file.name+'"\n',rv+=access_string(class_file.access_flags),class_file.access_flags.interface?rv+="interface "+class_file.this_class.toExternalString()+" extends "+ifaces+"\n":(rv+="class "+class_file.this_class.toExternalString()+" extends "+class_file.super_class.toExternalString(),rv+=ifaces&&!class_file.access_flags.interface?" implements "+ifaces+"\n":"\n"),source_file&&(rv+='  SourceFile: "'+source_file.name+'"\n'),inner_classes=function(){var _i,_len,_ref,_results;_ref=class_file.attrs,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)attr=_ref[_i],attr.constructor.name==="InnerClasses"&&_results.push(attr);return _results}();for(_i=0,_len=inner_classes.length;_i<_len;_i++){icls=inner_classes[_i],rv+="  InnerClass:\n",_ref=icls.classes;for(_j=0,_len2=_ref.length;_j<_len2;_j++)cls=_ref[_j],flags=util.parse_flags(cls.inner_access_flags),access=function(){var _k,_len3,_ref2,_results;_ref2=["public","protected","private","abstract"],_results=[];for(_k=0,_len3=_ref2.length;_k<_len3;_k++)f=_ref2[_k],_results.push(flags[f]?f+" ":void 0);return _results}().join(""),cls.outer_info_index>0?rv+="   "+access+"#"+cls.inner_name_index+"= #"+cls.inner_info_index+" of #"+cls.outer_info_index+";\n":rv+="   "+access+"#"+cls.inner_info_index+";\n"}rv+="  minor version: "+class_file.minor_version+"\n",rv+="  major version: "+class_file.major_version+"\n",rv+="  Constant pool:\n",format_decimal=function(val,type_char){var m,str,_ref2;return m=(val+"").match(/(-?\d+)(\.\d+)?(?:e\+?(-?\d+))?/),str=m[1]+(m[2]?m[2]:".0"),type_char==="f"&&((_ref2=m[2])!=null?_ref2.length:void 0)>8&&(str=parseFloat(str).toFixed(7)),str=str.replace(/0+$/,"").replace(/\.$/,".0"),m[3]!=null&&(str+="E"+m[3]),str+type_char},format=function(entry){var val;val=entry.value;switch(entry.type){case"Method":case"InterfaceMethod":case"Field":return"#"+val.class_ref.value+".#"+val.sig.value;case"NameAndType":return"#"+val.meth_ref.value+":#"+val.type_ref.value;case"float":return format_decimal(val,"f");case"double":return format_decimal(val,"d");case"long":return val+"l";default:return escape_whitespace((entry.deref!=null?"#":"")+val)}},pool=class_file.constant_pool,pool.each(function(idx,entry){return rv+="const #"+idx+" = "+entry.type+"	"+format(entry)+";"+format_extra_info(entry)+"\n"}),rv+="\n",pp_type=function(field_type){return field_type instanceof types.ArrayType?pp_type(field_type.component_type)+"[]":field_type.toExternalString()},print_excs=function(exc_attr){var e,excs;return excs=exc_attr.exceptions,"   throws "+function(){var _k,_len3,_results;_results=[];for(_k=0,_len3=excs.length;_k<_len3;_k++)e=excs[_k],_results.push(util.ext_classname(e));return _results}().join(", ")},rv+="{\n",_ref2=class_file.fields;for(_k=0,_len3=_ref2.length;_k<_len3;_k++)f=_ref2[_k],rv+=""+access_string(f.access_flags)+" "+pp_type(f.type)+" "+f.name+";\n",const_attr=_.find(f.attrs,function(attr){return attr.constructor.name==="ConstantValue"}),const_attr!=null&&(entry=pool.get(const_attr.ref),rv+="  Constant value: "+entry.type+" "+((typeof entry.deref=="function"?entry.deref():void 0)||entry.value)+"\n"),rv+="\n\n";_ref3=class_file.methods;for(sig in _ref3){m=_ref3[sig],rv+=access_string(m.access_flags),rv+=m.name==="<init>"?class_file.this_class.toExternalString():m.name==="<clinit>"?"{}":(ret_type=m.return_type!=null?pp_type(m.return_type):"",ret_type+" "+m.name),m.name!=="<clinit>"&&(rv+="("+function(){var _l,_len4,_ref4,_results;_ref4=m.param_types,_results=[];for(_l=0,_len4=_ref4.length;_l<_len4;_l++)p=_ref4[_l],_results.push(pp_type(p));return _results}()+")");if(exc_attr=_.find(m.attrs,function(a){return a.constructor.name==="Exceptions"}))rv+=print_excs(exc_attr);rv+=";\n";if(!m.access_flags["native"]&&!m.access_flags.abstract){rv+="  Code:\n",code=m.code,rv+="   Stack="+code.max_stack+", Locals="+code.max_locals+", Args_size="+m.num_args+"\n",code.each_opcode(function(idx,oc){return rv+="   "+idx+":	"+oc.name,rv+=util.lookup_handler(root.opcode_annotators,oc,idx,pool)||"",rv+="\n"});if(code.exception_handlers.length>0){fixed_width=function(num,width){var num_str;return num_str=num+"",function(){var _l,_ref4,_results;_results=[];for(_l=0,_ref4=width-num_str.length;0>_ref4?_l>_ref4:_l<_ref4;0>_ref4?_l--:_l++)_results.push(" ");return _results}().join("")+num_str},rv+="  Exception table:\n",rv+="   from   to  target type\n",_ref4=code.exception_handlers;for(_l=0,_len4=_ref4.length;_l<_len4;_l++)eh=_ref4[_l],rv+=function(){var _len5,_m,_ref5,_results;_ref5=["start_pc","end_pc","handler_pc"],_results=[];for(_m=0,_len5=_ref5.length;_m<_len5;_m++)item=_ref5[_m],_results.push(fixed_width(eh[item],6));return _results}().join(""),rv+="   "+(eh.catch_type[0]==="<"?"any":"Class "+eh.catch_type+"\n")+"\n";rv+="\n"}_ref5=code.attrs;for(_m=0,_len5=_ref5.length;_m<_len5;_m++){attr=_ref5[_m];switch(attr.constructor.name){case"LineNumberTable":rv+="  LineNumberTable:\n";for(_n=0,_len6=attr.length;_n<_len6;_n++)entry=attr[_n],rv+="   line "+entry.line_number+": "+entry.start_pc+"\n";break;case"StackMapTable":rv+="  StackMapTable: number_of_entries = "+attr.num_entries+"\n",_ref6=attr.entries;for(_o=0,_len7=_ref6.length;_o<_len7;_o++)entry=_ref6[_o],rv+="   frame_type = "+entry.frame_type+" /* "+entry.frame_name+" */\n",entry.offset_delta!=null&&(rv+="     offset_delta = "+entry.offset_delta+"\n"),entry.locals!=null&&(rv+="     locals = [ "+entry.locals.join(", ")+" ]\n"),entry.stack!=null&&(rv+="     stack = [ "+entry.stack+" ]\n");break;case"LocalVariableTable":rv+="  LocalVariableTable:\n",rv+="   Start  Length  Slot  Name   Signature\n",_ref7=attr.entries;for(_p=0,_len8=_ref7.length;_p<_len8;_p++)entry=_ref7[_p],rv+="   "+entry.start_pc+"      "+entry.length+"      "+entry.ref,rv+=""+entry.name+"      "+entry.descriptor+"\n"}}exc_attr&&(rv+="  Exceptions:\n"+print_excs(exc_attr)+"\n")}rv+="\n"}return rv+="}\n",rv},escape_whitespace=function(str){return str.replace(/\s/g,function(c){switch(c){case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"":return"\\v";case"\f":return"\\f";default:return c}})},format_extra_info=function(entry){var info,type;type=entry.type,info=typeof entry.deref=="function"?entry.deref():void 0;if(!info)return"";switch(type){case"Method":case"InterfaceMethod":return"	//  "+info["class"]+"."+info.sig;case"Field":return"	//  "+info["class"]+"."+info.name+":"+info.type;case"NameAndType":return"//  "+info.name+":"+info.type;default:if(util.is_string(info))return"	//  "+escape_whitespace(info)}},primitive_types={Z:"boolean",C:"char",F:"float",D:"double",B:"byte",S:"short",I:"int",J:"long"},root.opcode_annotators={InvokeOpcode:function(idx,pool){return"	#"+this.method_spec_ref+(this.name==="invokeinterface"?",  "+this.count:"")+(";"+format_extra_info(pool.get(this.method_spec_ref)))},ClassOpcode:function(idx,pool){return"	#"+this.class_ref+";"+format_extra_info(pool.get(this.class_ref))},FieldOpcode:function(idx,pool){return"	#"+this.field_spec_ref+";"+format_extra_info(pool.get(this.field_spec_ref))},SwitchOpcode:function(idx){var match,offset;return"{\n"+function(){var _ref,_results;_ref=this.offsets,_results=[];for(match in _ref)offset=_ref[match],_results.push("		"+match+": "+(idx+offset)+";\n");return _results}.call(this).join("")+("		default: "+(idx+this._default)+" }")},BranchOpcode:function(idx){return"	"+(idx+this.offset)},LoadVarOpcode:function(){return"	"+this.var_num},StoreVarOpcode:function(){return"	"+this.var_num},LoadConstantOpcode:function(){return"	#"+this.constant_ref+";"},PushOpcode:function(){return"	"+this.value},IIncOpcode:function(){return"	"+this.index+", "+this["const"]},NewArrayOpcode:function(){return"	"+primitive_types[this.element_type]},MultiArrayOpcode:function(){return"	#"+this.class_ref+",  "+this.dim+";"}}}.call(this),function(){var c2t,debug,doPrivileged,error,flatten_pkg,fs,get_field_from_offset,get_value_from_offset,log,native_methods,o,path,root,set_value_from_offset,stat_file,system_properties,trapped_methods,_ref,_ref2;if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof gLong=="undefined"||gLong===null)gLong=require("../third_party/gLong.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof types=="undefined"||types===null)types=require("./types");path=(_ref=typeof node!=="undefined"&&node!==null?node.path:void 0)!=null?_ref:require("path"),fs=(_ref2=typeof node!=="undefined"&&node!==null?node.fs:void 0)!=null?_ref2:require("fs"),log=util.log,debug=util.debug,error=util.error,c2t=types.c2t,root=typeof exports!="undefined"&&exports!==null?exports:this.natives={},o=function(fn_name,fn){return{fn_name:fn_name,fn:fn}},trapped_methods={java:{lang:{System:[o("loadLibrary(L!/!/String;)V",function(rs){}),o("adjustPropertiesForBackwardCompatibility(L!/util/Properties;)V",function(rs){})],Terminator:[o("setup()V",function(rs){})],Throwable:[o("fillInStackTrace()L!/!/!;",function(rs,_this){var attrs,cls,i,line_nums,ln,row,sf,source_file,stack,_i,_len,_ref3,_ref4,_ref5;stack=[],_this.fields.stackTrace=rs.init_object("[Ljava/lang/StackTraceElement;",stack),_ref3=rs.meta_stack.slice(1);for(_i=0,_len=_ref3.length;_i<_len;_i++){sf=_ref3[_i];if(sf.locals[0]===_this)continue;cls=sf.method.class_type,_this.type.toClassString()!=="java/lang/NoClassDefFoundError"?(attrs=rs.class_lookup(cls).attrs,source_file=((_ref4=_.find(attrs,function(attr){return attr.constructor.name==="SourceFile"}))!=null?_ref4.name:void 0)||"unknown"):source_file="unknown",line_nums=(_ref5=sf.method.code)!=null?_ref5.attrs[0]:void 0,line_nums!=null?ln=_.last(function(){var _results;_results=[];for(i in line_nums)row=line_nums[i],row.start_pc<=sf.pc&&_results.push(row.line_number);return _results}()):ln=-1,stack.push(rs.init_object("java/lang/StackTraceElement",{declaringClass:rs.init_string(util.ext_classname(cls.toClassString())),methodName:rs.init_string(sf.method.name),fileName:rs.init_string(source_file),lineNumber:ln}))}return stack.reverse(),_this})]},util:{concurrent:{atomic:{AtomicInteger:[o("<clinit>()V",function(rs){}),o("compareAndSet(II)Z",function(rs,_this,expect,update){return _this.fields.value=update,!0})]}},Currency:[o("getInstance(Ljava/lang/String;)Ljava/util/Currency;",function(rs){return null})]},nio:{Bits:[o("byteOrder()L!/!/ByteOrder;",function(rs){return rs.static_get({"class":"java/nio/ByteOrder",name:"LITTLE_ENDIAN"})})],charset:{Charset$3:[o("run()L!/lang/Object;",function(rs){return null})]}}}},doPrivileged=function(rs){var action,m;return action=rs.curr_frame().locals[0],m=rs.method_lookup({"class":action.type.toClassString(),sig:"run()Ljava/lang/Object;"}),m.access_flags.static||rs.push(action),m.run(rs,m.access_flags.virtual),rs.pop()},system_properties={"java.home":"third_party/java_home/","file.encoding":"US_ASCII","java.vendor":"DoppioVM","line.separator":"\n","file.separator":"/","path.separator":":","user.dir":".","user.home":".","user.name":"DoppioUser","sun.boot.class.path":"/System/Library/Frameworks/JavaVM.framework/Classes/classes.jar","java.awt.graphicsenv":"sun.awt.X11GraphicsEnvironment",useJavaUtilZip:"true"},get_field_from_offset=function(rs,cls,offset){var classname;classname=cls.this_class.toClassString();while(cls.fields[offset]==null)cls.super_class==null&&util.java_throw(rs,"java/lang/NullPointerException","field "+offset+" doesn't exist in class "+classname),cls=rs.class_lookup(cls.super_class);return cls.fields[offset]},get_value_from_offset=function(rs,obj,offset){var f,_ref3;return obj.type instanceof types.ArrayType?obj.array[offset.toInt()]:(f=get_field_from_offset(rs,rs.class_lookup(obj.type),offset.toInt()),f.access_flags.static?rs.static_get({"class":obj.type.toClassString(),name:f.name}):(_ref3=obj.fields[f.name])!=null?_ref3:0)},set_value_from_offset=function(rs,obj,offset,value){var f;return o=offset.toInt(),obj.type instanceof types.ArrayType?obj.array[o]=value:(f=get_field_from_offset(rs,rs.class_lookup(obj.type),o),f.access_flags.static?(rs.push(value),rs.static_put({"class":obj.type.toClassString(),name:f.name})):obj.fields[f.name]=value)},stat_file=function(fname){try{return util.is_string(fname)?fs.statSync(fname):fs.fstatSync(fname)}catch(e){return null}},native_methods={java:{lang:{Class:[o("getPrimitiveClass(L!/!/String;)L!/!/!;",function(rs,jvm_str){return rs.class_lookup(new types.PrimitiveType(rs.jvm2js_str(jvm_str)),!0)}),o("getClassLoader0()L!/!/ClassLoader;",function(rs){return null}),o("desiredAssertionStatus0(L!/!/!;)Z",function(rs){return!1}),o("getName0()L!/!/String;",function(rs,_this){return rs.init_string(_this.fields.$type.toExternalString())}),o("forName0(L!/!/String;ZL!/!/ClassLoader;)L!/!/!;",function(rs,jvm_str){var type;return type=c2t(util.int_classname(rs.jvm2js_str(jvm_str))),rs.class_lookup(type,!0)}),o("getComponentType()L!/!/!;",function(rs,_this){var type;return type=_this.fields.$type,type instanceof types.ArrayType?rs.class_lookup(type.component_type,!0):null}),o("isAssignableFrom(L!/!/!;)Z",function(rs,_this,cls){return types.is_castable(rs,cls.fields.$type,_this.fields.$type)}),o("isInterface()Z",function(rs,_this){var cls;return _this.fields.$type instanceof types.ClassType?(cls=rs.class_lookup(_this.fields.$type),cls.access_flags.interface):!1}),o("isInstance(L!/!/Object;)Z",function(rs,_this,obj){return types.is_castable(rs,obj.type,_this.fields.$type)}),o("isPrimitive()Z",function(rs,_this){return _this.fields.$type instanceof types.PrimitiveType}),o("isArray()Z",function(rs,_this){return _this.fields.$type instanceof types.ArrayType}),o("getSuperclass()L!/!/!;",function(rs,_this){var cls,type;return type=_this.fields.$type,type instanceof types.PrimitiveType||type==="Ljava/lang/Object;"?null:(cls=rs.class_lookup(type),cls.access_flags.interface||cls.super_class==null?null:rs.class_lookup(cls.super_class,!0))}),o("getDeclaredFields0(Z)[Ljava/lang/reflect/Field;",function(rs,_this,public_only){var f,fields;return fields=rs.class_lookup(_this.fields.$type).fields,public_only&&(fields=function(){var _i,_len,_results;_results=[];for(_i=0,_len=fields.length;_i<_len;_i++)f=fields[_i],f.access_flags.public&&_results.push(f);return _results}()),rs.init_object("[Ljava/lang/reflect/Field;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=fields.length;_i<_len;_i++)f=fields[_i],_results.push(f.reflector(rs));return _results}())}),o("getDeclaredMethods0(Z)[Ljava/lang/reflect/Method;",function(rs,_this,public_only){var m,methods,sig;return methods=rs.class_lookup(_this.fields.$type).methods,methods=function(){var _results;_results=[];for(sig in methods)m=methods[sig],(m.access_flags.public||!public_only)&&_results.push(m);return _results}(),rs.init_object("[Ljava/lang/reflect/Method;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],_results.push(m.reflector(rs));return _results}())}),o("getDeclaredConstructors0(Z)[Ljava/lang/reflect/Constructor;",function(rs,_this,public_only){var m,methods,sig;return methods=rs.class_lookup(_this.fields.$type).methods,methods=function(){var _results;_results=[];for(sig in methods)m=methods[sig],m.name==="<init>"&&_results.push(m);return _results}(),public_only&&(methods=function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],m.access_flags.public&&_results.push(m);return _results}()),rs.init_object("[Ljava/lang/reflect/Constructor;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=methods.length;_i<_len;_i++)m=methods[_i],_results.push(m.reflector(rs,!0));return _results}())}),o("getInterfaces()[L!/!/!;",function(rs,_this){var cls,i,iface,iface_objs,ifaces;return cls=rs.class_lookup(_this.fields.$type),ifaces=function(){var _i,_len,_ref3,_results;_ref3=cls.interfaces,_results=[];for(_i=0,_len=_ref3.length;_i<_len;_i++)i=_ref3[_i],_results.push(cls.constant_pool.get(i).deref());return _results}(),ifaces=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)i=ifaces[_i],_results.push(util.is_string(i)?c2t(i):i);return _results}(),iface_objs=function(){var _i,_len,_results;_results=[];for(_i=0,_len=ifaces.length;_i<_len;_i++)iface=ifaces[_i],_results.push(rs.class_lookup(iface,!0));return _results}(),rs.init_object("[Ljava/lang/Class;",iface_objs)}),o("getModifiers()I",function(rs,_this){return rs.class_lookup(_this.fields.$type).access_byte})],ClassLoader:[o("findLoadedClass0(L!/!/String;)L!/!/Class;",function(rs,_this,name){var rv,type;type=c2t(util.int_classname(rs.jvm2js_str(name))),rv=null;try{rv=rs.class_lookup(type,!0)}catch(e){if(!(e instanceof util.JavaException))throw e}return rv}),o("findBootstrapClass(L!/!/String;)L!/!/Class;",function(rs,_this,name){var type;return type=c2t(util.int_classname(rs.jvm2js_str(name))),rs.dyn_class_lookup(type,!0)})],Float:[o("floatToRawIntBits(F)I",function(rs,f_val){var f_view,i_view;return f_view=new Float32Array([f_val]),i_view=new Int32Array(f_view.buffer),i_view[0]})],Double:[o("doubleToRawLongBits(D)J",function(rs,d_val){var d_view,i_view;return d_view=new Float64Array([d_val]),i_view=new Uint32Array(d_view.buffer),gLong.fromBits(i_view[0],i_view[1])}),o("longBitsToDouble(J)D",function(rs,l_val){var d_view,i_view;return i_view=new Uint32Array(2),i_view[0]=l_val.getLowBitsUnsigned(),i_view[1]=l_val.getHighBits(),d_view=new Float64Array(i_view.buffer),d_view[0]})],Object:[o("getClass()L!/!/Class;",function(rs,_this){return rs.class_lookup(_this.type,!0)}),o("hashCode()I",function(rs,_this){return _this.ref}),o("clone()L!/!/!;",function(rs,_this){return _this.type instanceof types.ArrayType?rs.set_obj(_this.type,_this.array):rs
.set_obj(_this.type,_this.fields)}),o("notifyAll()V",function(){})],reflect:{Array:[o("newArray(L!/!/Class;I)L!/!/Object;",function(rs,_this,len){return rs.heap_newarray(_this.fields.$type,len)})]},Runtime:[o("availableProcessors()I",function(){return 1})],Shutdown:[o("halt0(I)V",function(rs){throw new util.HaltException(rs.curr_frame().locals[0])})],StrictMath:[o("pow(DD)D",function(rs){return Math.pow(rs.cl(0),rs.cl(2))})],String:[o("intern()L!/!/!;",function(rs,_this){var js_str;return js_str=rs.jvm2js_str(_this),rs.string_pool[js_str]||(rs.string_pool[js_str]=_this),rs.string_pool[js_str]})],System:[o("arraycopy(L!/!/Object;IL!/!/Object;II)V",function(rs,src,src_pos,dest,dest_pos,length){var i,j,_ref3,_results;j=dest_pos,_results=[];for(i=src_pos,_ref3=src_pos+length;i<_ref3;i+=1)_results.push(dest.array[j++]=src.array[i]);return _results}),o("currentTimeMillis()J",function(rs){return gLong.fromNumber((new Date).getTime())}),o("identityHashCode(L!/!/Object;)I",function(x){return x.ref}),o("initProperties(L!/util/Properties;)L!/util/Properties;",function(rs,props){var k,m,v;m=rs.method_lookup({"class":"java/util/Properties",sig:"setProperty(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;"});for(k in system_properties)v=system_properties[k],rs.push(props,rs.init_string(k,!0),rs.init_string(v,!0)),m.run(rs),rs.pop();return props}),o("nanoTime()J",function(rs){return gLong.fromNumber((new Date).getTime()).multiply(gLong.fromNumber(1e6))}),o("setIn0(L!/io/InputStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"in"})}),o("setOut0(L!/io/PrintStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"out"})}),o("setErr0(L!/io/PrintStream;)V",function(rs,stream){return rs.push(stream),rs.static_put({"class":"java/lang/System",name:"err"})})],Thread:[o("currentThread()L!/!/!;",function(rs){return rs.main_thread}),o("setPriority0(I)V",function(rs){}),o("holdsLock(L!/!/Object;)Z",function(){return!0}),o("isAlive()Z",function(rs,_this){var _ref3;return(_ref3=_this.fields.$isAlive)!=null?_ref3:!1}),o("start0()V",function(rs,_this){return _this.fields.$isAlive=!0}),o("sleep(J)V",function(rs,millis){throw rs.curr_frame().resume=function(){},new util.YieldException(function(cb){return setTimeout(cb,millis.toNumber())})})]},security:{AccessController:[o("doPrivileged(L!/!/PrivilegedAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;)L!/lang/Object;",doPrivileged),o("doPrivileged(L!/!/PrivilegedExceptionAction;L!/!/AccessControlContext;)L!/lang/Object;",doPrivileged),o("getStackAccessControlContext()Ljava/security/AccessControlContext;",function(rs){return null})]},io:{Console:[o("encoding()L!/lang/String;",function(){return null}),o("istty()Z",function(){return!0})],FileSystem:[o("getFileSystem()L!/!/!;",function(rs){var cache1,cache2,cache_init;return cache1=rs.init_object("java/io/ExpiringCache"),cache2=rs.init_object("java/io/ExpiringCache"),cache_init=rs.method_lookup({"class":"java/io/ExpiringCache",sig:"<init>()V"}),rs.push(cache1,cache2),cache_init.run(rs),cache_init.run(rs),rs.init_object("java/io/UnixFileSystem",{cache:cache1,javaHomePrefixCache:cache2,slash:system_properties["file.separator"].charCodeAt(0),colon:system_properties["path.separator"].charCodeAt(0),javaHome:rs.init_string(system_properties["java.home"],!0)})})],FileOutputStream:[o("open(L!/lang/String;)V",function(rs,_this,fname){var jvm_str;return jvm_str=rs.jvm2js_str(fname),_this.fields.$file=fs.openSync(jvm_str,"w")}),o("writeBytes([BIIZ)V",function(rs,_this,bytes,offset,len,append){if(_this.fields.$file!=null){fs.writeSync(_this.fields.$file,new Buffer(bytes.array),offset,len);return}rs.print(rs.jvm_carr2js_str(bytes,offset,len));if(typeof node!="undefined"&&node!==null)throw rs.curr_frame().resume=function(){},new util.YieldException(function(cb){return setTimeout(cb,0)})}),o("writeBytes([BII)V",function(rs,_this,bytes,offset,len){if(_this.fields.$file!=null){fs.writeSync(_this.fields.$file,new Buffer(bytes.array),offset,len);return}rs.print(rs.jvm_carr2js_str(bytes,offset,len));if(typeof node!="undefined"&&node!==null)throw rs.curr_frame().resume=function(){},new util.YieldException(function(cb){return setTimeout(cb,0)})}),o("close0()V",function(rs,_this){if(_this.fields.$file==null)return;return fs.closeSync(_this.fields.$file),_this.fields.$file=null})],FileInputStream:[o("available()I",function(rs,_this){var stats;return _this.fields.$file==null?0:(stats=fs.fstatSync(_this.fields.$file),stats.size-_this.fields.$pos)}),o("read()I",function(rs,_this){var buf,bytes_read,data,file;if((file=_this.fields.$file)!=null)return buf=new Buffer(fs.fstatSync(file).size),bytes_read=fs.readSync(file,buf,0,1,_this.fields.$pos),_this.fields.$pos++,bytes_read===0?-1:buf.readUInt8(0);throw data=null,rs.curr_frame().resume=function(){return data.length===0?-1:data.charCodeAt(0)},new util.YieldException(function(cb){return rs.async_input(1,function(byte){return data=byte,cb()})})}),o("readBytes([BII)I",function(rs,_this,byte_arr,offset,n_bytes){var buf,bytes_read,i,pos,result;if(_this.fields.$file!=null){pos=_this.fields.$pos,buf=new Buffer(n_bytes),bytes_read=fs.readSync(_this.fields.$file,buf,0,n_bytes,pos),_this.fields.$pos+=bytes_read;for(i=0;i<bytes_read;i+=1)byte_arr.array[offset+i]=buf.readUInt8(i);return bytes_read===0&&n_bytes!==0?-1:bytes_read}throw result=null,rs.curr_frame().resume=function(){return result},new util.YieldException(function(cb){return rs.async_input(n_bytes,function(bytes){var b,idx,_len;for(idx=0,_len=bytes.length;idx<_len;idx++)b=bytes[idx],byte_arr.array[offset+idx]=b;return result=bytes.length,cb()})})}),o("open(Ljava/lang/String;)V",function(rs,_this,filename){var filepath;filepath=rs.jvm2js_str(filename);try{return _this.fields.$file=fs.openSync(filepath,"r"),_this.fields.$pos=0}catch(e){if(e.code==="ENOENT")return util.java_throw(rs,"java/io/FileNotFoundException","Could not open file "+filepath);throw e}}),o("close0()V",function(rs,_this){return _this.fields.$file=null})],ObjectStreamClass:[o("initNative()V",function(rs){})],RandomAccessFile:[o("open(Ljava/lang/String;I)V",function(rs,_this,filename,mode){var filepath;filepath=rs.jvm2js_str(filename);try{_this.fields.$file=fs.openSync(filepath,"r")}catch(e){if(e.code!=="ENOENT")throw e;util.java_throw(rs,"java/io/FileNotFoundException","Could not open file "+filepath)}return _this.fields.$pos=0}),o("length()J",function(rs,_this){var stats;return stats=stat_file(_this.fields.$file),gLong.fromNumber(stats.size)}),o("seek(J)V",function(rs,_this,pos){return _this.fields.$pos=pos}),o("readBytes([BII)I",function(rs,_this,byte_arr,offset,len){var buf,bytes_read,i,pos;pos=_this.fields.$pos.toNumber(),buf=new Buffer(len),bytes_read=fs.readSync(_this.fields.$file,buf,0,len,pos);for(i=0;i<bytes_read;i+=1)byte_arr.array[offset+i]=buf.readUInt8(i);return _this.fields.$pos=gLong.fromNumber(pos+bytes_read),bytes_read===0&&len!==0?-1:bytes_read}),o("close0()V",function(rs,_this){return _this.fields.$file=null})],UnixFileSystem:[o("getBooleanAttributes0(Ljava/io/File;)I",function(rs,_this,file){var stats;return stats=stat_file(rs.jvm2js_str(file.fields.path)),stats==null?0:stats.isFile()?3:stats.isDirectory()?5:1}),o("getLastModifiedTime(Ljava/io/File;)J",function(rs,_this,file){var stats;return stats=stat_file(rs.jvm2js_str(file.fields.path)),stats==null&&util.java_throw("java/io/FileNotFoundException"),gLong.fromNumber((new Date(stats.mtime)).getTime())}),o("canonicalize0(L!/lang/String;)L!/lang/String;",function(rs,_this,jvm_path_str){var js_str;return js_str=rs.jvm2js_str(jvm_path_str),rs.init_string(path.resolve(path.normalize(js_str)))}),o("list(Ljava/io/File;)[Ljava/lang/String;",function(rs,_this,file){var f,files,pth;pth=rs.jvm2js_str(file.fields.path);try{files=fs.readdirSync(pth)}catch(e){return null}return rs.init_object("[Ljava/lang/String;",function(){var _i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++)f=files[_i],_results.push(rs.init_string(f));return _results}())})]},util:{concurrent:{atomic:{AtomicLong:[o("VMSupportsCS8()Z",function(){return!0})]}},jar:{JarFile:[o("getMetaInfEntryNames()[L!/lang/String;",function(rs){return null})]},ResourceBundle:[o("getClassContext()[L!/lang/Class;",function(rs){return rs.init_object("[Ljava/lang/Class;",[null,null,null])})],TimeZone:[o("getSystemTimeZoneID(L!/lang/String;L!/lang/String;)L!/lang/String;",function(rs,java_home,country){return rs.init_string("GMT")}),o("getSystemGMTOffsetID()L!/lang/String;",function(rs){return null})],zip:{ZipEntry:[o("initFields(J)V",function(rs,_this,jzentry){var ze;return ze=rs.get_zip_descriptor(jzentry),_this.fields.name=rs.init_string(ze.name),_this.fields.size=gLong.fromInt(ze.stat.size)})],ZipFile:[o("open(Ljava/lang/String;IJZ)J",function(rs,fname,mode,mtime,use_mmap){var add_entries,base,js_str,zipfile;js_str=path.resolve(rs.jvm2js_str(fname));if(js_str!==system_properties["sun.boot.class.path"])throw"Tried to open "+js_str+": ZipFile is not actually implemented.";return rs.classes_jar!=null?rs.classes_jar:(error("Simulating ZipFile based on classes.jar..."),base="third_party/classes",zipfile={name:"special",fullpath:base,entries:{}},add_entries=function(dir){var curr_dir_entries,e,fullpath,name,stat,_i,_len,_results;curr_dir_entries=fs.readdirSync(""+base+"/"+dir),_results=[];for(_i=0,_len=curr_dir_entries.length;_i<_len;_i++)e=curr_dir_entries[_i],name=""+dir+e,fullpath=""+base+"/"+name,stat=fs.statSync(fullpath),zipfile.entries[fullpath]=rs.set_zip_descriptor({fullpath:fullpath,name:name,stat:stat}),stat.isDirectory()?_results.push(add_entries(name+"/")):_results.push(void 0);return _results},add_entries(""),rs.classes_jar=rs.set_zip_descriptor(zipfile),rs.classes_jar)}),o("close(J)V",function(rs,jzfile){return rs.free_zip_descriptor(jzfile)}),o("getTotal(J)I",function(rs,jzfile){var zipfile;return typeof node!="undefined"&&node!==null?21090:(zipfile=rs.get_zip_descriptor(jzfile),_.keys(zipfile.entries).length)}),o("getEntry(JLjava/lang/String;Z)J",function(rs,jzfile,name,add_slash){var entry_name,file,fullpath,zf;return zf=rs.get_zip_descriptor(jzfile),entry_name=rs.jvm2js_str(name),fullpath=""+zf.fullpath+"/"+entry_name,typeof node!="undefined"&&node!==null?_.last(fullpath)==="/"?rs.set_zip_descriptor({fullpath:fullpath,name:entry_name,stat:{size:4}}):(file=read_raw_class(fullpath),file?rs.set_zip_descriptor({fullpath:fullpath,name:entry_name,file:file,stat:{size:file.length}}):gLong.ZERO):zf.entries[fullpath]!=null?zf.entries[fullpath]:gLong.ZERO}),o("getNextEntry(JI)J",function(rs,jzfile,idx){var entry_array,zf;return zf=rs.get_zip_descriptor(jzfile),entry_array=_.values(zf.entries),0>idx||idx>=entry_array.length?gLong.ZERO:entry_array[idx]}),o("getZipMessage(J)Ljava/lang/String;",function(rs,jzfile){var zf;return zf=rs.get_zip_descriptor(jzfile),rs.init_string("not sure what to say here... ZipFile::getZipMessage")}),o("freeEntry(JJ)V",function(rs,jzfile,jzentry){return rs.free_zip_descriptor(jzentry)}),o("getCSize(J)J",function(rs,jzentry){var ze;return ze=rs.get_zip_descriptor(jzentry),gLong.fromInt(ze.stat.size)}),o("getSize(J)J",function(rs,jzentry){var ze;return ze=rs.get_zip_descriptor(jzentry),gLong.fromInt(ze.stat.size)}),o("getMethod(J)I",function(rs,jzentry){return 0}),o("read(JJJ[BII)I",function(rs,jzfile,jzentry,pos,byte_arr,offset,len){var buf,bytes_read,file,i,pos_int,ze,_ref3;ze=rs.get_zip_descriptor(jzentry),file=(_ref3=ze.file)!=null?_ref3:fs.openSync(ze.fullpath,"r");if(typeof node!="undefined"&&node!==null){pos_int=pos.toInt(),bytes_read=Math.min(file.length-pos_int,len);for(i=0;i<bytes_read;i+=1)byte_arr.array[offset+i]=file[pos_int+i]}else{buf=new Buffer(len),bytes_read=fs.readSync(file,buf,0,len,pos.toInt());for(i=0;i<bytes_read;i+=1)byte_arr.array[offset+i]=buf.readUInt8(i)}return bytes_read===0&&len!==0?-1:bytes_read})]}}},sun:{awt:{X11GraphicsEnvironment:[o("initDisplay(Z)V",function(rs,glxRequested){return console.log("TODO: Initialize display")})]},font:{FontManager:[o("initIDs(Z)V",function(rs){return console.log("TODO: FontManager::initIDs")})]},misc:{VM:[o("initialize()V",function(rs){var vm_cls;vm_cls=rs.class_lookup(c2t("sun/misc/VM"));if(vm_cls.major_version<51)return;return rs.push(rs.static_get({"class":"java/lang/System",name:"props"})),rs.static_put({"class":"sun/misc/VM",name:"savedProps"})})],Unsafe:[o("addressSize()I",function(rs,_this){return 4}),o("allocateMemory(J)J",function(rs,_this,size){return gLong.ZERO}),o("freeMemory(J)V",function(rs,_this,address){}),o("putLong(JJ)V",function(rs,_this,address,value){}),o("getByte(J)B",function(rs,_this,address){return 8}),o("arrayBaseOffset(Ljava/lang/Class;)I",function(rs,_this,cls){return 0}),o("arrayIndexScale(Ljava/lang/Class;)I",function(rs,_this,cls){return 1}),o("compareAndSwapObject(Ljava/lang/Object;JLjava/lang/Object;Ljava/lang/Object;)Z",function(rs,_this,obj,offset,expected,x){return set_value_from_offset(rs,obj,offset,x),!0}),o("compareAndSwapInt(Ljava/lang/Object;JII)Z",function(rs,_this,obj,offset,expected,x){return set_value_from_offset(rs,obj,offset,x),!0}),o("compareAndSwapLong(Ljava/lang/Object;JJJ)Z",function(rs,_this,obj,offset,expected,x){return set_value_from_offset(rs,obj,offset,x),!0}),o("ensureClassInitialized(Ljava/lang/Class;)V",function(rs,_this,cls){return rs.class_lookup(cls.fields.$type)}),o("staticFieldOffset(Ljava/lang/reflect/Field;)J",function(rs,_this,field){return gLong.fromNumber(field.fields.slot)}),o("objectFieldOffset(Ljava/lang/reflect/Field;)J",function(rs,_this,field){return gLong.fromNumber(field.fields.slot)}),o("staticFieldBase(Ljava/lang/reflect/Field;)Ljava/lang/Object;",function(rs,_this,field){return rs.set_obj(field.fields.clazz.fields.$type)}),o("getObjectVolatile(Ljava/lang/Object;J)Ljava/lang/Object;",function(rs,_this,obj,offset){return get_value_from_offset(rs,obj,offset)}),o("getObject(Ljava/lang/Object;J)Ljava/lang/Object;",function(rs,_this,obj,offset){return get_value_from_offset(rs,obj,offset)}),o("putOrderedObject(Ljava/lang/Object;JLjava/lang/Object;)V",function(rs,_this,obj,offset,new_obj){return set_value_from_offset(rs,obj,offset,new_obj)})]},reflect:{NativeMethodAccessorImpl:[o("invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;",function(rs,m,obj,params){var method,sig,type;return type=m.fields.clazz.fields.$type,method=function(){var _ref3,_results;_ref3=rs.class_lookup(type).methods,_results=[];for(sig in _ref3)method=_ref3[sig],method.idx===m.fields.slot&&_results.push(method);return _results}()[0],method.access_flags.static||rs.push(obj),rs.push.apply(rs,params.array),method.run(rs),rs.pop()})],NativeConstructorAccessorImpl:[o("newInstance0(Ljava/lang/reflect/Constructor;[Ljava/lang/Object;)Ljava/lang/Object;",function(rs,m,params){var method,obj,sig,type;return type=m.fields.clazz.fields.$type,method=function(){var _ref3,_results;_ref3=rs.class_lookup(type).methods,_results=[];for(sig in _ref3)method=_ref3[sig],method.idx===m.fields.slot&&_results.push(method);return _results}()[0],rs.push(obj=rs.set_obj(type,{})),params!=null&&rs.push.apply(rs,params.array),method.run(rs),obj})],Reflection:[o("getCallerClass(I)Ljava/lang/Class;",function(rs,frames_to_skip){var type;return type=rs.meta_stack[rs.meta_stack.length-1-frames_to_skip].method.class_type,rs.class_lookup(type,!0)}),o("getClassAccessFlags(Ljava/lang/Class;)I",function(rs,_this){return rs.class_lookup(_this.fields.$type).access_byte})]}}},flatten_pkg=function(pkg){var pkg_name_arr,rec_flatten,result;return result={},pkg_name_arr=[],rec_flatten=function(pkg){var flattened_inner,fn,fn_name,full_name,inner_pkg,method,pkg_name,_i,_len,_results;_results=[];for(pkg_name in pkg){inner_pkg=pkg[pkg_name],pkg_name_arr.push(pkg_name);if(inner_pkg instanceof Array)for(_i=0,_len=inner_pkg.length;_i<_len;_i++)method=inner_pkg[_i],fn_name=method.fn_name,fn=method.fn,fn_name=fn_name.replace(/!|;/g,function(){var depth;return depth=0,function(c){return c==="!"?pkg_name_arr[depth++]:c===";"?(depth=0,c):c}}()),full_name=""+pkg_name_arr.join("/")+"::"+fn_name,result[full_name]=fn;else flattened_inner=rec_flatten(inner_pkg);_results.push(pkg_name_arr.pop(pkg_name))}return _results},rec_flatten(pkg),result},root.trapped_methods=flatten_pkg(trapped_methods),root.native_methods=flatten_pkg(native_methods)}.call(this),function(){var AbstractMethodField,c2t,carr2type,debug,error,log,native_methods,opcode_annotators,root,str2type,trapped_methods,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=Array.prototype.slice;if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof gLong=="undefined"||gLong===null)gLong=require("../third_party/gLong.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof opcodes=="undefined"||opcodes===null)opcodes=require("./opcodes");if(typeof make_attributes=="undefined"||make_attributes===null)make_attributes=require("./attributes");if(typeof disassembler=="undefined"||disassembler===null)disassembler=require("./disassembler");if(typeof types=="undefined"||types===null)types=require("./types");if(typeof natives=="undefined"||natives===null)natives=require("./natives");log=util.log,debug=util.debug,error=util.error,opcode_annotators=disassembler.opcode_annotators,str2type=types.str2type,carr2type=types.carr2type,c2t=types.c2t,native_methods=natives.native_methods,trapped_methods=natives.trapped_methods,root=typeof exports!="undefined"&&exports!==null?exports:this.methods={},AbstractMethodField=function(){function AbstractMethodField(class_type){this.class_type=class_type}return AbstractMethodField.prototype.parse=function(bytes_array,constant_pool,idx){return this.idx=idx,this.access_byte=bytes_array.get_uint(2),this.access_flags=util.parse_flags(this.access_byte),this.name=constant_pool.get(bytes_array.get_uint(2)).value,this.raw_descriptor=constant_pool.get(bytes_array.get_uint(2)).value,this.parse_descriptor(this.raw_descriptor),this.attrs=make_attributes(bytes_array,constant_pool),this.code=_.find(this.attrs,function(a){return a.constructor.name==="Code"})},AbstractMethodField}(),root.Field=function(_super){function Field(){Field.__super__.constructor.apply(this,arguments)}return __extends(Field,_super),Field.prototype.parse_descriptor=function(raw_descriptor){return this.raw_descriptor=raw_descriptor,this.type=str2type(raw_descriptor)},Field.prototype.reflector=function(rs){return rs.init_object("java/lang/reflect/Field",{clazz:rs.class_lookup(this.class_type,!0),name:rs.init_string(this.name,!0),type:rs.class_lookup(this.type,!0),modifiers:this.access_byte,slot:this.idx,signature:rs.init_string(this.raw_descriptor)})},Field}(AbstractMethodField),root.Method=function(_super){function Method(){Method.__super__.constructor.apply(this,arguments)}var pa;return __extends(Method,_super),Method.prototype.parse_descriptor=function(raw_descriptor){var field,p,param_carr,param_str,return_str,type_size,__,_ref;return this.raw_descriptor=raw_descriptor,_ref=/\(([^)]*)\)(.*)/.exec(this.raw_descriptor),__=_ref[0],param_str=_ref[1],return_str=_ref[2],param_carr=param_str.split(""),type_size=function(t){var _ref2;return(_ref2=t+"")==="D"||_ref2==="J"?2:1},this.param_types=function(){var _results;_results=[];while(field=carr2type(param_carr))_results.push(field);return _results}(),this.param_bytes=util.sum(function(){var _i,_len,_ref2,_results;_ref2=this.param_types,_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++)p=_ref2[_i],_results.push(type_size(p));return _results}.call(this)),this.access_flags.static||this.param_bytes++,this.num_args=this.param_types.length,this.access_flags.static||this.num_args++,this.return_type=str2type(return_str)},Method.prototype.reflector=function(rs,is_constructor){var f,typestr;return is_constructor==null&&(is_constructor=!1),typestr=is_constructor?"java/lang/reflect/Constructor":"java/lang/reflect/Method",rs.init_object(typestr,{clazz:rs.class_lookup(this.class_type,!0),name:rs.init_string(this.name,!0),parameterTypes:rs.init_object("[Ljava/lang/Class;",function(){var _i,_len,_ref,_results;_ref=this.param_types,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)f=_ref[_i],_results.push(rs.class_lookup(f,!0));return _results}.call(this)),returnType:rs.class_lookup(this.return_type,!0),modifiers:this.access_byte,slot:this.idx,signature:rs.init_string(this.raw_descriptor)})},Method.prototype.take_params=function(caller_stack){var i,params,start,_ref;params=Array(this.param_bytes),start=caller_stack.length-this.param_bytes;for(i=0,_ref=this.param_bytes;i<_ref;i+=1)params[i]=caller_stack[start+i];return caller_stack.length-=this.param_bytes,params},pa=function(a){return a.map(function(e){return e==null?"!":e.ref!=null?"*"+e.ref:e instanceof gLong?""+e+"L":e})},Method.prototype.run_manually=function(func,rs){var converted_params,idx,p,param_idx,params,rv,_len,_ref,_ref2,_ref3;params=rs.curr_frame().locals.slice(0),converted_params=[],this.access_flags.static||converted_params.push(params.shift()),param_idx=0,_ref=this.param_types;for(idx=0,_len=_ref.length;idx<_len;idx++)p=_ref[idx],converted_params.push(params[param_idx]),param_idx+=(_ref2=this.param_types[idx]+"")==="J"||_ref2==="D"?2:1;try{rv=func.apply(null,[rs].concat(__slice.call(converted_params)))}catch(e){throw e instanceof util.JavaException&&rs.meta_stack.pop(),e}rs.meta_stack.pop();if(this.return_type+""!=="V"){this.return_type+""==="Z"?rs.push(rv+0):rs.push(rv);if((_ref3=this.return_type+"")==="J"||_ref3==="D")return rs.push(null)}},Method.prototype.run_bytecode=function(rs,padding){var annotation,cf,code,exception_handlers,handler,op,pc,_results;code=this.code.opcodes,_results=[];for(;;)try{pc=rs.curr_pc(),op=code[pc],op.execute(rs),_results.push(rs.inc_pc(1+op.byte_count))}catch(e){if(e instanceof util.BranchException){rs.goto_pc(e.dst_pc);continue}if(e instanceof util.ReturnException){rs.meta_stack.pop(),rs.push.apply(rs,e.values);break}if(e instanceof util.YieldException)throw e;if(e instanceof util.JavaException){exception_handlers=this.code.exception_handlers,handler=_.find(exception_handlers,function(eh){return eh.start_pc<=pc&&pc<eh.end_pc&&(eh.catch_type==="<any>"||types.is_castable(rs,e.exception.type,c2t(eh.catch_type)))});if(handler!=null){rs.curr_frame().stack=[],rs.push(e.exception),rs.goto_pc(handler.handler_pc);continue}throw rs.meta_stack.pop(),e}throw e}return _results},Method.prototype.run=function(runtime_state,virtual){var caller_stack,cf,m,m_spec,obj,padding,params,sig;virtual==null&&(virtual=!1),sig=""+this.class_type.toClassString()+"::"+this.name+this.raw_descriptor;if(runtime_state.resuming_stack!=null){runtime_state.resuming_stack++;if(virtual){cf=runtime_state.curr_frame();if(cf.method!==this)return runtime_state.resuming_stack--,cf.method.run(runtime_state)}runtime_state.resuming_stack===runtime_state.meta_stack.length-1&&(runtime_state.resuming_stack=null)}else{caller_stack=runtime_state.curr_frame().stack;if(virtual)return obj=caller_stack[caller_stack.length-this.param_bytes],(caller_stack.length-this.param_bytes<0||obj==null)&&error("undef'd object: ("+caller_stack+")[-"+this.param_bytes+"] ("+sig+")"),m_spec={"class":obj.type.toClassString(),sig:this.name+this.raw_descriptor},m=runtime_state.method_lookup(m_spec),m.run(runtime_state);params=this.take_params(caller_stack),runtime_state.meta_stack.push(new runtime.StackFrame(this,params,[]))}padding=function(){var _i,_ref,_results;_results=[];for(_i=2,_ref=runtime_state.meta_stack.length;2>_ref?_i>_ref:_i<_ref;2>_ref?_i--:_i++)_results.push(" ");return _results}().join(""),cf=runtime_state.curr_frame();if(cf.resume!=null)this.run_manually(cf.resume,runtime_state),cf.resume=null;else if(trapped_methods[sig])this.run_manually(trapped_methods[sig],runtime_state);else if(this.access_flags["native"])if(sig.indexOf("::registerNatives()V",1)<0&&sig.indexOf("::initIDs()V",1)<0)if(native_methods[sig])this.run_manually(native_methods[sig],runtime_state);else try{util.java_throw(runtime_state,"java/lang/Error","native method NYI: "+sig)}finally{runtime_state.meta_stack.pop()}else this.run_manually(function(rs){},runtime_state);else this.run_bytecode(runtime_state,padding);return cf=runtime_state.curr_frame()},Method}(AbstractMethodField)}.call(this),function(){var c2t;if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof util=="undefined"||util===null)util=require("./util");if(typeof ConstantPool=="undefined"||ConstantPool===null)ConstantPool=require("./constant_pool");if(typeof make_attributes=="undefined"||make_attributes===null)make_attributes=require("./attributes");if(typeof opcodes=="undefined"||opcodes===null)opcodes=require("./opcodes");if(typeof methods=="undefined"||methods===null)methods=require("./methods");if(typeof types=="undefined"||types===null)types=require("./types");c2t=types.c2t,this.ClassFile=function(){function ClassFile(bytes_array){var f,i,isize,m,num_fields,num_methods,super_ref,_len,_ref,_ref2;bytes_array=new util.BytesArray(bytes_array);if(bytes_array.get_uint(4)!==3405691582)throw"Magic number invalid";this.minor_version=bytes_array.get_uint(2),this.major_version=bytes_array.get_uint(2);if(45>(_ref=this.major_version)||_ref>51)throw"Major version invalid";this.constant_pool=new ConstantPool,this.constant_pool.parse(bytes_array),this.access_byte=bytes_array.get_uint(2),this.access_flags=util.parse_flags(this.access_byte),this.this_class=c2t(this.constant_pool.get(bytes_array.get_uint(2)).deref()),this.constant_pool.cls=this.this_class.class_name,super_ref=bytes_array.get_uint(2),super_ref!==0&&(this.super_class=c2t(this.constant_pool.get(super_ref).deref())),isize=bytes_array.get_uint(2),this.interfaces=function(){var _i,_results;_results=[];for(_i=0;0>isize?_i>isize:_i<isize;0>isize?_i--:_i++)_results.push(bytes_array.get_uint(2));return _results}(),num_fields=bytes_array.get_uint(2),this.fields=function(){var _i,_results;_results=[];for(_i=0;0>num_fields?_i>num_fields:_i<num_fields;0>num_fields?_i--:_i++)_results.push(new methods.Field(this.this_class));return _results}.call(this),_ref2=this.fields;for(i=0,_len=_ref2.length;i<_len;i++)f=_ref2[i],f.parse(bytes_array,this.constant_pool,i);num_methods=bytes_array.get_uint(2),this.methods={};for(i=0;i<num_methods;i+=1)m=new methods.Method(this.this_class),m.parse(bytes_array,this.constant_pool,i),this.methods[m.name+m.raw_descriptor]=m;this.attrs=make_attributes(bytes_array,this.constant_pool);if(bytes_array.has_bytes())throw"Leftover bytes in classfile: "+bytes_array}return ClassFile.for_array_type=function(type){var class_file;return class_file=Object.create(ClassFile.prototype),class_file.constant_pool=new ConstantPool,class_file.access_flags={},class_file.this_class=type,class_file.super_class=c2t("java/lang/Object"),class_file.interfaces=[],class_file.fields=[],class_file.methods=[],class_file.attrs=[],class_file},ClassFile}(),typeof module!="undefined"&&module!==null&&(module.exports=this.ClassFile)}.call(this),function(){var c2t,debug,error,initial_value,java_throw,log,root,__slice=Array.prototype.slice;root=typeof exports!="undefined"&&exports!==null?exports:this.runtime={};if(typeof util=="undefined"||util===null)util=require("./util");if(typeof types=="undefined"||types===null)types=require("./types");if(typeof ClassFile=="undefined"||ClassFile===null)ClassFile=require("./class_file");log=util.log,debug=util.debug,error=util.error,java_throw=util.java_throw,c2t=types.c2t,initial_value=function(type_str){var _ref;return type_str==="J"?gLong.ZERO:(_ref=type_str[0])==="["||_ref==="L"?null:0},root.StackFrame=function(){function StackFrame(method,locals,stack){this.method=method,this.locals=locals,this.stack=stack,this.pc=0}return StackFrame}(),root.RuntimeState=function(){function RuntimeState(print,async_input,read_classfile){this.print=print,this.async_input=async_input,this.read_classfile=read_classfile,this.classes={},this.high_oref=1,this.string_pool={},this.string_redirector={},this.zip_descriptors=[null]}return RuntimeState.prototype.initialize=function(class_name,initial_args){var a,args,group;return this.meta_stack=[new root.StackFrame(null,[],[])],this.push(group=this.init_object("java/lang/ThreadGroup")),this.method_lookup({"class":"java/lang/ThreadGroup",sig:"<init>()V"}).run(this),this.main_thread=this.init_object("java/lang/Thread",{name:this.init_carr("main"),priority:1,group:group,threadLocals:null}),this.push(gLong.ZERO,null),this.static_put({"class":"java/lang/Thread",name:"threadSeqNumber"}),args=this.set_obj(c2t("[Ljava/lang/String;"),function(){var _i,_len,_results;_results=[];for(_i=0,_len=initial_args.length;_i<_len;_i++)a=initial_args[_i],_results.push(this.init_string(a));return _results}.call(this)),this.meta_stack=[new root.StackFrame(null,[],[args])],this.class_lookup(c2t(class_name))},RuntimeState.prototype.jvm2js_str=function(jvm_str){return this.jvm_carr2js_str(jvm_str.fields.value,jvm_str.fields.offset,jvm_str.fields.count)},RuntimeState.prototype.jvm_carr2js_str=function(jvm_arr,offset,count){var carr;return carr=jvm_arr.array,util.bytes2str(carr).substr(offset!=null?offset:0,count)},RuntimeState.prototype.string_redirect=function(oref,cls){var cdata,cstr,key;key=""+cls+"::"+oref,cdata=this.class_lookup(c2t(cls));if(!this.string_redirector[key]){cstr=cdata.constant_pool.get(oref);if(!cstr||cstr.type!=="Asciz")throw Error("can't redirect const string at "+oref);this.string_redirector[key]=this.init_string(cstr.value,!0)}return this.string_redirector[key]},RuntimeState.prototype.set_zip_descriptor=function(zd_obj){return this.zip_descriptors.push(zd_obj),gLong.fromInt(this.zip_descriptors.length-1)},RuntimeState.prototype.get_zip_descriptor=function(zd_long){return this.zip_descriptors[zd_long.toInt()]},RuntimeState.prototype.free_zip_descriptor=function(zd_long){},RuntimeState.prototype.curr_frame=function(){return this.resuming_stack!=null?this.meta_stack[this.resuming_stack]:_.last(this.meta_stack)},RuntimeState.prototype.cl=function(idx){return this.curr_frame().locals[idx]},RuntimeState.prototype.put_cl=function(idx,val){return this.curr_frame().locals[idx]=val},RuntimeState.prototype.put_cl2=function(idx,val){return this.put_cl(idx,val),this.put_cl(idx+1,null)},RuntimeState.prototype.push=function(){var args,cs;return args=1>arguments.length?[]:__slice.call(arguments,0),cs=this.curr_frame().stack,Array.prototype.push.apply(cs,args)},RuntimeState.prototype.pop=function(){return this.curr_frame().stack.pop()},RuntimeState.prototype.pop2=function(){return this.pop(),this.pop()},RuntimeState.prototype.curr_pc=function(){return this.curr_frame().pc},RuntimeState.prototype.goto_pc=function(pc){return this.curr_frame().pc=pc},RuntimeState.prototype.inc_pc=function(n){return this.curr_frame().pc+=n},RuntimeState.prototype.check_null=function(obj){return obj==null&&java_throw(this,"java/lang/NullPointerException",""),obj},RuntimeState.prototype.set_obj=function(type,obj){return obj==null&&(obj={}),type instanceof types.ArrayType?{type:type,array:obj,ref:this.high_oref++}:{type:type,fields:obj,ref:this.high_oref++}},RuntimeState.prototype.heap_newarray=function(type,len){var i;return type==="J"?this.set_obj(c2t("[J"),function(){var _results;_results=[];for(i=0;i<len;i+=1)_results.push(gLong.ZERO);return _results}()):type[0]==="L"?this.set_obj(c2t("["+type),function(){var _results;_results=[];for(i=0;i<len;i+=1)_results.push(null);return _results}()):this.set_obj(c2t("["+type),function(){var _results;_results=[];for(i=0;i<len;i+=1)_results.push(0);return _results}())},RuntimeState.prototype.heap_put=function(field_spec){var obj,val,_ref;return val=(_ref=field_spec.type)==="J"||_ref==="D"?this.pop2():this.pop(),obj=this.pop(),obj.fields[field_spec.name]=val},RuntimeState.prototype.heap_get=function(field_spec,obj){var name,_base,_ref;name=field_spec.name,(_base=obj.fields)[name]==null&&(_base[name]=initial_value(field_spec.type)),this.push(obj.fields[name]);if((_ref=field_spec.type)==="J"||_ref==="D")return this.push(null)},RuntimeState.prototype.static_get=function(field_spec){var f,obj,val;return f=this.field_lookup(field_spec),obj=this.class_lookup(f.class_type,!0),val=obj.fields[f.name],val==null&&(val=initial_value(f.type+"")),val},RuntimeState.prototype.static_put=function(field_spec){var f,obj,val,_ref;return val=
(_ref=field_spec.type)==="J"||_ref==="D"?this.pop2():this.pop(),f=this.field_lookup(field_spec),obj=this.class_lookup(f.class_type,!0),obj.fields[f.name]=val},RuntimeState.prototype.init_object=function(cls,obj){var type;return type=c2t(cls),this.class_lookup(type),this.set_obj(type,obj)},RuntimeState.prototype.init_string=function(str,intern){var carr,jvm_str,_ref,_ref2;return intern==null&&(intern=!1),intern&&((_ref=this.string_pool[str])!=null?(_ref2=_ref.type)!=null?typeof _ref2.toClassString=="function"?_ref2.toClassString():void 0:void 0:void 0)==="java/lang/String"?this.string_pool[str]:(carr=this.init_carr(str),jvm_str=this.set_obj(c2t("java/lang/String"),{value:carr,count:str.length}),intern&&(this.string_pool[str]=jvm_str),jvm_str)},RuntimeState.prototype.init_carr=function(str){var i;return this.set_obj(c2t("[C"),function(){var _ref,_results;_results=[];for(i=0,_ref=str.length;0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(str.charCodeAt(i));return _results}())},RuntimeState.prototype.class_lookup=function(type,get_obj){var c,cls,_ref;return get_obj==null&&(get_obj=!1),c=this._class_lookup(type),c||(cls=(_ref=typeof type.toClassString==="function"?type.toClassString():void 0)!=null?_ref:type+"",java_throw(this,"java/lang/NoClassDefFoundError",cls)),get_obj?c.obj:c.file},RuntimeState.prototype.dyn_class_lookup=function(type,get_obj){var c,cls,_ref;return get_obj==null&&(get_obj=!1),c=this._class_lookup(type),c||(cls=(_ref=typeof type.toClassString==="function"?type.toClassString():void 0)!=null?_ref:type+"",java_throw(this,"java/lang/ClassNotFoundException",cls)),get_obj?c.obj:c.file},RuntimeState.prototype._class_lookup=function(type){var class_file,cls,component,_ref,_ref2;if(type instanceof types.Type){cls=(_ref=typeof type.toClassString==="function"?type.toClassString():void 0)!=null?_ref:type+"";if(this.classes[cls]==null)if(type instanceof types.ArrayType)class_file=ClassFile.for_array_type(type),this.classes[cls]={file:class_file,obj:this.set_obj(c2t("java/lang/Class"),{$type:type})},component=type.component_type,(component instanceof types.ArrayType||component instanceof types.ClassType)&&this._class_lookup(component);else if(type instanceof types.PrimitiveType)this.classes[type]={file:"<primitive>",obj:this.set_obj(c2t("java/lang/Class"),{$type:type})};else{class_file=this.read_classfile(cls);if(class_file==null)return;this.classes[cls]={file:class_file,obj:this.set_obj(c2t("java/lang/Class"),{$type:type})},class_file.super_class&&this._class_lookup(class_file.super_class),(_ref2=class_file.methods["<clinit>()V"])!=null&&_ref2.run(this),cls==="java/lang/System"&&class_file.methods["initializeSystemClass()V"].run(this)}return this.classes[cls]}throw Error("class_lookup needs a type object, got "+typeof type+": "+type)},RuntimeState.prototype.method_lookup=function(method_spec){var cls,i,iface_name,ifaces,ifc,method,t,type;type=c2t(method_spec["class"]),t=type;while(t){cls=this.class_lookup(t),method=cls.methods[method_spec.sig];if(method!=null)return method;t=cls.super_class}cls=this.class_lookup(type),ifaces=function(){var _i,_len,_ref,_results;_ref=cls.interfaces,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)i=_ref[_i],_results.push(c2t(cls.constant_pool.get(i).deref()));return _results}();while(ifaces.length>0){iface_name=ifaces.shift(),ifc=this.class_lookup(iface_name),method=ifc.methods[method_spec.sig];if(method!=null)return method;Array.prototype.push.apply(ifaces,function(){var _i,_len,_ref,_results;_ref=ifc.interfaces,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)i=_ref[_i],_results.push(c2t(ifc.constant_pool.get(i).deref()));return _results}())}return java_throw(this,"java/lang/NoSuchMethodError","No such method found in "+method_spec["class"]+": "+method_spec.sig)},RuntimeState.prototype.field_lookup=function(field_spec){var field,filter_field;return filter_field=function(c){return _.find(c.fields,function(f){return f.name===field_spec.name})},field=this._field_lookup(field_spec["class"],filter_field),field!=null?field:java_throw(this,"java/lang/NoSuchFieldError","No such field found in "+field_spec["class"]+": "+field_spec.name)},RuntimeState.prototype._field_lookup=function(class_name,filter_fn){var cls,field,i,ifaces,ifc,t,_i,_len;t=c2t(class_name);while(t){cls=this.class_lookup(t),field=filter_fn(cls);if(field!=null)return field;ifaces=function(){var _i,_len,_ref,_results;_ref=cls.interfaces,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)i=_ref[_i],_results.push(cls.constant_pool.get(i).deref());return _results}();for(_i=0,_len=ifaces.length;_i<_len;_i++){ifc=ifaces[_i],field=this._field_lookup(ifc,filter_fn);if(field!=null)return field}t=cls.super_class}return null},RuntimeState}()}.call(this),function(){var debug,error,log,root,show_state,__slice=Array.prototype.slice;if(typeof _=="undefined"||_===null)_=require("../third_party/underscore-min.js");if(typeof runtime=="undefined"||runtime===null)runtime=require("./runtime");if(typeof util=="undefined"||util===null)util=require("./util");log=util.log,debug=util.debug,error=util.error,root=typeof exports!="undefined"&&exports!==null?exports:this.jvm={},show_state=function(rs){var cf,l,s,x;return cf=rs.curr_frame(),s=function(){var _i,_len,_ref,_results;_ref=cf.stack,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)x=_ref[_i],_results.push((x!=null?x.ref:void 0)!=null?x.ref:x);return _results}(),l=function(){var _i,_len,_ref,_results;_ref=cf.locals,_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++)x=_ref[_i],_results.push((x!=null?x.ref:void 0)!=null?x.ref:x);return _results}()},root.run_class=function(rs,class_name,cmdline_args,done_cb){var main_spec,run;return main_spec={"class":class_name,sig:"main([Ljava/lang/String;)V"},run=function(){var fns;fns=1>arguments.length?[]:__slice.call(arguments,0);try{return fns[0](),fns.shift(),fns.length>0?run.apply(null,fns):typeof done_cb=="function"?done_cb():void 0}catch(e){if(e instanceof util.JavaException)show_state(rs),rs.push(rs.main_thread,e.exception),rs.method_lookup({"class":"java/lang/Thread",sig:"dispatchUncaughtException(Ljava/lang/Throwable;)V"}).run(rs);else if(e instanceof util.HaltException)e.exit_code!==0&&console.error("\nExited with code "+e.exit_code);else{if(!(e instanceof util.YieldException))throw console.error("\nInternal JVM Error!"),show_state(rs),e;e.condition(function(){return rs.resuming_stack=0,run.apply(null,fns)})}if(!(e instanceof util.YieldException))return typeof done_cb=="function"?done_cb():void 0}},run(function(){return rs.initialize(class_name,cmdline_args)},function(){return rs.method_lookup(main_spec).run(rs)})}}.call(this),function($){$.fn.console=function(config){function newPromptBox(){typeof extern.onreprompt=="function"&&extern.onreprompt(),column=0,promptText="",ringn=0,enableInput(),promptBox=$('<div class="jquery-console-prompt-box"></div>');var label=$('<span class="jquery-console-prompt-label"></span>'),labelText=extern.continuedPrompt?extern.continuedPromptLabel:extern.promptLabel;if(lastMsg){var text=lastMsg.text();if(_.last(text)!=="\n"){var lines=text.split("\n");labelText=_.last(lines)+labelText,lines.length--,lastMsg.text(lines.join("\n"))}}promptBox.append(label.text(labelText).show()),label.html(label.html().replace(" ","&nbsp;")),prompt=$('<span class="jquery-console-prompt"></span>'),promptBox.append(prompt),inner.append(promptBox),updatePromptDisplay(),lastMsg=null}function isIgnorableKey(e){return(e.keyCode==9||e.keyCode==192)&&e.altKey}function rotateHistory(n){if(history.length==0)return;ringn+=n,ringn<0?ringn=history.length:ringn>history.length&&(ringn=0);var prevText=promptText;ringn==0?promptText=restoreText:promptText=history[ringn-1],config.historyPreserveColumn?promptText.length<column+1?column=promptText.length:column==0&&(column=promptText.length):column=promptText.length,updatePromptDisplay()}function previousHistory(){rotateHistory(-1)}function nextHistory(){rotateHistory(1)}function addToHistory(line){history.push(line),restoreText=""}function deleteCharAtPos(){return column<promptText.length?(promptText=promptText.substring(0,column)+promptText.substring(column+1),restoreText=promptText,!0):!1}function backDelete(){moveColumn(-1)&&(deleteCharAtPos(),updatePromptDisplay())}function forwardDelete(){promptText.length==0?extern.commandHandle&&extern.commandHandle("\0"):deleteCharAtPos()&&updatePromptDisplay()}function deleteUntilEnd(){while(deleteCharAtPos())updatePromptDisplay()}function deleteNextWord(){while(column<promptText.length&&!isCharAlphanumeric(promptText[column]))deleteCharAtPos(),updatePromptDisplay();while(column<promptText.length&&isCharAlphanumeric(promptText[column]))deleteCharAtPos(),updatePromptDisplay()}function commandTrigger(){var line=promptText;if(typeof config.commandValidate=="function"){var ret=config.commandValidate(line);ret==1||ret==0?ret&&handleCommand():commandResult(ret,"jquery-console-message-error")}else handleCommand()}function scrollToBottom(){jQuery.fn.jquery>"1.6"?inner.prop({scrollTop:inner.prop("scrollHeight")}):inner.attr({scrollTop:inner.attr("scrollHeight")})}function cancelExecution(){typeof config.cancelHandle=="function"&&config.cancelHandle()}function handleCommand(){if(typeof extern.commandHandle=="function"){disableInput(),addToHistory(promptText);var text=promptText;extern.continuedPrompt?continuedText?continuedText+="\n"+promptText:continuedText=promptText:continuedText=undefined,continuedText&&(text=continuedText);var ret=extern.commandHandle(text);extern.continuedPrompt&&!continuedText&&(continuedText=promptText),typeof ret=="boolean"?ret?commandResult():commandResult("Command failed.","jquery-console-message-error"):typeof ret=="string"?commandResult(ret,"jquery-console-message-success"):typeof ret=="object"&&ret.length?commandResult(ret):extern.continuedPrompt&&commandResult()}}function disableInput(){acceptInput=!1}function enableInput(){acceptInput=!0}function commandResult(msg,className,noreprompt){column=-1,updatePromptDisplay(),typeof msg=="string"?message(msg,className,noreprompt):$.isArray(msg)?message(msg[0],type2css[msg[1]]):inner.append(msg),noreprompt||newPromptBox()}function message(msg,className,noreprompt){noreprompt?(lastMsg||(lastMsg=$('<div class="jquery-console-message"></div>')),lastMsg.text(lastMsg.text()+msg),lastMsg.hide(),inner.append(lastMsg),lastMsg.show()):(mesg=$('<div class="jquery-console-message"></div>'),className&&mesg.addClass(className),mesg.text(msg),mesg.hide(),inner.append(mesg),mesg.show()),scrollToBottom()}function moveColumn(n){return column+n<0||column+n>promptText.length?!1:(column+=n,!0)}function moveForward(){return moveColumn(1)?(updatePromptDisplay(),!0):!1}function moveBackward(){return moveColumn(-1)?(updatePromptDisplay(),!0):!1}function moveToStart(){moveColumn(-column)&&updatePromptDisplay()}function moveToEnd(){moveColumn(promptText.length-column)&&updatePromptDisplay()}function moveToNextWord(){while(column<promptText.length&&!isCharAlphanumeric(promptText[column])&&moveForward());while(column<promptText.length&&isCharAlphanumeric(promptText[column])&&moveForward());}function moveToPreviousWord(){while(column-1>=0&&!isCharAlphanumeric(promptText[column-1])&&moveBackward());while(column-1>=0&&isCharAlphanumeric(promptText[column-1])&&moveBackward());}function isCharAlphanumeric(charToTest){if(typeof charToTest=="string"){var code=charToTest.charCodeAt();return code>="A".charCodeAt()&&code<="Z".charCodeAt()||code>="a".charCodeAt()&&code<="z".charCodeAt()||code>="0".charCodeAt()&&code<="9".charCodeAt()}return!1}function doNothing(){}function tabComplete(){if(config.tabComplete)return config.tabComplete()}function updatePromptDisplay(){var line=promptText,html="";if(column>0&&line=="")html=cursor;else if(column==promptText.length)html=htmlEncode(line)+cursor;else{var before=line.substring(0,column),current=line.substring(column,column+1);current&&(current='<span class="jquery-console-cursor">'+htmlEncode(current)+"</span>");var after=line.substring(column+1);html=htmlEncode(before)+current+htmlEncode(after)}prompt.html(html),scrollToBottom()}function htmlEncode(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br />")}config===undefined&&(config={});var extern={},keyCodes={37:moveBackward,39:moveForward,38:previousHistory,40:nextHistory,8:backDelete,9:tabComplete,46:forwardDelete,35:moveToEnd,36:moveToStart,13:commandTrigger,18:doNothing},ctrlCodes={65:moveToStart,68:forwardDelete,69:moveToEnd,78:nextHistory,80:previousHistory,66:moveBackward,70:moveForward,75:deleteUntilEnd},altCodes={70:moveToNextWord,66:moveToPreviousWord,68:deleteNextWord},cursor='<span class="jquery-console-cursor">&nbsp;</span>',container=$(this),inner=$('<pre class="jquery-console-inner"></div>'),typer=$('<textarea class="jquery-console-typer"></textarea>'),promptBox,prompt;extern.promptLabel=config.promptLabel?config.promptLabel:"> ",extern.continuedPromptLabel=config.continuedPromptLabel?config.continuedPromptLabel:"> ";var column=0,promptText="",restoreText="",continuedText="",history=[],ringn=0,cancelKeyPress=0,acceptInput=!0,cancelCommand=!1;extern.commandHandle=config.commandHandle;var lastMsg=null;(function(){container.append(inner),inner.append(typer),typer.css({position:"absolute",top:0,left:"-9999px"}),config.welcomeMessage&&message(config.welcomeMessage,"jquery-console-welcome"),newPromptBox(),config.autofocus&&(inner.addClass("jquery-console-focus"),typer.focus(),setTimeout(function(){inner.addClass("jquery-console-focus"),typer.focus()},100)),extern.inner=inner,extern.typer=typer,extern.scrollToBottom=scrollToBottom})(),extern.reset=function(){var welcome=typeof config.welcomeMessage!="undefined";inner.parent().fadeOut(function(){inner.find("div").each(function(){welcome?welcome=!1:$(this).remove()}),newPromptBox(),inner.parent().fadeIn(function(){inner.addClass("jquery-console-focus"),typer.focus()})})},extern.notice=function(msg,style){var n=$('<div class="notice"></div>').append($("<div></div>").text(msg)).css({visibility:"hidden"});container.append(n);var focused=!0;if(style=="fadeout")setTimeout(function(){n.fadeOut(function(){n.remove()})},4e3);else if(style=="prompt"){var a=$('<br/><div class="action"><a href="javascript:">OK</a><div class="clear"></div></div>');n.append(a),focused=!1,a.click(function(){n.fadeOut(function(){n.remove(),inner.css({opacity:1})})})}var h=n.height();return n.css({height:"0px",visibility:"visible"}).animate({height:h+"px"},function(){focused||inner.css({opacity:.5})}),n.css("cursor","default"),n},container.click(function(){return inner.addClass("jquery-console-focus"),inner.removeClass("jquery-console-nofocus"),typer.focus(),scrollToBottom(),!1}),typer.blur(function(){inner.removeClass("jquery-console-focus"),inner.addClass("jquery-console-nofocus")}),typer.bind("paste",function(e){typer.val(""),setTimeout(function(){typer.consoleInsert(typer.val()),typer.val("")},0)}),typer.keydown(function(e){cancelKeyPress=0;var keyCode=e.keyCode;if(e.ctrlKey&&keyCode==67)return cancelKeyPress=keyCode,cancelExecution(),!1;if(acceptInput){if(keyCode in keyCodes)return cancelKeyPress=keyCode,keyCodes[keyCode](),!1;if(e.ctrlKey&&keyCode in ctrlCodes)return cancelKeyPress=keyCode,ctrlCodes[keyCode](),!1;if(e.altKey&&keyCode in altCodes)return cancelKeyPress=keyCode,altCodes[keyCode](),!1}}),typer.keypress(function(e){var keyCode=e.keyCode||e.which;if(isIgnorableKey(e))return!1;if(e.ctrlKey&&String.fromCharCode(keyCode).toLowerCase()=="v")return!0;if(acceptInput&&cancelKeyPress!=keyCode&&keyCode>=32){if(cancelKeyPress)return!1;(typeof config.charInsertTrigger=="undefined"||typeof config.charInsertTrigger=="function"&&config.charInsertTrigger(keyCode,promptText))&&typer.consoleInsert(keyCode)}if($.browser.webkit)return!1});var type2css={success:"jquery-console-message-success",error:"jquery-console-message-error"};return extern.message=function(msg,type,noreprompt){commandResult(msg,type2css[type],noreprompt)},extern.reprompt=function(){commandResult()},typer.consoleInsert=function(data){var text=isNaN(data)?data:String.fromCharCode(data),before=promptText.substring(0,column),after=promptText.substring(column);promptText=before+text+after,moveColumn(text.length),restoreText=promptText,updatePromptDisplay()},extern.promptText=function(text){return text&&(promptText=text,column=promptText.length,updatePromptDisplay()),promptText},extern}}(jQuery),function(){var asyncExecute,data,fs,octal2num,root,shift_file,_ref;root=this;if(typeof util=="undefined"||util===null)util=require("../src/util");asyncExecute=(_ref=this.asyncExecute)!=null?_ref:require("./util").asyncExecute,root.untar=function(bytes,cb,done_cb){var next_file;return next_file=function(){var body,path,percent,_ref2;return _ref2=shift_file(bytes),path=_ref2[0],body=_ref2[1],percent=bytes.pos()/bytes.size(),cb(percent,path,body),bytes.peek()!==0?asyncExecute(next_file):typeof done_cb=="function"?done_cb():void 0},asyncExecute(next_file,0)},shift_file=function(bytes){var body,file,fname,fullname,header,prefix,size;return header=bytes.read(512),fname=util.bytes2str(header.slice(0,100)),size=octal2num(header.slice(124,135)),prefix=util.bytes2str(header.slice(345,500)),fullname=prefix?""+prefix+"/"+fname:fname,body=bytes.read(Math.ceil(size/512)*512),file=body.slice(0,size),[fullname,file]},octal2num=function(bytes){var b,digit,idx,msd,num,_len;num=0,msd=bytes.length-1;for(idx=0,_len=bytes.length;idx<_len;idx++)b=bytes[idx],digit=parseInt(String.fromCharCode(b)),num+=digit*Math.pow(8,msd-idx);return num},typeof module!="undefined"&&module!==null&&!module.parent&&(fs=require("fs"),data=new util.BytesArray(util.bytestr_to_array(fs.readFileSync("/dev/stdin","binary"))),root.untar(data,function(percent,path,file){return console.log(path)}))}.call(this),function(){var class_cache,commandCompletions,commands,compile_source,controller,defaultFile,editor,fileNameCompletions,longestCommmonPrefix,process_bytecode,progress,raw_cache,read_classfile,root,stdout,tabComplete,try_path,user_input,__slice=Array.prototype.slice;root=this,stdout=null,user_input=null,controller=null,editor=null,progress=null,class_cache={},raw_cache={},$.ajax("browser/mini-rt.tar",{type:"GET",dataType:"text",beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){var done,file_count,on_complete,start_untar,update_bar;return file_count=0,done=!1,start_untar=(new Date).getTime(),on_complete=function(){var end_untar;return end_untar=(new Date).getTime(),console.log("Untarring took a total of "+(end_untar-start_untar)+"ms."),$("#overlay").fadeOut("slow"),$("#progress-container").fadeOut("slow"),$("#console").click()},update_bar=_.throttle(function(percent,path){var display_perc;if(typeof bar=="undefined"||bar===null)bar=$("#progress > .bar");if(typeof preloading_file=="undefined"||preloading_file===null)preloading_file=$("#preloading-file");return display_perc=Math.min(Math.ceil(percent*100),100),bar.width(""+display_perc+"%",150),preloading_file.text(display_perc<100?"Loading "+_.last(path.split("/")):"Done!")}),untar(new util.BytesArray(util.bytestr_to_array(data)),function(percent,path,file){var base,base_dir,cls,ext,_ref;update_bar(percent,path),raw_cache[path]=file,base_dir="third_party/classes/",_ref=path.split("."),base=_ref[0],ext=_ref[1];if(ext!=="class"){percent===100&&on_complete();return}return file_count++,cls=base.substr(base_dir.length),asyncExecute(function(){class_cache[cls]=new ClassFile(file);if(--file_count===0&&done)return on_complete()},0)},function(){done=!0;if(file_count===0)return on_complete()})},error:function(jqXHR,textStatus,errorThrown){return console.error(errorThrown)}}),$.ajax("third_party/classes/sun/tools/javac/Main.class",{type:"GET",dataType:"text",beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){return class_cache["!javac"]=process_bytecode(data)}}),$.ajax("third_party/classes/com/sun/tools/script/shell/Main.class",{type:"GET",dataType:"text",beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){return class_cache["!rhino"]=process_bytecode(data)}}),try_path=function(path){var local_file,rv;return local_file=DoppioFile.load(_.last(path.split("/"))),local_file!=null?util.bytestr_to_array(local_file.data):(rv=null,$.ajax(path,{type:"GET",dataType:"text",async:!1,beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){return rv=util.bytestr_to_array(data)}}),rv)},read_classfile=function(cls){var classpath,fullpath,path,_i,_len;if(class_cache[cls]==null){classpath=["third_party/classes/",""];for(_i=0,_len=classpath.length;_i<_len;_i++){path=classpath[_i],fullpath=""+path+cls+".class";if(fullpath in raw_cache){if(raw_cache[fullpath]===null)continue;class_cache[cls]=new ClassFile(raw_cache[fullpath]);break}raw_cache[fullpath]=try_path(fullpath);if(raw_cache[fullpath]!=null){class_cache[cls]=new ClassFile(raw_cache[fullpath]);break}}}return class_cache[cls]},root.read_raw_class=function(path){var data;return raw_cache[path]==null&&(data=try_path(path),data!=null&&(raw_cache[path]=data)),raw_cache[path]},process_bytecode=function(bytecode_string){var bytes_array;return bytes_array=util.bytestr_to_array(bytecode_string),new ClassFile(bytes_array)},compile_source=function(fname,quiet){var source;return source=DoppioFile.load(fname).read(),source==null?controller.message("Could not find file '"+fname+"'.","error"):$.ajax("http://people.cs.umass.edu/~ccarey/javac/",{type:"POST",data:{pw:"coffee",source:source},dataType:"text",beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){var class_name;class_name=fname.split(".")[0],(new DoppioFile(""+class_name+".class")).write(data).save();if(!quiet)return controller.reprompt()},error:function(jqXHR,textStatus,errorThrown){return controller.message("AJAX error: "+errorThrown,"error")}})},$(document).ready(function(){var close_editor,demo,demo_files,jqconsole,_i,_len;editor=$("#editor"),$("#file").change(function(ev){var ext,f,reader;return f=ev.target.files[0],typeof FileReader=="undefined"||FileReader===null?(controller.message("Your browser doesn't support file loading.\nTry using the editor to create files instead.","error"),$("#console").click()):(reader=new FileReader,reader.onerror=function(e){switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:return alert("404'd");case e.target.error.NOT_READABLE_ERR:return alert("unreadable");case e.target.error.SECURITY_ERR:return alert("only works with --allow-file-access-from-files")}},ext=f.name.split(".")[1],ext==="class"?(reader.onload=function(e){return(new DoppioFile(f.name)).write(e.target.result).save(),controller.message("File '"+f.name+"' saved.","success"),typeof editor.getSession=="function"&&editor.getSession().setValue("/*\n * Binary file: "+f.name+"\n */"),$("#console").click()},reader.readAsBinaryString(f)):(reader.onload=function(e){return(new DoppioFile(f.name)).write(e.target.result).save(),controller.message("File '"+f.name+"' saved.","success"),typeof editor.getSession=="function"&&editor.getSession().setValue(e.target.result),$("#console").click()},reader.readAsText(f)))}),jqconsole=$("#console"),controller=jqconsole.console({promptLabel:"doppio > ",commandHandle:function(line){var args,cmd,handler,_ref;_ref=line.split(/\s+/),cmd=_ref[0],args=2>_ref.length?[]:__slice.call(_ref,1);if(cmd==="")return!0;handler=commands[cmd];try{return handler!=null?handler(args):"Unknown command '"+cmd+"'. Enter 'help' for a list of commands."}catch(e){return controller.message(e+"","error")}},tabComplete:tabComplete,autofocus:!1,animateScroll:!0,promptHistory:!0,welcomeMessage:"Welcome to Doppio! You may wish to try the following Java programs:\n  rhino\n  javac FileRead.java\n  javac Fib.java\n  java FileRead\n  java Fib <num>\n  java Chatterbot\n  java DiffPrint foo bar\n  java RegexTestHarness\n  java Lzw c foo foo_lzw (compress)\n  java Lzw d foo_lzw foo (decompress)\n\nThe .java files can be inspected by typing `edit [filename]`.\n\nYou can also upload your own files using the uploader above the top-right\ncorner of the console.\n\nThe provided Java compiler is for Java 4, so programs using modern Java\nfeatures (e.g. varargs) will not compile. However, you can still run them\nby compiling them locally and uploading their classfiles.\n\nEnter 'help' for full a list of commands. Ctrl-D is EOF."}),demo_files=["special/DiffPrint.class","special/Chatterbot.java","special/Chatterbot.class","special/Lzw.java","special/Lzw.class","special/RegexTestHarness.java","special/RegexTestHarness.class","./FileRead.java","special/Fib.java","special/foo","special/bar"];for(_i=0,_len=demo_files.length;_i<_len;_i++)demo=demo_files[_i],$.ajax("test/"+demo,{type:"GET",dataType:"text",async:!1,beforeSend:function(jqXHR){return jqXHR.overrideMimeType("text/plain; charset=x-user-defined")},success:function(data){var fname;return fname=_.last(demo.split("/")),(new DoppioFile(fname)).write(data).save()},error:function(){var fname;return fname=_.last(demo.split("/")),controller.message("Could not load '"+fname+"'.\n","error",!0)}});return stdout=function(str){return controller.message(str,"",!0)},user_input=function(n_bytes,resume){var oldHandle,oldPrompt;return oldPrompt=controller.promptLabel,controller.promptLabel="",controller.reprompt(),oldHandle=controller.commandHandle,controller.commandHandle=function(line){var i;return controller.commandHandle=oldHandle,controller.promptLabel=oldPrompt,line==="\0"?resume(0):(line+="\n",resume(function(){var _ref,_results;_results=[];for(i=0,_ref=Math.min(n_bytes,line.length);0>_ref?i>_ref:i<_ref;0>_ref?i--:i++)_results.push(line.charCodeAt(i));return _results}()))}},close_editor=function(){return $("#ide").fadeOut("fast",function(){return $("#console").fadeIn("fast").click()})},$("#save_btn").click(function(e){var contents,fname;return fname=$("#filename").val(),contents=editor.getSession().getValue(),contents[contents.length-1]!=="\n"&&(contents+="\n"),(new DoppioFile(fname)).write(contents).save(),controller.message("File saved as '"+fname+"'.","success"),close_editor(),e.preventDefault()}),$("#close_btn").click(function(e){return close_editor(),e.preventDefault()})}),commands={javac:function(args,cb){var rs;return rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,"!javac",args,function(){return controller.reprompt()})},java:function(args,cb){var rs;return args[0]==null?"Usage: java class [args...]":(rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,args[0],args.slice(1),function(){return controller.reprompt()}))},javap:function(args){var raw_data;return args[0]==null?"Usage: javap class":(raw_data=DoppioFile.load(""+args[0]+".class").read(),raw_data==null?["Could not find class '"+args[0]+"'.","error"]:disassembler.disassemble(process_bytecode(raw_data)))},rhino:function(args,cb){var rs;return rs=new runtime.RuntimeState(stdout,user_input,read_classfile),jvm.run_class(rs,"!rhino",args,function(){return controller.reprompt()})},list_cache:function(){var name,val;return function(){var _results;_results=[];for(name in raw_cache)val=raw_cache[name],_results.push((val!=null?"":"-")+name);return _results}().join("\n")},clear_cache:function(args){return raw_cache={},class_cache={},"Cache cleared."},ls:function(args){return node.fs.readdirSync(".").sort().join("\n")},edit:function(args){var data;return data=args[0]!=null?DoppioFile.load(args[0]).read():defaultFile,$("#console").fadeOut("fast",function(){var JavaMode,TextMode,ext,_ref;return $("#filename").val(args[0]),$("#ide").fadeIn("fast"),editor=ace.edit("source"),editor.setTheme("ace/theme/twilight"),ext=(_ref=args[0])!=null?_ref.split(".")[1]:void 0,ext==="java"||args[0]==null?(JavaMode=require("ace/mode/java").Mode,editor.getSession().setMode(new JavaMode)):(TextMode=require("ace/mode/text").Mode,editor.getSession().setMode(new TextMode)),editor.getSession().setValue(data)}),!0},cat:function(args){var fname;return fname=args[0],fname==null?"Usage: cat <file>":DoppioFile.load(fname).read()},mv:function(args){var f;return f=DoppioFile.load(args[0]),f.name=args[1],f.save(),DoppioFile["delete"](args[0]),!0},rm:function(args){return args[0]==null?"Usage: rm <file>":(args[0]==="*"?localStorage.clear():DoppioFile["delete"](args[0]),!0)},emacs:function(){return"Try 'vim'."},vim:function(){return"Try 'emacs'."},time:function(args){var start;return start=(new Date).getTime(),console.profile(args[0]),controller.onreprompt=function(){var end;return controller.onreprompt=null,console.profileEnd(),end=(new Date).getTime(),controller.message("\nCommand took a total of "+(end-start)+"ms to run.\n","",!0)},commands[args.shift()](args)},profile:function(args){var count,duration,runs,time_once;return count=0,runs=5,duration=0,time_once=function(){var start;return start=(new Date).getTime(),controller.onreprompt=function(){var end;if(count<runs)return end=(new Date).getTime(),count++===0?time_once():(duration+=end-start,time_once());controller.onreprompt=null,controller.message("\n"+args[0]+" took an average of "+duration/runs+"ms.\n","",!0);return},commands[args.shift()](args)},time_once()},help:function(args){return"Ctrl-D is EOF.\n\nJava-related commands:\n  javac <source file>    -- Invoke the Java 4 compiler.\n  java <class> [args...] -- Run with command-line arguments.\n  javap <class>          -- Display disassembly.\n  time                   -- Measure how long it takes to run a command.\n\nFile management:\n  cat <file>             -- Display a file in the console.\n  edit <file>            -- Edit a file.\n  ls                     -- List all files.\n  mv <src> <dst>         -- Move / rename a file.\n  rm <file>              -- Delete a file.\n\nCache management:\n  list_cache             -- List the cached class files.\n  clear_cache            -- Clear the cached class files."}},tabComplete=function(){var args,getCompletions,prefix,promptText;promptText=controller.promptText(),args=promptText.split(/\s+/),getCompletions=function(args){return args.length===1?commandCompletions(args[0]):args[0]==="time"?getCompletions(args.slice(1)):fileNameCompletions(args[0],args)},prefix=longestCommmonPrefix(getCompletions(args));if(prefix==="")return;return promptText=promptText.substr(0,promptText.length-_.last(args).length),controller.promptText(promptText+prefix)},commandCompletions=function(cmd){var handler,name,_results;_results=[];for(name in commands)handler=commands[name],name.substr(0,cmd.length)===cmd&&_results.push(name);return _results},fileNameCompletions=function(cmd,args){var chopExt,completions,file,flags,i,key,lastArg,validExtension,_ref;validExtension=function(fname){var dot,ext;return dot=fname.lastIndexOf("."),ext=dot===-1?"":fname.slice(dot+1),cmd==="javac"?ext==="java":cmd==="javap"||cmd==="java"?ext==="class":!0},chopExt=args.length===2&&(cmd==="javap"||cmd==="java"),lastArg=RegExp("^"+_.last(args),flags="i"),completions=[];for(i=0,_ref=localStorage.length;i<_ref;i+=1){key=localStorage.key(i);if(key.substr(0,6)!=="file::")continue;file=DoppioFile.load(key.substr(6));if(file==null||!validExtension(file.name))continue;file.name.match(lastArg)!=null&&completions.push(chopExt?file.name.split(".",1)[0]:file.name)}return completions},longestCommmonPrefix=function(lst){return lst.join(" ").match(/^(\S*)\S*(?: \1\S*)*$/i)[1]},defaultFile="class Test {\n  public static void main(String[] args) {\n    // enter code here\n  }\n}"}.call(this);